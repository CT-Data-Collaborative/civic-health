var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/introduction",{templateUrl:"static/dist/templates/introduction.html",controller:"AboutPageController"}).when("/civic-engagement",{templateUrl:"static/dist/templates/civic-engagement.html",controller:"EngagementPageController"}).when("/political-participation",{templateUrl:"static/dist/templates/political-participation.html",controller:"ParticipationPageController"}).when("/community-cohesion",{templateUrl:"static/dist/templates/community-cohesion.html",controller:"CohesionPageController"}).when("/institutional-presence",{templateUrl:"static/dist/templates/institutional-presence.html",controller:"InstitutionPageController"}).when("/call-to-action",{templateUrl:"static/dist/templates/call-to-action.html",controller:"CallToActionPageController"}).when("/partners",{templateUrl:"static/dist/templates/partners.html",controller:"PartnersPageController"}).when("/raw-data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).otherwise({redirectTo:"/introduction"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"&ddagger;":"-666,666.0"===t||"-666666"===t?"&dagger;":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("anySuppressed",["lodash",function(t){return function(e,n){return e=t.flattenDeep(t.pluck(e,"data")),"undefined"!=typeof n?t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,n)}):t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,"-666666")||-1!==t.indexOf(e,"-9999")})}}]).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return t.trustAsHtml}]),angular.module("app").service("barChartService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){function e(t,e){t.each(function(){for(var t,n=d3.select(this),a=n.text().split(/\s+/).reverse(),r=[],o=0,i=1.1,l=n.attr("y"),c=parseFloat(n.attr("dy")),s=n.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",c+"em");t=a.pop();)r.push(t),s.text(r.join(" ")),s.node().getComputedTextLength()>e&&(r.pop(),s.text(r.join(" ")),r=[t],s=n.append("tspan").attr("x",0).attr("y",l).attr("dy",++o*i+c+"em").text(t))})}t.each(function(t){var a=this.getBoundingClientRect(),r={top:.05*a.height,right:.05*a.width,bottom:.3*a.height,left:d3.max([.05*a.width,75])},i=a.width-(r.left+r.right);height=a.height-(r.top+r.bottom),tip=d3.tip().attr("class","groupedbar-tip").html(function(t){return n.chain([t.Label,d3.format("f")(t.Value)+"%"]).compact().join("<br />")}),svg=d3.select(this).append("svg").attr("height",a.height).attr("width",a.width).call(tip),chart=svg.append("g").attr("height",height).attr("width",i).attr("transform","translate("+r.left+", "+r.top+")"),x=d3.scale.ordinal().rangeRoundBands([0,i],.1,.1).domain(o),y=d3.scale.linear().range([height,0]).domain([0,yRangeMax]).nice(10),xAxis=d3.svg.axis().scale(x).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-i).tickPadding(10).tickFormat(function(t){return d3.format("f")(t)+"%"});var l=chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(xAxis);l.selectAll(".tick text").call(e,x.rangeBand()),chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis),chart.selectAll("rect.barchart-bar").data(t).enter().append("rect").attr("class",function(t,e){var n="bar-color-"+(e%2+1);return["barchart-bar",n].join(" ")}).attr("width",x.rangeBand()).attr("height",function(t){return height-y(t.Value)}).attr("x",function(t){return x(t.Bar)}).attr("y",function(t){return y(t.Value)}).on("mouseover",tip.show).on("mouseout",tip.hide)})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var o=n.chain(e).map(function(t){return t.Bar}).unique().value();yRangeMax=n.chain(e).map(function(t){return+t.Value}).max().value(),chartContainer=d3.select(t).append("div").classed("barchart-container",!0).append("div").classed("barchart-container-internal",!0).datum(e),r(chartContainer)},a}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getCategories("all");l.then(function(e){t.categories=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,o.section="Raw Data"})}]),angular.module("app").directive("dataviz",["$window","$http","timeseriesService","groupedBarChartService","barChartService","tableService",function(t,e,n,a,r,o){var i={line:n.chart,bar:r.chart,groupedBar:a.chart,table:o.chart};return{restrict:"E",scope:{which:"=which",type:"=type"},link:function(t,n,a){t.render=function(){t.data?i[t.type](n[0],result.data,{}):e.get("/static/dist/data/csv/"+t.which+".csv").then(function(e){t.data=e.data,i[t.type](n[0],t.data,{})})},t.$watchCollection("which",function(){t.render()})}}}]),angular.module("app").service("groupedBarChartService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){var e=d3.scale.ordinal().range(["bar-color-1","bar-color-2","bar-color-3","bar-color-4"]).domain(l),n=d3.select(this).selectAll("div.groupedbar-legend-entry").data(t).enter().append("div").classed("groupedbar-legend-entry",!0).datum(function(t){return t});n.each(function(t){d3.select(this).append("span").attr("class",function(n){return["groupedbar-legend-entry-color",e(t)].join(" ")}),d3.select(this).append("span").classed("groupedbar-legend-entry-label",!0).text(t)})})}function o(t){function e(t,e){t.each(function(){for(var t,n=d3.select(this),a=n.text().split(/\s+/).reverse(),r=[],o=0,i=1.1,l=n.attr("y"),c=parseFloat(n.attr("dy")),s=n.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",c+"em");t=a.pop();)r.push(t),s.text(r.join(" ")),s.node().getComputedTextLength()>e&&(r.pop(),s.text(r.join(" ")),r=[t],s=n.append("tspan").attr("x",0).attr("y",l).attr("dy",++o*i+c+"em").text(t))})}t.each(function(t){var a=this.getBoundingClientRect(),r={top:.05*a.height,right:.05*a.width,bottom:.3*a.height,left:d3.max([.05*a.width,75])},o=a.width-(r.left+r.right);height=a.height-(r.top+r.bottom),tip=d3.tip().attr("class","groupedbar-tip").html(function(t){return n.chain([t.Label,d3.format("f")(t.Value)+"%"]).compact().join("<br />")}),svg=d3.select(this).append("svg").attr("height",a.height).attr("width",a.width).call(tip),chart=svg.append("g").attr("height",height).attr("width",o).attr("transform","translate("+r.left+", "+r.top+")"),colors=d3.scale.ordinal().range(["bar-color-1","bar-color-2","bar-color-3","bar-color-4"]).domain(l),x0=d3.scale.ordinal().rangeRoundBands([0,o],.2,.2).domain(i),x1=d3.scale.ordinal().rangeRoundBands([0,x0.rangeBand()],.1,0).domain(l),y=d3.scale.linear().range([height,0]).domain([0,yRangeMax]).nice(5),x0Axis=d3.svg.axis().scale(x0).orient("bottom"),x1Axis=d3.svg.axis().scale(x1).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-o).tickPadding(10).tickFormat(function(t){return d3.format("f")(t)+"%"});var c=chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(x0Axis);c.selectAll(".tick text").call(e,x0.rangeBand()),chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis);var s=chart.selectAll("g.groupedbar-group").data(t).enter().append("g").classed("groupedbar-group",!0).attr("width",x0.rangeBand()).attr("height",height).attr("transform",function(t){return"translate("+x0(t.key)+", 0)"}).datum(function(t){return t.values});s.each(function(t){var e=n.chain(t).map(function(t){return t.Bar}).without("").value(),a=(n.chain(t).map(function(t){return t.Label}).without("").value(),x1.copy().domain(e));d3.select(this).selectAll("rect.groupedbar-bar").data(t).enter().append("rect").attr("class",function(t){return["groupedbar-bar",colors(t.Bar)].join(" ")}).attr("width",a.rangeBand()).attr("height",function(t){return height-y(t.Value)}).attr("x",function(t){return a(t.Bar)}).attr("y",function(t){return y(t.Value)}).on("mouseover",tip.show).on("mouseout",tip.hide)})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var i=n.chain(e).map(function(t){return t.Group}).unique().value(),l=n.chain(e).map(function(t){return t.Bar}).unique().value();yRangeMax=n.chain(e).map(function(t){return+t.Value}).max().value(),e=d3.nest().key(function(t){return t.Group}).entries(e),chartContainer=d3.select(t).append("div").classed("groupedbar-container",!0).append("div").classed("groupedbar-container-internal",!0).datum(e),legendContainer=d3.select(t).append("div").classed({"legend-container":!0,"groupedbar-legend-container":!0}).append("div").classed({"groupedbar-legend-container-internal":!0}).datum(l),o(chartContainer),r(legendContainer)},a}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,a){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").service("tableService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){table=d3.select(this).append("table"),thead=table.append("thead"),tbody=table.append("body"),thead.append("tr").selectAll("th").data(o).enter().append("th").text(function(t){return t})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var o=[];for(k in e[0])o.push(k);return chartContainer=d3.select(t).append("div").classed("table-container",!0).append("div").classed("table-container-internal",!0).datum(e),void r(chartContainer)},a}]),angular.module("app").service("timeseriesService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){colors=d3.scale.ordinal().range(["#1EACF1","#B94A48"]).domain(i);var e=d3.select(this).selectAll("div.timeseries-legend-entry").data(t).enter().append("div").classed("timeseries-legend-entry",!0).datum(function(t){return t});e.each(function(t){d3.select(this).append("span").classed("timeseries-legend-entry-color",!0).style("background-color",colors(t)),d3.select(this).append("span").classed("timeseries-legend-entry-label",!0).text(t)})})}function o(t){t.each(function(t){var e=this.getBoundingClientRect(),a={top:.05*e.height,right:.05*e.width,bottom:.1*e.height,left:d3.max([.05*e.width,55])},r=e.width-(a.left+a.right);height=e.height-(a.top+a.bottom),svg=d3.select(this).append("svg").attr("height",e.height).attr("width",e.width),chart=svg.append("g").attr("height",height).attr("width",r).attr("transform","translate("+a.left+", "+a.top+")"),colors=d3.scale.ordinal().range(["#1EACF1","#B94A48"]).domain(i),symbolScale=d3.scale.ordinal().range(d3.svg.symbolTypes).domain(i),timeFormat=d3.time.format("%Y"),timeRange=n.chain(t).map(function(t){return t.Year}).value(),x=d3.time.scale().range([12,r]).domain(d3.extent(timeRange).map(function(t){return timeFormat.parse(t)})),y=d3.scale.linear().range([height,0]).domain(d3.extent(n.chain(t).map(function(t){return i.map(function(e){return+t[e]})}).flatten().unique().value())).nice(5,10),xAxis=d3.svg.axis().scale(x).orient("bottom").ticks(d3.time.year,1),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-r).tickPadding(10).tickFormat(function(t){return d3.format("f")(t)+"%"}),line=d3.svg.line().x(function(t){return x(t.Year)}).y(function(t){return y(t.Value)}),t=i.map(function(e){return{Key:e,Values:n.map(t,function(t){return{Year:timeFormat.parse(t.Year),Value:+t[e]}})}}),chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(xAxis),chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis),chart.selectAll("g.timeseries-lines").data(t).enter().append("g").classed("timeseries-lines",!0).append("path").classed("timeseries-path",!0).attr("d",function(t){return line(t.Values)}).attr("stroke",function(t,e){return colors(t.Key)});var o=t.map(function(t,e,n){return t.Values.map(function(e,n,a){return e.Key=t.Key,e})});o=n.flatten(o),chart.append("g").classed("timeseries-points",!0).selectAll("g").data(o).enter().append("path").attr("stroke",function(t,e){return colors(t.Key)}).attr("d",d3.svg.symbol().type("circle").size(65)).attr("transform",function(t){return"translate("+x(t.Year)+", "+y(t.Value)+")"})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var i=n.chain(e[0]).keys().filter(function(t){return"Year"!==t}).value();chartContainer=d3.select(t).append("div").classed("timeseries-container",!0).append("div").classed("timeseries-container-internal",!0).datum(e),legendContainer=d3.select(t).append("div").classed({"legend-container":!0,"timeseries-legend-container":!0}),o(chartContainer),legendContainer=d3.select(t).append("div").classed({"legend-container":!0,"timeseries-legend-container":!0}).append("div").classed({"timeseries-legend-container-internal":!0}).datum(i),r(legendContainer)},a}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getContributors("all");l.then(function(e){t.contributors=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,o.section="Introduction",t.nextSection="Civic Engagement",t.nextSectionTeaser="Testing",t.nextSectionURL="#/civic-engagement"})}]),angular.module("app").controller("CallToActionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Call To Action"})}]),angular.module("app").controller("CohesionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Social Networks and Community Cohesion",t.nextSection="Institutional Presence",t.nextSectionTeaser="Stuff about institutions",t.nextSectionURL="#/institutional-presence"})}]),angular.module("app").controller("EngagementPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Civic Engagement",t.nextSection="Political Participation",t.nextSectionTeaser="Stuff about political participation",t.nextSectionURL="#/political-participation"})}]),angular.module("app").controller("ParticipationPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Political Participation",t.nextSection="Community Cohesion",t.nextSectionTeaser="Stuff about cohesion",t.nextSectionURL="#/community-cohesion"})}]),angular.module("app").controller("PartnersPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getContributors("all");l.then(function(e){t.contributors=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,o.section="Partners",t.nextSection="Raw Data",t.nextSectionTeaser="Stuff about raw data",t.nextSectionURL="#/raw-data"})}]),angular.module("app").controller("InstitutionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Institutional Presence",t.nextSection="Call to Action",t.nextSectionTeaser="Stuff about call to action",t.nextSectionURL="#/call-to-action"})}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var a={};return a.list=[],a.toggle=function(t){position=n.findIndex(a.list,function(e){return e.name==t.name}),a.list[position].selected=!a.list[position].selected},a.getCategories=function(){return e(a.list.length>0?function(t){t(a)}:function(e,r){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,a,r){t.data[a].data=n.sortByAll(t.data[a].data,"rank")}),t=n.extend({},t,{selected:!0})}),a.list=list,e(a)}).error(function(){r("There was an error getting categories")})})},a}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,a){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){a("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,a,r){var o=a.getCategories();o.then(function(e){t.categories=a.list},function(t){alert("promise rejected!")});var i=r.getContributors();i.then(function(e){t.contributors=r.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){a.toggle(t)},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0},section:"Introduction"}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.section=e.section,t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from wrap"),console.log(t.toggle)}),t.$watchCollection(function(){return e.section},function(){t.section=e.section})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJkYXRhdml6L2JhckNoYXJ0U2VydmljZS5zZXJ2aWNlLmpzIiwiZGF0YXZpei9kYXRhdml6LmNvbnRyb2xsZXIuanMiLCJkYXRhdml6L2RhdGF2aXouZGlyZWN0aXZlLmpzIiwiZGF0YXZpei9ncm91cGVkQmFyQ2hhcnQuc2VydmljZS5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90YWJsZS5zZXJ2aWNlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLnNlcnZpY2UuanMiLCJwYWdlcy9hYm91dHBhZ2UuY29udHJvbGxlci5qcyIsInBhZ2VzL2NhbGx0b2FjdGlvbi5jb250cm9sbGVyLmpzIiwicGFnZXMvY29oZXNpb24uY29udHJvbGxlci5qcyIsInBhZ2VzL2VuZ2FnZW1lbnQuY29udHJvbGxlci5qcyIsInBhZ2VzL3BhcnRpY2lwYXRpb24uY29udHJvbGxlci5qcyIsInBhZ2VzL3BhcnRuZXJzLmNvbnRyb2xsZXJzLmpzIiwicGFnZXMvcHJlc2VuY2UuY29udHJvbGxlci5qcyIsInNpZGViYXIvY2F0ZWdvcmllcy5zZXJ2aWNlLmpzIiwic2lkZWJhci9jb250cmlidXRvcnMuc2VydmljZS5qcyIsInNpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwic2lkZWJhci9zaWRlYmFyZGlzcGxheS5zZXJ2aWNlLmpzIiwic2lkZWJhci93cmFwLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZpbHRlciIsImlucHV0Iiwic3RyIiwicGFyc2VJbnQiLCJsb2Rhc2giLCJhcnIiLCJzdXBwcmVzc2lvbiIsImZsYXR0ZW5EZWVwIiwicGx1Y2siLCJzb21lIiwibyIsInZhbHVlcyIsImluZGV4T2YiLCJwcm9wIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiJHNjZSIsInRydXN0QXNIdG1sIiwic2VydmljZSIsIiRxIiwiJGh0dHAiLCJiYXJDaGFydFNlcnZpY2UiLCJjaGFydCIsImNvbnRhaW5lciIsImRhdGEiLCJtYWtlYmFyY2hhcnRDaGFydCIsInNlbGVjdGlvbiIsIndyYXAiLCJ0ZXh0Iiwid2lkdGgiLCJlYWNoIiwid29yZCIsImQzIiwic2VsZWN0IiwidGhpcyIsIndvcmRzIiwic3BsaXQiLCJyZXZlcnNlIiwibGluZSIsImxpbmVOdW1iZXIiLCJsaW5lSGVpZ2h0IiwieSIsImF0dHIiLCJkeSIsInBhcnNlRmxvYXQiLCJ0c3BhbiIsImFwcGVuZCIsInBvcCIsInB1c2giLCJqb2luIiwibm9kZSIsImdldENvbXB1dGVkVGV4dExlbmd0aCIsIkJCb3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJtYXJnaW4iLCJ0b3AiLCJoZWlnaHQiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJtYXgiLCJ0aXAiLCJodG1sIiwiZCIsImNoYWluIiwiTGFiZWwiLCJmb3JtYXQiLCJWYWx1ZSIsImNvbXBhY3QiLCJzdmciLCJjYWxsIiwieCIsInNjYWxlIiwib3JkaW5hbCIsInJhbmdlUm91bmRCYW5kcyIsImRvbWFpbiIsImJhcktleXMiLCJsaW5lYXIiLCJyYW5nZSIsInlSYW5nZU1heCIsIm5pY2UiLCJ4QXhpcyIsImF4aXMiLCJvcmllbnQiLCJ5QXhpcyIsImlubmVyVGlja1NpemUiLCJ0aWNrUGFkZGluZyIsInRpY2tGb3JtYXQiLCJ0IiwieEF4aXNHcm91cCIsImNsYXNzZWQiLCJ4LWF4aXMiLCJzZWxlY3RBbGwiLCJyYW5nZUJhbmQiLCJ5LWF4aXMiLCJlbnRlciIsImkiLCJjb2xvckNsYXNzIiwiQmFyIiwib24iLCJzaG93IiwiaGlkZSIsImZhY2V0IiwiZGlmZmVyZW5jZSIsImNzdiIsInBhcnNlIiwibWFwIiwidW5pcXVlIiwidmFsdWUiLCJjaGFydENvbnRhaW5lciIsImRhdHVtIiwiJHNjb3BlIiwiJGxvZyIsIiRsb2NhdGlvbiIsIiRmaWx0ZXIiLCJzaWRlYmFyRGlzcGxheSIsImNhdGVnb3JpZXMiLCJ0b2dnbGUiLCJwcm9taXNlIiwiZ2V0Q2F0ZWdvcmllcyIsInRoZW4iLCJyZXN1bHQiLCJsaXN0IiwicmVqZWN0aW9uIiwiYWxlcnQiLCIkb24iLCJldmVudCIsIm9wZW4iLCJzZWN0aW9uIiwiZGlyZWN0aXZlIiwiJHdpbmRvdyIsInRpbWVzZXJpZXNTZXJ2aWNlIiwiZ3JvdXBlZEJhckNoYXJ0U2VydmljZSIsInRhYmxlU2VydmljZSIsImNoYXJ0cyIsImJhciIsImdyb3VwZWRCYXIiLCJ0YWJsZSIsInJlc3RyaWN0Iiwic2NvcGUiLCJ3aGljaCIsInR5cGUiLCJsaW5rIiwiZWxlbWVudCIsImF0dHJzIiwicmVuZGVyIiwiZ2V0IiwiJHdhdGNoQ29sbGVjdGlvbiIsIm1ha2VMZWdlbmQiLCJsZWdlbmREYXRhIiwiY29sb3JzIiwibGVnZW5kRW50cmllcyIsImVudHJ5RGF0YSIsIm1ha2VHcm91cGVkQmFyQ2hhcnQiLCJ4MCIsImdyb3VwS2V5cyIsIngxIiwieDBBeGlzIiwieDFBeGlzIiwieDBBeGlzR3JvdXAiLCJiYXJHcm91cHMiLCJrZXkiLCJncm91cERhdGEiLCJ0aGlzR3JvdXBCYXJzIiwid2l0aG91dCIsInRoaXNHcm91cFgxIiwiY29weSIsIkdyb3VwIiwibmVzdCIsImVudHJpZXMiLCJsZWdlbmRDb250YWluZXIiLCJsZWdlbmQtY29udGFpbmVyIiwiZ3JvdXBlZGJhci1sZWdlbmQtY29udGFpbmVyIiwiZ3JvdXBlZGJhci1sZWdlbmQtY29udGFpbmVyLWludGVybmFsIiwidGFibGVDaGFydCIsIm1ha2VUYWJsZSIsInRoZWFkIiwidGJvZHkiLCJjb2x1bW5LZXlzIiwiayIsImxpbmVLZXlzIiwic3R5bGUiLCJtYWtlVGltZVNlcmllcyIsInN5bWJvbFNjYWxlIiwic3ltYm9sVHlwZXMiLCJ0aW1lRm9ybWF0IiwidGltZSIsInRpbWVSYW5nZSIsIlllYXIiLCJleHRlbnQiLCJmbGF0dGVuIiwidGlja3MiLCJ5ZWFyIiwiS2V5IiwiVmFsdWVzIiwicG9pbnREYXRhIiwiZGkiLCJkYSIsInYiLCJ2aSIsInZhIiwic3ltYm9sIiwic2l6ZSIsImtleXMiLCJ0aW1lc2VyaWVzLWxlZ2VuZC1jb250YWluZXIiLCJ0aW1lc2VyaWVzLWxlZ2VuZC1jb250YWluZXItaW50ZXJuYWwiLCIkcm91dGVQYXJhbXMiLCJjb250cmlidXRvcnMiLCJjb250cmlidXRvclByb21pc2UiLCJnZXRDb250cmlidXRvcnMiLCJuZXh0U2VjdGlvbiIsIm5leHRTZWN0aW9uVGVhc2VyIiwibmV4dFNlY3Rpb25VUkwiLCJjYXRlZ29yeSIsInBvc2l0aW9uIiwiZmluZEluZGV4IiwibGlzdGNhdCIsIm5hbWUiLCJzZWxlY3RlZCIsImxlbmd0aCIsInJlc29sdmUiLCJyZWplY3QiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzb3J0QnkiLCJmb3JFYWNoIiwiaW5kaWNhdG9yIiwiaWkiLCJpYSIsInNvcnRCeUFsbCIsImV4dGVuZCIsImVycm9yIiwiY2F0ZWdvcnlQcm9taXNlIiwidXBkYXRlU2VsZWN0ZWQiLCJjaGVja1NlbGVjdGVkIiwiYm9vbCIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsV0FDQSxXQ0pBRCxTQUFBQyxPQUFBLE9BQ0FDLFFBQUEsaUJBQUEsb0JBQUEsU0FBQUMsRUFBQUMsR0FDQUQsRUFDQUUsS0FBQSxpQkFDQUMsWUFBQSwwQ0FDQUMsV0FBQSx3QkFFQUYsS0FBQSxxQkFDQUMsWUFBQSw4Q0FDQUMsV0FBQSw2QkFFQUYsS0FBQSw0QkFDQUMsWUFBQSxxREFDQUMsV0FBQSxnQ0FFQUYsS0FBQSx1QkFDQUMsWUFBQSxnREFDQUMsV0FBQSwyQkFFQUYsS0FBQSwyQkFDQUMsWUFBQSxvREFDQUMsV0FBQSw4QkFFQUYsS0FBQSxtQkFDQUMs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T0FBQSxTQUFBLGFBQUEsZUFDQSxTQUFBa0gsRUFBQUMsRUFBQTVHLEVBQUFnSCxFQUFBMkYsR0FLQSxHQUFBeUIsR0FBQXBILEVBQUFHLGVBQ0FpSCxHQUFBaEgsS0FBQSxTQUFBQyxHQUNBVixFQUFBSyxXQUFBQSxFQUFBTSxNQUNBLFNBQUFDLEdBQ0FDLE1BQUEsc0JBR0EsSUFBQW9GLEdBQUFELEVBQUFFLGlCQUNBRCxHQUFBeEYsS0FBQSxTQUFBQyxHQUNBVixFQUFBZ0csYUFBQUEsRUFBQXJGLE1BQ0EsU0FBQUMsR0FDQUMsTUFBQSx1QkFLQWIsRUFBQTBILGVBQUEsU0FBQXBCLEdBQ0FqRyxFQUFBQyxPQUFBZ0csSUFHQXRHLEVBQUEySCxjQUFBLFNBQUFDLEdBQ0EsTUFBQUEsR0FDQSxXQUVBLGNBR0E1SCxFQUFBb0MsaUJBQUEsV0FDQSxNQUFBcEMsR0FBQU0sUUFDQSxXQUNBdUgsUUFBQUMsSUFBQSxrQ0FDQUQsUUFBQUMsSUFBQTlILEVBQUFNLGFDdkNBL0gsUUFBQUMsT0FBQSxPQUNBMkIsUUFBQSxpQkFBQSxXQUNBLE9BQ0FtRyxRQUFBVSxNQUFBLEdBQ0FDLFFBQUEsa0JDSkExSSxRQUFBQyxPQUFBLE9BQ0FNLFdBQUEsa0JBQUEsU0FBQSxpQkFBQSxTQUFBa0gsRUFBQUksR0FDQUosRUFBQU0sT0FBQUYsRUFBQUUsT0FDQU4sRUFBQWlCLFFBQUFiLEVBQUFhLFFBRUFqQixFQUFBb0MsaUJBQUEsV0FDQSxNQUFBcEMsR0FBQU0sUUFDQSxXQUNBdUgsUUFBQUMsSUFBQSwrQkFDQUQsUUFBQUMsSUFBQTlILEVBQUFNLFVBSUFOLEVBQUFvQyxpQkFBQSxXQUNBLE1BQUFoQyxHQUFBYSxTQUNBLFdBQ0FqQixFQUFBaUIsUUFBQWIsRUFBQWEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgJ25nQW5pbWF0ZScsXG4gICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgJ25nTG9kYXNoJyxcbiAgICAnbmdSb3V0ZSdcbiAgICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignL2ludHJvZHVjdGlvbicsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2ludHJvZHVjdGlvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBYm91dFBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NpdmljLWVuZ2FnZW1lbnQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jaXZpYy1lbmdhZ2VtZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0VuZ2FnZW1lbnRQYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wb2xpdGljYWwtcGFydGljaXBhdGlvbicsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL3BvbGl0aWNhbC1wYXJ0aWNpcGF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BhcnRpY2lwYXRpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9jb21tdW5pdHktY29oZXNpb24nLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jb21tdW5pdHktY29oZXNpb24uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ29oZXNpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9pbnN0aXR1dGlvbmFsLXByZXNlbmNlJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvaW5zdGl0dXRpb25hbC1wcmVzZW5jZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJbnN0aXR1dGlvblBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NhbGwtdG8tYWN0aW9uJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvY2FsbC10by1hY3Rpb24uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2FsbFRvQWN0aW9uUGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvcGFydG5lcnMnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9wYXJ0bmVycy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQYXJ0bmVyc1BhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3Jhdy1kYXRhJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvZGF0YS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXRhVml6Q29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnL2ludHJvZHVjdGlvbidcbiAgICAgICAgfSk7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmZpbHRlcignc3VwcHJlc3Npb25zJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgIGlmIChpbnB1dCA9PT0gXCItOSw5OTkuMFwiIHx8IGlucHV0ID09PSBcIi05OTk5XCIpIHtcbiAgICAgICAgcmV0dXJuICcmZGRhZ2dlcjsnO1xuICAgIH0gZWxzZSBpZiAoaW5wdXQgPT09IFwiLTY2Niw2NjYuMFwiIHx8IGlucHV0ID09PSBcIi02NjY2NjZcIikge1xuICAgICAgICByZXR1cm4gJyZkYWdnZXI7JztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuICB9O1xufSlcbi5maWx0ZXIoJ3BlcmNlbnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgIGlmIChwYXJzZUludChzdHIpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ciArIFwiJVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgfVxuICAgIH1cbn0pXG4uZmlsdGVyKCdhbnlTdXBwcmVzc2VkJywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBzdXBwcmVzc2lvbikge1xuICAgICAgICBhcnIgPSBsb2Rhc2guZmxhdHRlbkRlZXAobG9kYXNoLnBsdWNrKGFyciwgXCJkYXRhXCIpKTtcblxuICAgICAgICBpZiAodHlwZW9mIHN1cHByZXNzaW9uICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImNoZWNraW5nIHN1cHByZXNzaW9uOiBcIitzdXBwcmVzc2lvbik7XG4gICAgICAgICAgICByZXR1cm4gbG9kYXNoLnNvbWUoYXJyLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgbyA9IGxvZGFzaC52YWx1ZXMobyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5pbmRleE9mKG8sIHN1cHByZXNzaW9uKSAhPT0gLTE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGFzc3VtZSB0byBjaGVjayBlaXRoZXIgc3VwcHJlc3Npb25cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2hlY2tpbmcgYm90aCBzdXBwcmVzc2lvbiB0eXBlc1wiKTtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgICAgICAgICBvID0gbG9kYXNoLnZhbHVlcyhvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmluZGV4T2YobywgJy02NjY2NjYnKSAhPT0gLTEgfHwgbG9kYXNoLmluZGV4T2YobywgJy05OTk5JykgIT09IC0xO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ2FueScsIFsnbG9kYXNoJywgZnVuY3Rpb24obG9kYXNoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFyciwgcHJvcCkge1xuICAgICAgICBpZiAodHlwZW9mIHByb3AgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIHByb3ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdub25lJywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuICFsb2Rhc2guc29tZShhcnIsIHByb3ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFycilcbiAgICAgICAgfVxuICAgIH1cbn1dKVxuLmZpbHRlcignc2x1Z2dpZnknLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXpBLVowLTlfXS9nLCBcIl9cIilcbiAgICB9O1xufSlcbi5maWx0ZXIoJ3NhZmUnLCBbJyRzY2UnLCBmdW5jdGlvbigkc2NlKSB7XG4gICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWw7XG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnYmFyQ2hhcnRTZXJ2aWNlJywgWyckcScsICckaHR0cCcsICdsb2Rhc2gnLCBmdW5jdGlvbigkcSwgJGh0dHAsIGxvZGFzaCkge1xuICAgIHZhciBiYXJDaGFydFNlcnZpY2UgPSB7fTtcblxuICAgIGJhckNoYXJ0U2VydmljZS5jaGFydCA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgZGF0YSwgY29uZmlnKSB7XG4gICAgICAgIHZhciB0aW1lRm9ybWF0cyA9IHtcbiAgICAgICAgICAgIFwieWVhclwiIDogXCJZWVlZXCIsXG4gICAgICAgICAgICBcInF1YXJ0ZXJcIiA6IFwiW1FdUSBZWVlZXCIsXG4gICAgICAgICAgICBcIm1vbnRoXCIgOiBcIk1NTSBZWVlZXCJcbiAgICAgICAgfTtcblxuICAgICAgICBjb25maWcuZmFjZXQgPSBsb2Rhc2guZGlmZmVyZW5jZShbXCJzdHJ1Y3R1cmVcIiwgXCJ0aW1lXCJdLCBbY29uZmlnLmZhY2V0XSlbMF1cblxuICAgICAgICAvLyBjb252ZXJ0IGRhdGEgZnJvbSBzdHJpbmcgLT4gYXJyYXkgb2Ygb2JqXG4gICAgICAgIGRhdGEgPSBkMy5jc3YucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgdmFyIGJhcktleXMgPWxvZGFzaC5jaGFpbihkYXRhKVxuICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5CYXI7IH0pXG4gICAgICAgICAgICAgICAgLnVuaXF1ZSgpXG4gICAgICAgICAgICAgICAgLnZhbHVlKClcbiAgICAgICAgICAgIHlSYW5nZU1heCA9IGxvZGFzaC5jaGFpbihkYXRhKVxuICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gK2QuVmFsdWU7IH0pXG4gICAgICAgICAgICAgICAgLm1heCgpXG4gICAgICAgICAgICAgICAgLnZhbHVlKCk7XG5cbiAgICAgICAgLy8gY3JlYXRlIGNvbnRhaW5lciBmb3IgbWFwc1xuICAgICAgICBjaGFydENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJiYXJjaGFydC1jb250YWluZXJcIiwgdHJ1ZSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImJhcmNoYXJ0LWNvbnRhaW5lci1pbnRlcm5hbFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5kYXR1bShkYXRhKTtcblxuICAgICAgICAvLyBjaGFydENvbnRhaW5lci5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KHlSYW5nZU1heCwgbnVsbCwgNCkpO1xuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoYmFyS2V5cywgbnVsbCwgNCkpO1xuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoY29uZmlnLCBudWxsLCA0KSk7XG4gICAgICAgIC8vIHJldHVybjtcblxuICAgICAgICBtYWtlYmFyY2hhcnRDaGFydChjaGFydENvbnRhaW5lcik7XG5cbiAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIC8vIC8qKiBTVEFSVCBTQ1JPTEwgTk9USUNFICoqL1xuICAgICAgICAvLyAvLyBpZiB3ZSBhcmUgdW5kZXIgYSBjZXJ0YWluIHBpeGVsIHNpemUsIHRoZXJlIHdpbGwgYmUgaG9yaXpvbnRhbCBzY3JvbGxpbmdcbiAgICAgICAgLy8gdmFyIGludGVybmFsQ29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi5iYXJjaGFydC1jb250YWluZXItaW50ZXJuYWxcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAvLyAgICAgY29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi5iYXJjaGFydC1jb250YWluZXJcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIC8vIC8vIGNvbnNvbGUubG9nKGludGVybmFsQ29udGFpbmVyU2l6ZS53aWR0aCArIFwiIC8gXCIgKyBjb250YWluZXJTaXplLndpZHRoKVxuICAgICAgICAvLyBpZiAoaW50ZXJuYWxDb250YWluZXJTaXplLndpZHRoID4gY29udGFpbmVyU2l6ZS53aWR0aCkge1xuICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2coXCJzY3JvbGwgTm90aWNlIVwiKVxuICAgICAgICAvLyAgICAgLy8gY3JlYXRlIHNjcm9sbCBub3RpY2VcbiAgICAgICAgLy8gICAgIHZhciBzY3JvbGxOb3RpY2UgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYuYmFyY2hhcnQtY29udGFpbmVyXCIpLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKFwic2Nyb2xsLW5vdGljZVwiLCB0cnVlKVxuICAgICAgICAvLyAgICAgICAgIC5hcHBlbmQoXCJwXCIpO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwiaVwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYVwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYS1hbmdsZS1kb3VibGUtZG93biBcIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICB9KTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcInNwYW5cIilcbiAgICAgICAgLy8gICAgICAgICAudGV4dChcIlNjcm9sbCBmb3IgbW9yZVwiKTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuYmFyY2hhcnQtY29udGFpbmVyXCIpLm9uKFwic2Nyb2xsXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgLy8gaWYgc2Nyb2xsIGF0IGJvdHRvbSwgaGlkZSBzY3JvbGwgbm90aWNlXG4gICAgICAgIC8vICAgICAvLyB1c2luZyBhIGRpZmZlcmVudCBjbGFzcyBzbyBhcyBub3QgdG8gaW50ZXJmZXJlIHdpdGggdGhlIG1vdXNlb3ZlciBlZmZlY3RzXG4gICAgICAgIC8vICAgICBpZiAoKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsTGVmdCArIGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkub2Zmc2V0V2lkdGgpID49IChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbFdpZHRoICogMC45NzUpKSB7XG4gICAgICAgIC8vICAgICAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwiaGlkZGVuXCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLyoqIEVORCBTQ1JPTEwgTk9USUNFICoqL1xuXG4gICAgICAgIC8vIC8vIGFkZCBob3ZlciBlZmZlY3RzIC0gdXNlIGNsYXNzZXMgXCJoaWdobGlnaHRcIiBhbmQgXCJsb3dsaWdodFwiXG4gICAgICAgIC8vIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcuYmFyY2hhcnQtbGluZXMgPiBwYXRoLCBnLmJhcmNoYXJ0LXBvaW50cyA+IHBhdGhcIilcbiAgICAgICAgLy8gLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICB2YXIgY2xhc3NUb0hpZ2hsaWdodCA9IGQzLnNlbGVjdCh0aGlzKS5hdHRyKFwiZGF0YS1jbGFzc1wiKTtcblxuICAgICAgICAvLyAgICAgLy8gbG93bGlnaHQgYWxsIGVsZW1lbnRzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLmJhcmNoYXJ0LWxpbmVzID4gcGF0aCwgZy5iYXJjaGFydC1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAvLyAgICAgLy8gaGlnaGxpZ2h0IGFsbCBlbGVtZW50cyB3aXRoIG1hdGNoaW5nIGRhdGEtY2xhc3NcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnkuXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy5iYXJjaGFydC1saW5lcyA+IHBhdGguXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy5iYXJjaGFydC1wb2ludHMgcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0KVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiB0cnVlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIC8vIHJlbW92ZSBhbGwgaGlnaGxpZ2h0L2xvd2xpZ2h0IGNsYXNzZXNcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcuYmFyY2hhcnQtbGluZXMgPiBwYXRoLCBnLmJhcmNoYXJ0LXBvaW50cyA+IHBhdGgsIGRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogZmFsc2UsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gbWFrZWJhcmNoYXJ0Q2hhcnQoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBoZWxwZXIgZnVuY3Rpb24sIHdyYXBzIHRleHQgZm9yIGF4aXMgbGFiZWxzXG4gICAgICAgICAgICBmdW5jdGlvbiB3cmFwKHRleHQsIHdpZHRoKSB7XG4gICAgICAgICAgICAgIHRleHQuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IGQzLnNlbGVjdCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgd29yZHMgPSB0ZXh0LnRleHQoKS5zcGxpdCgvXFxzKy8pLnJldmVyc2UoKSxcbiAgICAgICAgICAgICAgICAgICAgd29yZCxcbiAgICAgICAgICAgICAgICAgICAgbGluZSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyID0gMCxcbiAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IDEuMSwgLy8gZW1zXG4gICAgICAgICAgICAgICAgICAgIHkgPSB0ZXh0LmF0dHIoXCJ5XCIpLFxuICAgICAgICAgICAgICAgICAgICBkeSA9IHBhcnNlRmxvYXQodGV4dC5hdHRyKFwiZHlcIikpLFxuICAgICAgICAgICAgICAgICAgICB0c3BhbiA9IHRleHQudGV4dChudWxsKS5hcHBlbmQoXCJ0c3BhblwiKS5hdHRyKFwieFwiLCAwKS5hdHRyKFwieVwiLCB5KS5hdHRyKFwiZHlcIiwgZHkgKyBcImVtXCIpO1xuICAgICAgICAgICAgICAgIHdoaWxlICh3b3JkID0gd29yZHMucG9wKCkpIHtcbiAgICAgICAgICAgICAgICAgIGxpbmUucHVzaCh3b3JkKTtcbiAgICAgICAgICAgICAgICAgIHRzcGFuLnRleHQobGluZS5qb2luKFwiIFwiKSk7XG4gICAgICAgICAgICAgICAgICBpZiAodHNwYW4ubm9kZSgpLmdldENvbXB1dGVkVGV4dExlbmd0aCgpID4gd2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZS5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oXCIgXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgbGluZSA9IFt3b3JkXTtcbiAgICAgICAgICAgICAgICAgICAgdHNwYW4gPSB0ZXh0LmFwcGVuZChcInRzcGFuXCIpLmF0dHIoXCJ4XCIsIDApLmF0dHIoXCJ5XCIsIHkpLmF0dHIoXCJkeVwiLCArK2xpbmVOdW1iZXIgKiBsaW5lSGVpZ2h0ICsgZHkgKyBcImVtXCIpLnRleHQod29yZCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIHNpemluZyBhbmQgbWFyZ2luIHZhcnNcbiAgICAgICAgICAgICAgICB2YXIgQkJveCA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCIgOiBCQm94LmhlaWdodCAqIDAuMDUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCIgOiBCQm94LndpZHRoICogMC4wNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCIgOiBCQm94LmhlaWdodCAqIDAuMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGVmdFwiIDogZDMubWF4KFtCQm94LndpZHRoICogMC4wNSwgNzVdKVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IEJCb3gud2lkdGggLSAobWFyZ2luLmxlZnQgKyBtYXJnaW4ucmlnaHQpXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IEJCb3guaGVpZ2h0IC0gKG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyB0b29sdGlwIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRpcCA9IGQzLnRpcCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiZ3JvdXBlZGJhci10aXBcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmNoYWluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5MYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuZm9ybWF0KFwiZlwiKShkLlZhbHVlKSArIFwiJVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29tcGFjdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCI8YnIgLz5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnRhaW5lcnNcbiAgICAgICAgICAgICAgICAgICAgc3ZnID0gZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInN2Z1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgQkJveC5oZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIEJCb3gud2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aXApXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCAwKVwiKSxcbiAgICAgICAgICAgICAgICAgICAgY2hhcnQgPSBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgbWFyZ2luLmxlZnQgKyBcIiwgXCIgKyBtYXJnaW4udG9wICsgXCIpXCIpLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZXN0aW5nIHN0dWZmIC0gZHJhd3Mgb3V0bGluZXMgYXJvdW5kIHN2ZyBhbmQgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN2Z091dGxpbmUgPSBzdmcuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJoZWlnaHRcIiwgc3ZnLmF0dHIoXCJoZWlnaHRcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcIndpZHRoXCIsIHN2Zy5hdHRyKFwid2lkdGhcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImZpbGxcIiwgXCJyZ2JhKDAsMCwwLDApXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcInN0cm9rZVwiLCBcInJlZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hhcnRPdXRsaW5lID0gc3ZnLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgbWFyZ2luLmxlZnQgKyBcIiwgXCIgKyBtYXJnaW4udG9wICsgXCIpXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImhlaWdodFwiLCBjaGFydC5hdHRyKFwiaGVpZ2h0XCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ3aWR0aFwiLCBjaGFydC5hdHRyKFwid2lkdGhcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImZpbGxcIiwgXCJyZ2JhKDAsMCwwLDApXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcInN0cm9rZVwiICxcImJsdWVcIiksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8geCBhbmQgeSBzY2FsZXNcbiAgICAgICAgICAgICAgICAgICAgeCA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlUm91bmRCYW5kcyhbMCwgd2lkdGhdLCAwLjEsIDAuMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oYmFyS2V5cyksXG4gICAgICAgICAgICAgICAgICAgIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgeVJhbmdlTWF4XSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5uaWNlKDEwKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyBheGlzIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICAgICAgICB4QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh4KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yaWVudChcImJvdHRvbVwiKSxcbiAgICAgICAgICAgICAgICAgICAgeUF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGUoeSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vcmllbnQoXCJsZWZ0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaW5uZXJUaWNrU2l6ZSgtd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGlja1BhZGRpbmcoMTApXG4gICAgICAgICAgICAgICAgICAgICAgICAudGlja0Zvcm1hdChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLmZvcm1hdChcImZcIikodCkgKyBcIiVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIC8vIHRlc3Qgb3V0cHV0IGZvciB0cm91Ymxlc2hvb3RpbmcgdGhlIGRhdGEgc3R1ZmZcbiAgICAgICAgICAgICAgICAgICAgLy8gZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInByZVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLnRleHQoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgNCkpXG4gICAgICAgICAgICAgICAgICAgIC8vIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgeEF4aXNHcm91cCA9IGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIngtYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF4aXNcIiA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCBcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeEF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHdvcmR3cmFwIGF4aXMgbGFiZWxzXG4gICAgICAgICAgICAgICAgICAgIHhBeGlzR3JvdXAuc2VsZWN0QWxsKFwiLnRpY2sgdGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHdyYXAsIHgucmFuZ2VCYW5kKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInktYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF4aXNcIiA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgtMTIsIDApXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh5QXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuc2VsZWN0QWxsKFwicmVjdC5iYXJjaGFydC1iYXJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yQ2xhc3MgPSBcImJhci1jb2xvci1cIiArICgoaSAlIDIpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXCJiYXJjaGFydC1iYXJcIiwgY29sb3JDbGFzc10uam9pbihcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHgucmFuZ2VCYW5kKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gaGVpZ2h0IC0geShkLlZhbHVlKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLkJhcik7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC5WYWx1ZSk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIHRpcC5zaG93KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIHRpcC5oaWRlKVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNoYXJ0LnNlbGVjdEFsbChcInRleHQuYmFyY2hhcnQtdmFsdWVcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgLmNsYXNzZWQoXCJiYXJjaGFydC12YWx1ZVwiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuIGQzLmZvcm1hdChcIjAuMWZcIikoZC5WYWx1ZSkgKyBcIiVcIjtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgeC5yYW5nZUJhbmQoKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLlZhbHVlKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHgoZC5CYXIpICsgKHgucmFuZ2VCYW5kKCkvMik7IH0pXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJkeVwiLCAtNClcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBiYXJDaGFydFNlcnZpY2U7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdEYXRhVml6Q29udHJvbGxlcicsXG4gICAgICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywgJyRmaWx0ZXInLCAnc2lkZWJhckRpc3BsYXknLCAnY2F0ZWdvcmllcycsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCAkZmlsdGVyLCBzaWRlYmFyRGlzcGxheSwgY2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyhcImFsbFwiKTtcbiAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdSYXcgRGF0YSc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnZGF0YXZpeicsIFsnJHdpbmRvdycsICckaHR0cCcsICd0aW1lc2VyaWVzU2VydmljZScsICdncm91cGVkQmFyQ2hhcnRTZXJ2aWNlJywgJ2JhckNoYXJ0U2VydmljZScsICd0YWJsZVNlcnZpY2UnLCBmdW5jdGlvbigkd2luZG93LCAkaHR0cCwgdGltZXNlcmllc1NlcnZpY2UsIGdyb3VwZWRCYXJDaGFydFNlcnZpY2UsIGJhckNoYXJ0U2VydmljZSwgdGFibGVTZXJ2aWNlKSB7XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgcmVmbGVjdCB3aGF0ZXZlciB5b3VyIGQzIGZ1bmN0aW9uIGlzIGNhbGxlZC5cbiAgICB2YXIgY2hhcnRzID0ge1xuICAgICAgICBcImxpbmVcIiA6IHRpbWVzZXJpZXNTZXJ2aWNlLmNoYXJ0LFxuICAgICAgICBcImJhclwiIDogYmFyQ2hhcnRTZXJ2aWNlLmNoYXJ0LFxuICAgICAgICBcImdyb3VwZWRCYXJcIiA6IGdyb3VwZWRCYXJDaGFydFNlcnZpY2UuY2hhcnQsXG4gICAgICAgIFwidGFibGVcIiA6IHRhYmxlU2VydmljZS5jaGFydFxuICAgIH07XG4gICAgcmV0dXJuICB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICB3aGljaDogXCI9d2hpY2hcIixcbiAgICAgICAgICAgIHR5cGU6IFwiPXR5cGVcIlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRhdGEgOiBzY29wZS5kYXRhLFxuICAgICAgICAgICAgICAgIC8vICAgICBjb25maWcgOiBzY29wZS5jb25maWdcbiAgICAgICAgICAgICAgICAvLyB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcnRzW3Njb3BlLnR5cGVdKGVsZW1lbnRbMF0sIHJlc3VsdC5kYXRhLCB7fSk7IC8vc2NvcGUuY29uZmlnXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KFwiL3N0YXRpYy9kaXN0L2RhdGEvY3N2L1wiICsgc2NvcGUud2hpY2ggKyBcIi5jc3ZcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFydHNbc2NvcGUudHlwZV0oZWxlbWVudFswXSwgc2NvcGUuZGF0YSwge30pOyAvL3Njb3BlLmNvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCd3aGljaCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnJlbmRlcigpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgIFRoaXMgY29kZSBpcyBpbnRlbmRlZCB0byBnZXQgdGhlIGNoYXJ0IHRvIHJlZHJhdyB3aGVuIHRoZSB3aW5kb3cgaXMgcmVzaXplZFxuICAgICAgICAgICAgICAgIEJ1dCBhcyBpdCBzdGFuZHMsIHNvbWVob3cgdGhpcyBvdmVycmlkZXMgdGhlIGRhdGEgYW5kIHRoZSBjaGFydCBiZWNvbWVzIHVzZWxlc3MuXG4gICAgICAgICAgICAgICAgSSBkb24ndCB0aGluayB0aGlzIGZlYXR1cmUgaXMgd29ydGggdGhlIGRlYnVnIHRpbWUgbm93LCBidXQgaXQncyB3b3J0aCBrZWVwaW5nIGluIG1pbmQgZm9yIHRoZSBmdXR1cmUuXG4gICAgICAgICAgICAqKi9cbiAgICAgICAgICAgIC8vICR3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vICAgICBzY29wZS5yZW5kZXIoKVxuICAgICAgICAgICAgLy8gfTtcblxuICAgICAgICAgICAgLy8gc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignZGF0YScsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIC8vICAgICBzY29wZS5yZW5kZXIoZGF0YSk7XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICB9XG4gICAgfVxufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdncm91cGVkQmFyQ2hhcnRTZXJ2aWNlJywgWyckcScsICckaHR0cCcsICdsb2Rhc2gnLCBmdW5jdGlvbigkcSwgJGh0dHAsIGxvZGFzaCkge1xuICAgIHZhciBncm91cGVkQmFyQ2hhcnRTZXJ2aWNlID0ge307XG5cbiAgICBncm91cGVkQmFyQ2hhcnRTZXJ2aWNlLmNoYXJ0ID0gZnVuY3Rpb24oY29udGFpbmVyLCBkYXRhLCBjb25maWcpIHtcbiAgICAgICAgdmFyIHRpbWVGb3JtYXRzID0ge1xuICAgICAgICAgICAgXCJ5ZWFyXCIgOiBcIllZWVlcIixcbiAgICAgICAgICAgIFwicXVhcnRlclwiIDogXCJbUV1RIFlZWVlcIixcbiAgICAgICAgICAgIFwibW9udGhcIiA6IFwiTU1NIFlZWVlcIlxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbmZpZy5mYWNldCA9IGxvZGFzaC5kaWZmZXJlbmNlKFtcInN0cnVjdHVyZVwiLCBcInRpbWVcIl0sIFtjb25maWcuZmFjZXRdKVswXVxuXG4gICAgICAgIC8vIGNvbnZlcnQgZGF0YSBmcm9tIHN0cmluZyAtPiBhcnJheSBvZiBvYmpcbiAgICAgICAgZGF0YSA9IGQzLmNzdi5wYXJzZShkYXRhKTtcblxuICAgICAgICB2YXIgZ3JvdXBLZXlzID0gbG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkdyb3VwOyB9KVxuICAgICAgICAgICAgICAgIC51bmlxdWUoKVxuICAgICAgICAgICAgICAgIC52YWx1ZSgpLFxuICAgICAgICAgICAgYmFyS2V5cyA9bG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkJhcjsgfSlcbiAgICAgICAgICAgICAgICAudW5pcXVlKClcbiAgICAgICAgICAgICAgICAudmFsdWUoKVxuICAgICAgICAgICAgeVJhbmdlTWF4ID0gbG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiArZC5WYWx1ZTsgfSlcbiAgICAgICAgICAgICAgICAubWF4KClcbiAgICAgICAgICAgICAgICAudmFsdWUoKTtcblxuICAgICAgICAvLyBuZXN0IGRhdGEgYnkgYmFyIGdyb3Vwc1xuICAgICAgICBkYXRhID0gZDMubmVzdCgpXG4gICAgICAgICAgICAua2V5KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuR3JvdXA7IH0pXG4gICAgICAgICAgICAuZW50cmllcyhkYXRhKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBtYXBzXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImdyb3VwZWRiYXItY29udGFpbmVyXCIsIHRydWUpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJncm91cGVkYmFyLWNvbnRhaW5lci1pbnRlcm5hbFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5kYXR1bShkYXRhKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBsZWdlbmRzXG4gICAgICAgIGxlZ2VuZENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgXCJsZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwiZ3JvdXBlZGJhci1sZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgIFwiZ3JvdXBlZGJhci1sZWdlbmQtY29udGFpbmVyLWludGVybmFsXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZGF0dW0oYmFyS2V5cyk7XG5cbiAgICAgICAgLy8gY2hhcnRDb250YWluZXIuYXBwZW5kKFwicHJlXCIpXG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSk7XG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeSh5UmFuZ2VNYXgsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGJhcktleXMsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGNvbmZpZywgbnVsbCwgNCkpO1xuICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgbWFrZUdyb3VwZWRCYXJDaGFydChjaGFydENvbnRhaW5lcik7XG5cbiAgICAgICAgbWFrZUxlZ2VuZChsZWdlbmRDb250YWluZXIpO1xuXG4gICAgICAgIC8vIC8qKiBTVEFSVCBTQ1JPTEwgTk9USUNFICoqL1xuICAgICAgICAvLyAvLyBpZiB3ZSBhcmUgdW5kZXIgYSBjZXJ0YWluIHBpeGVsIHNpemUsIHRoZXJlIHdpbGwgYmUgaG9yaXpvbnRhbCBzY3JvbGxpbmdcbiAgICAgICAgLy8gdmFyIGludGVybmFsQ29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi5ncm91cGVkYmFyLWNvbnRhaW5lci1pbnRlcm5hbFwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIC8vICAgICBjb250YWluZXJTaXplID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2Lmdyb3VwZWRiYXItY29udGFpbmVyXCIpLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAvLyAvLyBjb25zb2xlLmxvZyhpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggKyBcIiAvIFwiICsgY29udGFpbmVyU2l6ZS53aWR0aClcbiAgICAgICAgLy8gaWYgKGludGVybmFsQ29udGFpbmVyU2l6ZS53aWR0aCA+IGNvbnRhaW5lclNpemUud2lkdGgpIHtcbiAgICAgICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKFwic2Nyb2xsIE5vdGljZSFcIilcbiAgICAgICAgLy8gICAgIC8vIGNyZWF0ZSBzY3JvbGwgbm90aWNlXG4gICAgICAgIC8vICAgICB2YXIgc2Nyb2xsTm90aWNlID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2Lmdyb3VwZWRiYXItY29udGFpbmVyXCIpLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKFwic2Nyb2xsLW5vdGljZVwiLCB0cnVlKVxuICAgICAgICAvLyAgICAgICAgIC5hcHBlbmQoXCJwXCIpO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwiaVwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYVwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYS1hbmdsZS1kb3VibGUtZG93biBcIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICB9KTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcInNwYW5cIilcbiAgICAgICAgLy8gICAgICAgICAudGV4dChcIlNjcm9sbCBmb3IgbW9yZVwiKTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuZ3JvdXBlZGJhci1jb250YWluZXJcIikub24oXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAvLyBpZiBzY3JvbGwgYXQgYm90dG9tLCBoaWRlIHNjcm9sbCBub3RpY2VcbiAgICAgICAgLy8gICAgIC8vIHVzaW5nIGEgZGlmZmVyZW50IGNsYXNzIHNvIGFzIG5vdCB0byBpbnRlcmZlcmUgd2l0aCB0aGUgbW91c2VvdmVyIGVmZmVjdHNcbiAgICAgICAgLy8gICAgIGlmICgoZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5zY3JvbGxMZWZ0ICsgZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5vZmZzZXRXaWR0aCkgPj0gKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsV2lkdGggKiAwLjk3NSkpIHtcbiAgICAgICAgLy8gICAgICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcImhpZGRlblwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gICAgIH0gZWxzZSB7XG4gICAgICAgIC8vICAgICAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAvKiogRU5EIFNDUk9MTCBOT1RJQ0UgKiovXG5cbiAgICAgICAgLy8gLy8gYWRkIGhvdmVyIGVmZmVjdHMgLSB1c2UgY2xhc3NlcyBcImhpZ2hsaWdodFwiIGFuZCBcImxvd2xpZ2h0XCJcbiAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy5ncm91cGVkYmFyLWxpbmVzID4gcGF0aCwgZy5ncm91cGVkYmFyLXBvaW50cyA+IHBhdGhcIilcbiAgICAgICAgLy8gLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICB2YXIgY2xhc3NUb0hpZ2hsaWdodCA9IGQzLnNlbGVjdCh0aGlzKS5hdHRyKFwiZGF0YS1jbGFzc1wiKTtcblxuICAgICAgICAvLyAgICAgLy8gbG93bGlnaHQgYWxsIGVsZW1lbnRzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLmdyb3VwZWRiYXItbGluZXMgPiBwYXRoLCBnLmdyb3VwZWRiYXItcG9pbnRzID4gcGF0aCwgZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gICAgIC8vIGhpZ2hsaWdodCBhbGwgZWxlbWVudHMgd2l0aCBtYXRjaGluZyBkYXRhLWNsYXNzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LlwiK2NsYXNzVG9IaWdobGlnaHQrXCIsIGcuZ3JvdXBlZGJhci1saW5lcyA+IHBhdGguXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy5ncm91cGVkYmFyLXBvaW50cyBwYXRoLlwiK2NsYXNzVG9IaWdobGlnaHQpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogZmFsc2UsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IHRydWVcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgLy8gcmVtb3ZlIGFsbCBoaWdobGlnaHQvbG93bGlnaHQgY2xhc3Nlc1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy5ncm91cGVkYmFyLWxpbmVzID4gcGF0aCwgZy5ncm91cGVkYmFyLXBvaW50cyA+IHBhdGgsIGRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogZmFsc2UsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gbWFrZUxlZ2VuZChzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKGxlZ2VuZERhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBjb2xvciBzY2FsZVxuICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtcImJhci1jb2xvci0xXCIsIFwiYmFyLWNvbG9yLTJcIiwgXCJiYXItY29sb3ItM1wiLCBcImJhci1jb2xvci00XCJdKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKGJhcktleXMpXG5cbiAgICAgICAgICAgICAgICB2YXIgbGVnZW5kRW50cmllcyA9IGQzLnNlbGVjdCh0aGlzKS5zZWxlY3RBbGwoXCJkaXYuZ3JvdXBlZGJhci1sZWdlbmQtZW50cnlcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEobGVnZW5kRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJncm91cGVkYmFyLWxlZ2VuZC1lbnRyeVwiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdHVtKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQ7IH0pXG5cbiAgICAgICAgICAgICAgICBsZWdlbmRFbnRyaWVzLmVhY2goZnVuY3Rpb24oZW50cnlEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImdyb3VwZWRiYXItbGVnZW5kLWVudHJ5LWNvbG9yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9ycyhlbnRyeURhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiIFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwic3BhblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJncm91cGVkYmFyLWxlZ2VuZC1lbnRyeS1sYWJlbFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoZW50cnlEYXRhKTtcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLy8gYWxsIHNwYW5zIGFyZSBieSBkZWZhdWx0IHVuc3R5bGVkLCB3aXRoIG5vIHdheSB0byBkbyBpdCBpbiBqZXRwYWNrLFxuICAgICAgICAgICAgICAgIC8vIHNvIGluIG9yZGVyIHRvIGZpZ2h0IHRoZSBoYW5naW5nIGluZGVudCBlZmZlY3QsIG1vdmUgdGhlbSBvdmVyIDggcHhcbiAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3RBbGwoXCJ0c3BhblwiKS5hdHRyKFwiZHhcIiwgOClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbWFrZUdyb3VwZWRCYXJDaGFydChzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIGhlbHBlciBmdW5jdGlvbiwgd3JhcHMgdGV4dCBmb3IgYXhpcyBsYWJlbHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIHdyYXAodGV4dCwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgdGV4dC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gZDMuc2VsZWN0KHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICB3b3JkcyA9IHRleHQudGV4dCgpLnNwbGl0KC9cXHMrLykucmV2ZXJzZSgpLFxuICAgICAgICAgICAgICAgICAgICB3b3JkLFxuICAgICAgICAgICAgICAgICAgICBsaW5lID0gW10sXG4gICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIgPSAwLFxuICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gMS4xLCAvLyBlbXNcbiAgICAgICAgICAgICAgICAgICAgeSA9IHRleHQuYXR0cihcInlcIiksXG4gICAgICAgICAgICAgICAgICAgIGR5ID0gcGFyc2VGbG9hdCh0ZXh0LmF0dHIoXCJkeVwiKSksXG4gICAgICAgICAgICAgICAgICAgIHRzcGFuID0gdGV4dC50ZXh0KG51bGwpLmFwcGVuZChcInRzcGFuXCIpLmF0dHIoXCJ4XCIsIDApLmF0dHIoXCJ5XCIsIHkpLmF0dHIoXCJkeVwiLCBkeSArIFwiZW1cIik7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHdvcmQgPSB3b3Jkcy5wb3AoKSkge1xuICAgICAgICAgICAgICAgICAgbGluZS5wdXNoKHdvcmQpO1xuICAgICAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oXCIgXCIpKTtcbiAgICAgICAgICAgICAgICAgIGlmICh0c3Bhbi5ub2RlKCkuZ2V0Q29tcHV0ZWRUZXh0TGVuZ3RoKCkgPiB3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5lLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICB0c3Bhbi50ZXh0KGxpbmUuam9pbihcIiBcIikpO1xuICAgICAgICAgICAgICAgICAgICBsaW5lID0gW3dvcmRdO1xuICAgICAgICAgICAgICAgICAgICB0c3BhbiA9IHRleHQuYXBwZW5kKFwidHNwYW5cIikuYXR0cihcInhcIiwgMCkuYXR0cihcInlcIiwgeSkuYXR0cihcImR5XCIsICsrbGluZU51bWJlciAqIGxpbmVIZWlnaHQgKyBkeSArIFwiZW1cIikudGV4dCh3b3JkKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZWxlY3Rpb24uZWFjaChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gc2l6aW5nIGFuZCBtYXJnaW4gdmFyc1xuICAgICAgICAgICAgICAgIHZhciBCQm94ID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIiA6IEJCb3guaGVpZ2h0ICogMC4wNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIiA6IEJCb3gud2lkdGggKiAwLjA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIiA6IEJCb3guaGVpZ2h0ICogMC4zLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCIgOiBkMy5tYXgoW0JCb3gud2lkdGggKiAwLjA1LCA3NV0pXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gQkJveC53aWR0aCAtIChtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gQkJveC5oZWlnaHQgLSAobWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20pLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHRvb2x0aXAgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgdGlwID0gZDMudGlwKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJncm91cGVkYmFyLXRpcFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2Rhc2guY2hhaW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLkxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5mb3JtYXQoXCJmXCIpKGQuVmFsdWUpICsgXCIlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb21wYWN0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbihcIjxiciAvPlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGFpbmVyc1xuICAgICAgICAgICAgICAgICAgICBzdmcgPSBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwic3ZnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBCQm94LmhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgQkJveC53aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHRpcClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIDApXCIpLFxuICAgICAgICAgICAgICAgICAgICBjaGFydCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIiksXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlc3Rpbmcgc3R1ZmYgLSBkcmF3cyBvdXRsaW5lcyBhcm91bmQgc3ZnIGFuZCBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gc3ZnT3V0bGluZSA9IHN2Zy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImhlaWdodFwiLCBzdmcuYXR0cihcImhlaWdodFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwid2lkdGhcIiwgc3ZnLmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwicmVkXCIpLFxuICAgICAgICAgICAgICAgICAgICAvLyBjaGFydE91dGxpbmUgPSBzdmcuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGNoYXJ0LmF0dHIoXCJoZWlnaHRcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcIndpZHRoXCIsIGNoYXJ0LmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIgLFwiYmx1ZVwiKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb2xvciBzY2FsZVxuICAgICAgICAgICAgICAgICAgICBjb2xvcnMgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbXCJiYXItY29sb3ItMVwiLCBcImJhci1jb2xvci0yXCIsIFwiYmFyLWNvbG9yLTNcIiwgXCJiYXItY29sb3ItNFwiXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oYmFyS2V5cyksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8geCBhbmQgeSBzY2FsZXNcbiAgICAgICAgICAgICAgICAgICAgeDAgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZVJvdW5kQmFuZHMoWzAsIHdpZHRoXSwgMC4yLCAwLjIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKGdyb3VwS2V5cyksXG4gICAgICAgICAgICAgICAgICAgIHgxID0gZDMuc2NhbGUub3JkaW5hbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2VSb3VuZEJhbmRzKFswLCB4MC5yYW5nZUJhbmQoKV0sIDAuMSwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oYmFyS2V5cyksXG4gICAgICAgICAgICAgICAgICAgIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgeVJhbmdlTWF4XSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5uaWNlKDUpLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIC8vIGF4aXMgZnVuY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgIHgwQXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh4MClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vcmllbnQoXCJib3R0b21cIiksXG4gICAgICAgICAgICAgICAgICAgIHgxQXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh4MSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vcmllbnQoXCJib3R0b21cIiksXG4gICAgICAgICAgICAgICAgICAgIHlBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNjYWxlKHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JpZW50KFwibGVmdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmlubmVyVGlja1NpemUoLXdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRpY2tQYWRkaW5nKDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRpY2tGb3JtYXQoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5mb3JtYXQoXCJmXCIpKHQpICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyB0ZXN0IG91dHB1dCBmb3IgdHJvdWJsZXNob290aW5nIHRoZSBkYXRhIHN0dWZmXG4gICAgICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKVxuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHgwQXhpc0dyb3VwID0gY2hhcnQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwieC1heGlzXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXhpc1wiIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIFwiICsgaGVpZ2h0ICsgXCIpXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh4MEF4aXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHdvcmR3cmFwIGF4aXMgbGFiZWxzXG4gICAgICAgICAgICAgICAgICAgIHgwQXhpc0dyb3VwLnNlbGVjdEFsbChcIi50aWNrIHRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh3cmFwLCB4MC5yYW5nZUJhbmQoKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwieS1heGlzXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXhpc1wiIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKC0xMiwgMClcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHlBeGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIGJhciBncm91cHNcblxuICAgICAgICAgICAgICAgICAgICB2YXIgYmFyR3JvdXBzID0gY2hhcnQuc2VsZWN0QWxsKFwiZy5ncm91cGVkYmFyLWdyb3VwXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJncm91cGVkYmFyLWdyb3VwXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB4MC5yYW5nZUJhbmQoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyB4MChkLmtleSkgKyBcIiwgMClcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXR1bShmdW5jdGlvbihkKSB7IHJldHVybiBkLnZhbHVlczsgfSlcblxuICAgICAgICAgICAgICAgICAgICBiYXJHcm91cHMuZWFjaChmdW5jdGlvbihncm91cERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBzb21lIGdyb3VwLXNwZWNpZmljIHZhcnMgc2V0IHVwXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc0dyb3VwQmFycyA9IGxvZGFzaC5jaGFpbihncm91cERhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5CYXI7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aXRob3V0KFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWx1ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNHcm91cExhYmVscyA9IGxvZGFzaC5jaGFpbihncm91cERhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5MYWJlbDsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpdGhvdXQoXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyb3VwWDEgPSB4MS5jb3B5KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbih0aGlzR3JvdXBCYXJzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHRoaXNHcm91cExhYmVscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gbW92ZSB4MC1heGlzIGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB4MEF4aXNHcm91cC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIFwiICsgKGhlaWdodCArIChtYXJnaW4uYm90dG9tLzIpKSArIFwiKVwiKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gLy8gLy8gVXNpbmcgeDEgYXhpcyB0byBsYWJlbCBpbmRpdmlkdWFsIGJhcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gICAgICAgICBcIngtYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyAgICAgICAgIFwiYXhpc1wiIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCBcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vICAgICAuY2FsbCh4MSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5zZWxlY3RBbGwoXCJyZWN0Lmdyb3VwZWRiYXItYmFyXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoZ3JvdXBEYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1wiZ3JvdXBlZGJhci1iYXJcIiwgY29sb3JzKGQuQmFyKV0uam9pbihcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgdGhpc0dyb3VwWDEucmFuZ2VCYW5kKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGhlaWdodCAtIHkoZC5WYWx1ZSk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB0aGlzR3JvdXBYMShkLkJhcik7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQuVmFsdWUpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW92ZXJcIiwgdGlwLnNob3cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIHRpcC5oaWRlKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QodGhpcykuc2VsZWN0QWxsKFwidGV4dC5ncm91cGVkYmFyLXZhbHVlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmRhdGEoZ3JvdXBEYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgIC5jbGFzc2VkKFwiZ3JvdXBlZGJhci12YWx1ZVwiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAudGV4dChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KFwiMC4xZlwiKShkLlZhbHVlKSArIFwiJVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcIndpZHRoXCIsIHRoaXNHcm91cFgxLnJhbmdlQmFuZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLlZhbHVlKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gdGhpc0dyb3VwWDEoZC5CYXIpICsgKHRoaXNHcm91cFgxLnJhbmdlQmFuZCgpLzIpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAuYXR0cihcImR5XCIsIC00KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2luZyB0ZXh0IHRvIGxhYmVsIGluZGl2aWR1YWwgYmFyc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZDMuc2VsZWN0KHRoaXMpLnNlbGVjdEFsbChcInRleHQuZ3JvdXBlZGJhci1sYWJlbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5kYXRhKGdyb3VwRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAuY2xhc3NlZChcImdyb3VwZWRiYXItbGFiZWxcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5MYWJlbDsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB4MS5yYW5nZUJhbmQoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVkFSSUFUSU9OUyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5kZXIgYmFycywgbWlkZGxlIGFsaWduZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoXCJ5XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geDEoZC5CYXIpICsgKHgxLnJhbmdlQmFuZCgpLzIpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAuYXR0cihcImR5XCIsIDE2KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5zaWRlIGJhcnMsIHJvdGF0ZWQgcmlnaHQgOTAgZGVnLCBhdCByaWdodCBzaWRlIG9mIGJhciB3aXRoIHggYW5kIHkgcGFkZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSgtOTApXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCAtaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR4XCIsIDQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJzdGFydFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geDEoZC5CYXIpICsgeDEucmFuZ2VCYW5kKCk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgLTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ3JvdXBlZEJhckNoYXJ0U2VydmljZTtcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdzaW1wbGV0YWJsZScsIGZ1bmN0aW9uKCkge1xuICAgIC8vIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHJlZmxlY3Qgd2hhdGV2ZXIgeW91ciBkMyB0YWJsZSBmdW5jdGlvbiBpcyBjYWxsZWQuXG4gICAgdmFyIGNoYXJ0ID0gdGFibGVDaGFydCgpO1xuICAgIHJldHVybiAge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgZGF0YTogXCI9ZGF0YVwiIC8vIFdlIGNhbiBjYWxsIHRoaXMgdy9lIHdlIHdhbnQuXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignZGF0YScsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCd0YWJsZVNlcnZpY2UnLCBbJyRxJywgJyRodHRwJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRxLCAkaHR0cCwgbG9kYXNoKSB7XG4gICAgdmFyIHRhYmxlU2VydmljZSA9IHt9O1xuXG4gICAgdGFibGVTZXJ2aWNlLmNoYXJ0ID0gZnVuY3Rpb24oY29udGFpbmVyLCBkYXRhLCBjb25maWcpIHtcbiAgICAgICAgY29uZmlnLmZhY2V0ID0gbG9kYXNoLmRpZmZlcmVuY2UoW1wic3RydWN0dXJlXCIsIFwidGltZVwiXSwgW2NvbmZpZy5mYWNldF0pWzBdXG5cbiAgICAgICAgLy8gY29udmVydCBkYXRhIGZyb20gc3RyaW5nIC0+IGFycmF5IG9mIG9ialxuICAgICAgICBkYXRhID0gZDMuY3N2LnBhcnNlKGRhdGEpO1xuXG4gICAgICAgIC8vIHZhciBncm91cEtleXMgPSBsb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgLy8gICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuR3JvdXA7IH0pXG4gICAgICAgIC8vICAgICAgICAgLnVuaXF1ZSgpXG4gICAgICAgIC8vICAgICAgICAgLnZhbHVlKCksXG4gICAgICAgIC8vICAgICBiYXJLZXlzID1sb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgLy8gICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuQmFyOyB9KVxuICAgICAgICAvLyAgICAgICAgIC51bmlxdWUoKVxuICAgICAgICAvLyAgICAgICAgIC52YWx1ZSgpXG4gICAgICAgIC8vICAgICB5UmFuZ2VNYXggPSBsb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgLy8gICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuICtkLlZhbHVlOyB9KVxuICAgICAgICAvLyAgICAgICAgIC5tYXgoKVxuICAgICAgICAvLyAgICAgICAgIC52YWx1ZSgpO1xuXG5cbiAgICAgICAgdmFyIGNvbHVtbktleXMgPSBbXTtcbiAgICAgICAgZm9yKGsgaW4gZGF0YVswXSkge1xuICAgICAgICAgICAgY29sdW1uS2V5cy5wdXNoKGspO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3JlYXRlIGNvbnRhaW5lciBmb3IgbWFwc1xuICAgICAgICBjaGFydENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJ0YWJsZS1jb250YWluZXJcIiwgdHJ1ZSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRhYmxlLWNvbnRhaW5lci1pbnRlcm5hbFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5kYXR1bShkYXRhKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBsZWdlbmRzXG4gICAgICAgIC8vIGxlZ2VuZENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgIC8vICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgIFwidGFibGUtbGVnZW5kLWNvbnRhaW5lclwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgIH0pO1xuXG4gICAgICAgIC8vIGNoYXJ0Q29udGFpbmVyLmFwcGVuZChcInByZVwiKVxuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgNCkpO1xuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoY29sdW1uS2V5cywgbnVsbCwgNCkpO1xuICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgbWFrZVRhYmxlKGNoYXJ0Q29udGFpbmVyKTtcblxuICAgICAgICByZXR1cm47XG5cbiAgICAgICAgdmFyIGxlZ2VuZERpdiA9IGxlZ2VuZENvbnRhaW5lci5zZWxlY3RBbGwoXCJkaXYubGVnZW5kXCIpXG4gICAgICAgICAgICAuZGF0YShbYmFyS2V5c10pXG4gICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWdlbmRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJ0YWJsZS1sZWdlbmRcIjogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgbWFrZUxlZ2VuZChsZWdlbmREaXYpO1xuXG4gICAgICAgIFxuICAgICAgICAvLyAvKiogU1RBUlQgU0NST0xMIE5PVElDRSAqKi9cbiAgICAgICAgLy8gLy8gaWYgd2UgYXJlIHVuZGVyIGEgY2VydGFpbiBwaXhlbCBzaXplLCB0aGVyZSB3aWxsIGJlIGhvcml6b250YWwgc2Nyb2xsaW5nXG4gICAgICAgIC8vIHZhciBpbnRlcm5hbENvbnRhaW5lclNpemUgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYudGFibGUtY29udGFpbmVyLWludGVybmFsXCIpLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgLy8gICAgIGNvbnRhaW5lclNpemUgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYudGFibGUtY29udGFpbmVyXCIpLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAvLyAvLyBjb25zb2xlLmxvZyhpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggKyBcIiAvIFwiICsgY29udGFpbmVyU2l6ZS53aWR0aClcbiAgICAgICAgLy8gaWYgKGludGVybmFsQ29udGFpbmVyU2l6ZS53aWR0aCA+IGNvbnRhaW5lclNpemUud2lkdGgpIHtcbiAgICAgICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKFwic2Nyb2xsIE5vdGljZSFcIilcbiAgICAgICAgLy8gICAgIC8vIGNyZWF0ZSBzY3JvbGwgbm90aWNlXG4gICAgICAgIC8vICAgICB2YXIgc2Nyb2xsTm90aWNlID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2LnRhYmxlLWNvbnRhaW5lclwiKS5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZChcInNjcm9sbC1ub3RpY2VcIiwgdHJ1ZSlcbiAgICAgICAgLy8gICAgICAgICAuYXBwZW5kKFwicFwiKTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgIC8vICAgICAgICAgLnRleHQoXCJTY3JvbGwgZm9yIG1vcmVcIik7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBcImZhXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnRhYmxlLWNvbnRhaW5lclwiKS5vbihcInNjcm9sbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gICAgIC8vIGlmIHNjcm9sbCBhdCBib3R0b20sIGhpZGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAvLyAgICAgLy8gdXNpbmcgYSBkaWZmZXJlbnQgY2xhc3Mgc28gYXMgbm90IHRvIGludGVyZmVyZSB3aXRoIHRoZSBtb3VzZW92ZXIgZWZmZWN0c1xuICAgICAgICAvLyAgICAgaWYgKChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbExlZnQgKyBkMy5zZWxlY3QodGhpcykubm9kZSgpLm9mZnNldFdpZHRoKSA+PSAoZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5zY3JvbGxXaWR0aCAqIDAuOTc1KSkge1xuICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwiaGlkZGVuXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gICAgICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcImhpZGRlblwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vIC8qKiBFTkQgU0NST0xMIE5PVElDRSAqKi9cblxuICAgICAgICAvLyAvLyBhZGQgaG92ZXIgZWZmZWN0cyAtIHVzZSBjbGFzc2VzIFwiaGlnaGxpZ2h0XCIgYW5kIFwibG93bGlnaHRcIlxuICAgICAgICAvLyBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLnRhYmxlLWxpbmVzID4gcGF0aCwgZy50YWJsZS1wb2ludHMgPiBwYXRoXCIpXG4gICAgICAgIC8vIC5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgdmFyIGNsYXNzVG9IaWdobGlnaHQgPSBkMy5zZWxlY3QodGhpcykuYXR0cihcImRhdGEtY2xhc3NcIik7XG5cbiAgICAgICAgLy8gICAgIC8vIGxvd2xpZ2h0IGFsbCBlbGVtZW50c1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy50YWJsZS1saW5lcyA+IHBhdGgsIGcudGFibGUtcG9pbnRzID4gcGF0aCwgZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gICAgIC8vIGhpZ2hsaWdodCBhbGwgZWxlbWVudHMgd2l0aCBtYXRjaGluZyBkYXRhLWNsYXNzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LlwiK2NsYXNzVG9IaWdobGlnaHQrXCIsIGcudGFibGUtbGluZXMgPiBwYXRoLlwiK2NsYXNzVG9IaWdobGlnaHQrXCIsIGcudGFibGUtcG9pbnRzIHBhdGguXCIrY2xhc3NUb0hpZ2hsaWdodClcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiBmYWxzZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICAvLyByZW1vdmUgYWxsIGhpZ2hsaWdodC9sb3dsaWdodCBjbGFzc2VzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLnRhYmxlLWxpbmVzID4gcGF0aCwgZy50YWJsZS1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VUYWJsZShzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgdGFibGUgPSBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwidGFibGVcIiksXG4gICAgICAgICAgICAgICAgdGhlYWQgPSB0YWJsZS5hcHBlbmQoXCJ0aGVhZFwiKSxcbiAgICAgICAgICAgICAgICB0Ym9keSA9IHRhYmxlLmFwcGVuZChcImJvZHlcIilcbiAgICAgICAgICAgICAgICA7XG5cbiAgICAgICAgICAgICAgICAvLyAvLyB0ZXN0IG91dHB1dCBmb3IgdHJvdWJsZXNob290aW5nIHRoZSBkYXRhIHN0dWZmXG4gICAgICAgICAgICAgICAgLy8gZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInByZVwiKVxuICAgICAgICAgICAgICAgIC8vICAgICAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSlcbiAgICAgICAgICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBoZWFkZXJcbiAgICAgICAgICAgICAgICB0aGVhZC5hcHBlbmQoXCJ0clwiKVxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0QWxsKFwidGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEoY29sdW1uS2V5cylcbiAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJ0aFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSlcblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhYmxlU2VydmljZTtcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgndGltZXNlcmllc1NlcnZpY2UnLCBbJyRxJywgJyRodHRwJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRxLCAkaHR0cCwgbG9kYXNoKSB7XG4gICAgdmFyIHRpbWVzZXJpZXNTZXJ2aWNlID0ge307XG5cbiAgICB0aW1lc2VyaWVzU2VydmljZS5jaGFydCA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgZGF0YSwgY29uZmlnKSB7XG4gICAgICAgIHZhciB0aW1lRm9ybWF0cyA9IHtcbiAgICAgICAgICAgIFwieWVhclwiIDogXCJZWVlZXCIsXG4gICAgICAgICAgICBcInF1YXJ0ZXJcIiA6IFwiW1FdUSBZWVlZXCIsXG4gICAgICAgICAgICBcIm1vbnRoXCIgOiBcIk1NTSBZWVlZXCJcbiAgICAgICAgfTtcblxuICAgICAgICBjb25maWcuZmFjZXQgPSBsb2Rhc2guZGlmZmVyZW5jZShbXCJzdHJ1Y3R1cmVcIiwgXCJ0aW1lXCJdLCBbY29uZmlnLmZhY2V0XSlbMF1cblxuICAgICAgICAvLyBjb252ZXJ0IGRhdGEgZnJvbSBzdHJpbmcgLT4gYXJyYXkgb2Ygb2JqXG4gICAgICAgIGRhdGEgPSBkMy5jc3YucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgLy8ga2V5cyBmb3IgY29sb3IgYW5kIHNoYXBlIHNjYWxlc1xuICAgICAgICB2YXIgbGluZUtleXMgPSBsb2Rhc2guY2hhaW4oZGF0YVswXSlcbiAgICAgICAgICAgIC5rZXlzKClcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oaykgeyByZXR1cm4gayAhPT0gXCJZZWFyXCI7IH0pXG4gICAgICAgICAgICAudmFsdWUoKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBtYXBzXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtY29udGFpbmVyXCIsIHRydWUpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJ0aW1lc2VyaWVzLWNvbnRhaW5lci1pbnRlcm5hbFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5kYXR1bShkYXRhKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBsZWdlbmRzXG4gICAgICAgIGxlZ2VuZENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgXCJsZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwidGltZXNlcmllcy1sZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gY2hhcnRDb250YWluZXIuYXBwZW5kKFwicHJlXCIpXG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSk7XG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeShjb25maWcsIG51bGwsIDQpKTtcbiAgICAgICAgLy8gcmV0dXJuO1xuXG4gICAgICAgIG1ha2VUaW1lU2VyaWVzKGNoYXJ0Q29udGFpbmVyKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBsZWdlbmRzXG4gICAgICAgIGxlZ2VuZENvbnRhaW5lciA9IGQzLnNlbGVjdChjb250YWluZXIpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgXCJsZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwidGltZXNlcmllcy1sZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgIFwidGltZXNlcmllcy1sZWdlbmQtY29udGFpbmVyLWludGVybmFsXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZGF0dW0obGluZUtleXMpO1xuXG4gICAgICAgIG1ha2VMZWdlbmQobGVnZW5kQ29udGFpbmVyKTtcblxuICAgICAgICAvLyAvKiogU1RBUlQgU0NST0xMIE5PVElDRSAqKi9cbiAgICAgICAgLy8gLy8gaWYgd2UgYXJlIHVuZGVyIGEgY2VydGFpbiBwaXhlbCBzaXplLCB0aGVyZSB3aWxsIGJlIGhvcml6b250YWwgc2Nyb2xsaW5nXG4gICAgICAgIC8vIHZhciBpbnRlcm5hbENvbnRhaW5lclNpemUgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYudGltZXNlcmllcy1jb250YWluZXItaW50ZXJuYWxcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAvLyAgICAgY29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50aW1lc2VyaWVzLWNvbnRhaW5lclwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgLy8gLy8gY29uc29sZS5sb2coaW50ZXJuYWxDb250YWluZXJTaXplLndpZHRoICsgXCIgLyBcIiArIGNvbnRhaW5lclNpemUud2lkdGgpXG4gICAgICAgIC8vIGlmIChpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggPiBjb250YWluZXJTaXplLndpZHRoKSB7XG4gICAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhcInNjcm9sbCBOb3RpY2UhXCIpXG4gICAgICAgIC8vICAgICAvLyBjcmVhdGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAvLyAgICAgdmFyIHNjcm9sbE5vdGljZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50aW1lc2VyaWVzLWNvbnRhaW5lclwiKS5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZChcInNjcm9sbC1ub3RpY2VcIiwgdHJ1ZSlcbiAgICAgICAgLy8gICAgICAgICAuYXBwZW5kKFwicFwiKTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgIC8vICAgICAgICAgLnRleHQoXCJTY3JvbGwgZm9yIG1vcmVcIik7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBcImZhXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnRpbWVzZXJpZXMtY29udGFpbmVyXCIpLm9uKFwic2Nyb2xsXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgLy8gaWYgc2Nyb2xsIGF0IGJvdHRvbSwgaGlkZSBzY3JvbGwgbm90aWNlXG4gICAgICAgIC8vICAgICAvLyB1c2luZyBhIGRpZmZlcmVudCBjbGFzcyBzbyBhcyBub3QgdG8gaW50ZXJmZXJlIHdpdGggdGhlIG1vdXNlb3ZlciBlZmZlY3RzXG4gICAgICAgIC8vICAgICBpZiAoKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsTGVmdCArIGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkub2Zmc2V0V2lkdGgpID49IChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbFdpZHRoICogMC45NzUpKSB7XG4gICAgICAgIC8vICAgICAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwiaGlkZGVuXCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLyoqIEVORCBTQ1JPTEwgTk9USUNFICoqL1xuXG4gICAgICAgIC8vIC8vIGFkZCBob3ZlciBlZmZlY3RzIC0gdXNlIGNsYXNzZXMgXCJoaWdobGlnaHRcIiBhbmQgXCJsb3dsaWdodFwiXG4gICAgICAgIC8vIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcudGltZXNlcmllcy1saW5lcyA+IHBhdGgsIGcudGltZXNlcmllcy1wb2ludHMgPiBwYXRoXCIpXG4gICAgICAgIC8vIC5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgdmFyIGNsYXNzVG9IaWdobGlnaHQgPSBkMy5zZWxlY3QodGhpcykuYXR0cihcImRhdGEtY2xhc3NcIik7XG5cbiAgICAgICAgLy8gICAgIC8vIGxvd2xpZ2h0IGFsbCBlbGVtZW50c1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy50aW1lc2VyaWVzLWxpbmVzID4gcGF0aCwgZy50aW1lc2VyaWVzLXBvaW50cyA+IHBhdGgsIGRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIC8vICAgICAvLyBoaWdobGlnaHQgYWxsIGVsZW1lbnRzIHdpdGggbWF0Y2hpbmcgZGF0YS1jbGFzc1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeS5cIitjbGFzc1RvSGlnaGxpZ2h0K1wiLCBnLnRpbWVzZXJpZXMtbGluZXMgPiBwYXRoLlwiK2NsYXNzVG9IaWdobGlnaHQrXCIsIGcudGltZXNlcmllcy1wb2ludHMgcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0KVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiB0cnVlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIC8vIHJlbW92ZSBhbGwgaGlnaGxpZ2h0L2xvd2xpZ2h0IGNsYXNzZXNcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcudGltZXNlcmllcy1saW5lcyA+IHBhdGgsIGcudGltZXNlcmllcy1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VMZWdlbmQoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBzZWxlY3Rpb24uZWFjaChmdW5jdGlvbihsZWdlbmREYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gY29sb3Igc2NhbGVcbiAgICAgICAgICAgICAgICBjb2xvcnMgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiMxRUFDRjFcIiwgXCIjQjk0QTQ4XCJdKVxuICAgICAgICAgICAgICAgICAgICAuZG9tYWluKGxpbmVLZXlzKTtcblxuICAgICAgICAgICAgICAgIHZhciBsZWdlbmRFbnRyaWVzID0gZDMuc2VsZWN0KHRoaXMpLnNlbGVjdEFsbChcImRpdi50aW1lc2VyaWVzLWxlZ2VuZC1lbnRyeVwiKVxuICAgICAgICAgICAgICAgICAgICAuZGF0YShsZWdlbmREYXRhKVxuICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtbGVnZW5kLWVudHJ5XCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0dW0oZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSlcblxuICAgICAgICAgICAgICAgIGxlZ2VuZEVudHJpZXMuZWFjaChmdW5jdGlvbihlbnRyeURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInNwYW5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwidGltZXNlcmllcy1sZWdlbmQtZW50cnktY29sb3JcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcImJhY2tncm91bmQtY29sb3JcIiwgY29sb3JzKGVudHJ5RGF0YSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtbGVnZW5kLWVudHJ5LWxhYmVsXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dChlbnRyeURhdGEpO1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAvLyBhbGwgc3BhbnMgYXJlIGJ5IGRlZmF1bHQgdW5zdHlsZWQsIHdpdGggbm8gd2F5IHRvIGRvIGl0IGluIGpldHBhY2ssXG4gICAgICAgICAgICAgICAgLy8gc28gaW4gb3JkZXIgdG8gZmlnaHQgdGhlIGhhbmdpbmcgaW5kZW50IGVmZmVjdCwgbW92ZSB0aGVtIG92ZXIgOCBweFxuICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdEFsbChcInRzcGFuXCIpLmF0dHIoXCJkeFwiLCA4KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtYWtlVGltZVNlcmllcyhzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBzaXppbmcgYW5kIG1hcmdpbiB2YXJzXG4gICAgICAgICAgICAgICAgdmFyIEJCb3ggPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiIDogQkJveC5oZWlnaHQgKiAwLjA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiIDogQkJveC53aWR0aCAqIDAuMDUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiIDogQkJveC5oZWlnaHQgKiAwLjEsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIiA6IGQzLm1heChbQkJveC53aWR0aCAqIDAuMDUsIDU1XSlcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBCQm94LndpZHRoIC0gKG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBCQm94LmhlaWdodCAtIChtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGFpbmVyc1xuICAgICAgICAgICAgICAgICAgICBzdmcgPSBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwic3ZnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBCQm94LmhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgQkJveC53aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIDApXCIpLFxuICAgICAgICAgICAgICAgICAgICBjaGFydCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIiksXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlc3Rpbmcgc3R1ZmYgLSBkcmF3cyBvdXRsaW5lcyBhcm91bmQgc3ZnIGFuZCBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gc3ZnT3V0bGluZSA9IHN2Zy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImhlaWdodFwiLCBzdmcuYXR0cihcImhlaWdodFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwid2lkdGhcIiwgc3ZnLmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwicmVkXCIpLFxuICAgICAgICAgICAgICAgICAgICAvLyBjaGFydE91dGxpbmUgPSBzdmcuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGNoYXJ0LmF0dHIoXCJoZWlnaHRcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcIndpZHRoXCIsIGNoYXJ0LmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIgLFwiYmx1ZVwiKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb2xvciBzY2FsZVxuICAgICAgICAgICAgICAgICAgICBjb2xvcnMgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbXCIjMUVBQ0YxXCIsIFwiI0I5NEE0OFwiXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4obGluZUtleXMpLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvaW50IHNoYXBlIFwic2NhbGVcIlxuICAgICAgICAgICAgICAgICAgICBzeW1ib2xTY2FsZSA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKGQzLnN2Zy5zeW1ib2xUeXBlcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZUtleXNcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8geCBhbmQgeSBzY2FsZXNcbiAgICAgICAgICAgICAgICAgICAgdGltZUZvcm1hdCA9IGQzLnRpbWUuZm9ybWF0KFwiJVlcIiksXG4gICAgICAgICAgICAgICAgICAgIHRpbWVSYW5nZSA9IGxvZGFzaC5jaGFpbihkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuWWVhcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudmFsdWUoKSxcbiAgICAgICAgICAgICAgICAgICAgeCA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFsxMiwgd2lkdGhdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5leHRlbnQodGltZVJhbmdlKS5tYXAoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGltZUZvcm1hdC5wYXJzZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW2hlaWdodCwgMF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLmV4dGVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZUtleXMubWFwKGZ1bmN0aW9uKGspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gK2Rba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZsYXR0ZW4oKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVuaXF1ZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsdWUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkvLy5tYXAoZnVuY3Rpb24odiwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuIChNYXRoLmNlaWwodi8xMCkgKiAxMCkgLSAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHJldHVybiAoTWF0aC5mbG9vcih2LzEwKSAqIDEwKSArIDEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5uaWNlKDUsIDEwKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyBheGlzIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICAgICAgICB4QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh4KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yaWVudChcImJvdHRvbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRpY2tzKGQzLnRpbWUueWVhciwgMSksXG4gICAgICAgICAgICAgICAgICAgIHlBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNjYWxlKHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JpZW50KFwibGVmdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmlubmVyVGlja1NpemUoLXdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRpY2tQYWRkaW5nKDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRpY2tGb3JtYXQoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5mb3JtYXQoXCJmXCIpKHQpICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyBsaW5lIGNoYXJ0aW5nIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSBkMy5zdmcubGluZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAueChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgoZC5ZZWFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnkoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGQuVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gc2x1ZyBmdW5jdGlvbiBmb3IgY2xhc3NpbmcgYW5kIGhpZ2hsaWdodGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyBzbHVnZ2lmeSA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiB0ZXh0LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzL2csIFwiX1wiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfTtcblxuICAgICAgICAgICAgICAgICAgICAvLyByZXNoYXBlIGRhdGEgZm9yIGxpbmVzXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBsaW5lS2V5cy5tYXAoZnVuY3Rpb24oaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktleVwiIDogayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZXMgOiBsb2Rhc2gubWFwKGRhdGEsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XCJZZWFyXCIgOiB0aW1lRm9ybWF0LnBhcnNlKGQuWWVhciksIFwiVmFsdWVcIiA6ICtkW2tdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIC8vIHRlc3Qgb3V0cHV0IGZvciB0cm91Ymxlc2hvb3RpbmcgdGhlIGRhdGEgc3R1ZmZcbiAgICAgICAgICAgICAgICAgICAgLy8gZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInByZVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLnRleHQoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgNCkpXG4gICAgICAgICAgICAgICAgICAgIC8vIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICBjaGFydC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ4LWF4aXNcIiA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJheGlzXCIgOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwgXCIgKyBoZWlnaHQgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHhBeGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBjaGFydC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ5LWF4aXNcIiA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJheGlzXCIgOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoLTEyLCAwKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeUF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LnNlbGVjdEFsbChcImcudGltZXNlcmllcy1saW5lc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwidGltZXNlcmllcy1saW5lc1wiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwidGltZXNlcmllcy1wYXRoXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZShkLlZhbHVlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnMoZC5LZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnREYXRhID0gZGF0YS5tYXAoZnVuY3Rpb24oZCwgZGksIGRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5WYWx1ZXMubWFwKGZ1bmN0aW9uKHYsIHZpLCB2YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuS2V5ID0gZC5LZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgcG9pbnREYXRhID0gbG9kYXNoLmZsYXR0ZW4ocG9pbnREYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICBjaGFydC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtcG9pbnRzXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0QWxsKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEocG9pbnREYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGZ1bmN0aW9uKGQsIGkpIHtyZXR1cm4gY29sb3JzKGQuS2V5KTsgfSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN2Zy5zeW1ib2woKS50eXBlKFwiY2lyY2xlXCIpLnNpemUoNjUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgeChkLlllYXIpICsgXCIsIFwiICsgeShkLlZhbHVlKSArXCIpXCI7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGltZXNlcmllc1NlcnZpY2U7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0Fib3V0UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywqLyAnJHJvdXRlUGFyYW1zJywgJ3NpZGViYXJEaXNwbGF5JywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsKi8gJHJvdXRlUGFyYW1zLCBzaWRlYmFyRGlzcGxheSwgY29udHJpYnV0b3JzKXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICB2YXIgY29udHJpYnV0b3JQcm9taXNlID0gY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyhcImFsbFwiKTtcbiAgICAgICAgY29udHJpYnV0b3JQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY29udHJpYnV0b3JzID0gY29udHJpYnV0b3JzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdJbnRyb2R1Y3Rpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ0NpdmljIEVuZ2FnZW1lbnQnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gJ1Rlc3RpbmcnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvY2l2aWMtZW5nYWdlbWVudCc7XG4gICAgICAgIH0pO1xuXG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0NhbGxUb0FjdGlvblBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsICdzaWRlYmFyRGlzcGxheScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCBzaWRlYmFyRGlzcGxheSl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgICAgICBzaWRlYmFyRGlzcGxheS5zZWN0aW9uID0gJ0NhbGwgVG8gQWN0aW9uJztcbiAgICAgICAgfSk7XG5cbn1dKVxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdDb2hlc2lvblBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsICdzaWRlYmFyRGlzcGxheScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCBzaWRlYmFyRGlzcGxheSl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgICAgICBzaWRlYmFyRGlzcGxheS5zZWN0aW9uID0gJ1NvY2lhbCBOZXR3b3JrcyBhbmQgQ29tbXVuaXR5IENvaGVzaW9uJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdJbnN0aXR1dGlvbmFsIFByZXNlbmNlJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgaW5zdGl0dXRpb25zXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9pbnN0aXR1dGlvbmFsLXByZXNlbmNlJztcbiAgICAgICAgfSk7XG5cbn1dKVxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdFbmdhZ2VtZW50UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywgJyRyb3V0ZVBhcmFtcycsKi8gJ3NpZGViYXJEaXNwbGF5JyxcbiAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sLyogJGFuY2hvclNjcm9sbCwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCovIHNpZGViYXJEaXNwbGF5KXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnQ2l2aWMgRW5nYWdlbWVudCc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnUG9saXRpY2FsIFBhcnRpY2lwYXRpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gXCJTdHVmZiBhYm91dCBwb2xpdGljYWwgcGFydGljaXBhdGlvblwiO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvcG9saXRpY2FsLXBhcnRpY2lwYXRpb24nO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1BhcnRpY2lwYXRpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdQb2xpdGljYWwgUGFydGljaXBhdGlvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnQ29tbXVuaXR5IENvaGVzaW9uJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgY29oZXNpb25cIjtcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL2NvbW11bml0eS1jb2hlc2lvbic7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUGFydG5lcnNQYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCovICckcm91dGVQYXJhbXMnLCAnc2lkZWJhckRpc3BsYXknLCAnY29udHJpYnV0b3JzJyxcbiAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sLyogJGFuY2hvclNjcm9sbCwgJHJvb3RTY29wZSwqLyAkcm91dGVQYXJhbXMsIHNpZGViYXJEaXNwbGF5LCBjb250cmlidXRvcnMpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKFwiYWxsXCIpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnUGFydG5lcnMnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ1JhdyBEYXRhJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgcmF3IGRhdGFcIjtcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL3Jhdy1kYXRhJztcbiAgICAgICAgfSk7XG5cbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignSW5zdGl0dXRpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdJbnN0aXR1dGlvbmFsIFByZXNlbmNlJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdDYWxsIHRvIEFjdGlvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25UZWFzZXIgPSBcIlN0dWZmIGFib3V0IGNhbGwgdG8gYWN0aW9uXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9jYWxsLXRvLWFjdGlvbic7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY2F0ZWdvcmllcycsIFsnJGh0dHAnLCAnJHEnLCAnbG9kYXNoJywgZnVuY3Rpb24oJGh0dHAsICRxLCBsb2Rhc2gpIHtcbiAgICB2YXIgY2F0ZWdvcmllcyA9IHt9O1xuICAgIGNhdGVnb3JpZXMubGlzdCA9IFtdO1xuXG4gICAgY2F0ZWdvcmllcy50b2dnbGUgPSBmdW5jdGlvbihjYXRlZ29yeSkge1xuICAgICAgICBwb3NpdGlvbiA9IGxvZGFzaC5maW5kSW5kZXgoY2F0ZWdvcmllcy5saXN0LCBmdW5jdGlvbihsaXN0Y2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdGNhdC5uYW1lID09IGNhdGVnb3J5Lm5hbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkID0gIWNhdGVnb3JpZXMubGlzdFtwb3NpdGlvbl0uc2VsZWN0ZWQ7XG4gICAgfTtcblxuICAgIGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY2F0ZWdvcmllcy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjYXRlZ29yaWVzKX0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGdldCBkYXRhIGZyZXNoIGZyb20gZmlsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL3N0YXRpYy9kaXN0L2RhdGEvZGF0YS5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBsb2Rhc2gubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvcnQgY2F0ZWdvcmllcyBieSByYW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9kYXNoLnNvcnRCeShyZXNwb25zZSwgXCJyYW5rXCIpLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggaW5kaWNhdG9yIGluIGVhY2ggY2F0ZWdvcnksIHNvcnQgJ2xldmVscycgYnkgYSByYW5rIGFzIHdlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IsIGlpLCBpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGFbaWldLmRhdGEgPSBsb2Rhc2guc29ydEJ5QWxsKG8uZGF0YVtpaV0uZGF0YSwgXCJyYW5rXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXh0ZW5kIGVhY2ggY2F0ZWdvcnkgdG8gaGF2ZSBhIFwic2VsZWN0ZWRcIiB2YWx1ZSwgZGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGxvZGFzaC5leHRlbmQoe30sIG8sIHtcInNlbGVjdGVkXCIgOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGNhdGVnb3JpZXMubGlzdCB0byBhIHNvcnRlZCBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5saXN0ID0gbGlzdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjYXRlZ29yaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgY2F0ZWdvcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY2F0ZWdvcmllcztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY29udHJpYnV0b3JzJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICAgIHZhciBjb250cmlidXRvcnMgPSB7fTtcbiAgICBjb250cmlidXRvcnMubGlzdCA9IFtdO1xuXG4gICAgY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY29udHJpYnV0b3JzLmxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBvYmplY3QgYWxyZWFkeSBoYXMgZGF0YSwganVzdCB1c2Ugd2hhdCdzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKGNvbnRyaWJ1dG9ycyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2NvbnRyaWJ1dG9ycy5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5saXN0ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRyaWJ1dG9ycyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNvbnRyaWJ1dG9yc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY29udHJpYnV0b3JzO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdTaWRlYmFyQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGxvZycsJ2xvZGFzaCcsICdjYXRlZ29yaWVzJywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBsb2Rhc2gsIGNhdGVnb3JpZXMsIGNvbnRyaWJ1dG9ycykge1xuICAgICAgICAvLyAkc2NvcGUuc3RhdHVzID0ge1xuICAgICAgICAvLyAgICAgaXNvcGVuOiBmYWxzZVxuICAgICAgICAvLyB9O1xuXG4gICAgICAgIHZhciBjYXRlZ29yeVByb21pc2UgPSBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMoKTtcbiAgICAgICAgY2F0ZWdvcnlQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgdGhlIHByZXNlbnRhdGlvbiBvZiB0aGUgc2VsZWN0ZWQgaXRlbXMgaW5cbiAgICAgICAgLy8gdGhlIHNpZGViYXIgYW5kIHByb3BpZ2F0aW5nIHNlbGVjdGlvbnMgdGhyb3VnaCB0aGUgY2F0Z29yaWVzIHNlcnZpY2VcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXMudG9nZ2xlKGNhdGVnb3J5KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hlY2tTZWxlY3RlZCA9IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICAgICAgICAgIGlmIChib29sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzZWxlY3RlZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG9nZ2xlZCB0cmlnZ2VyZWQgZnJvbSBzaWRlYmFyXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdzaWRlYmFyRGlzcGxheScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvZ2dsZTogeyBvcGVuOiB0cnVlIH0sXG4gICAgICAgIHNlY3Rpb246ICdJbnRyb2R1Y3Rpb24nXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdXcmFwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3NpZGViYXJEaXNwbGF5JywgZnVuY3Rpb24gKCRzY29wZSwgc2lkZWJhckRpc3BsYXkpIHtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcbiAgICAgICAgJHNjb3BlLnNlY3Rpb24gPSBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvZ2dsZWQgdHJpZ2dlcmVkIGZyb20gd3JhcFwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50b2dnbGUpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VjdGlvbiA9IHNpZGViYXJEaXNwbGF5LnNlY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1dKVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
