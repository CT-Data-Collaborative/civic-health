var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).when("/about",{templateUrl:"static/dist/templates/about.html",controller:"AboutPageController"}).otherwise({redirectTo:"/data"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"&ddagger;":"-666,666.0"===t||"-666666"===t?"&dagger;":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("anySuppressed",["lodash",function(t){return function(e,n){return e=t.flattenDeep(t.pluck(e,"data")),"undefined"!=typeof n?t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,n)}):t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,"-666666")||-1!==t.indexOf(e,"-9999")})}}]).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return t.trustAsHtml}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","sidebarDisplay","contributors",function(t,e,n,o,r,a){t.toggle=r.toggle,console.log(t.toggle);var i=a.getContributors("all");i.then(function(e){t.contributors=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1})}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories","lodash",function(t,e,n,o,r,a,i,l){t.charts={},t.toggle=a.toggle,t.aboutCollapsed=!1,t.checkChart=function(e){return e=r("sluggify")(e),e in t.charts?t.charts[e]:(t.charts[e]=!1,!1)},t.toggleChart=function(e){e=r("sluggify")(e),e in t.charts?t.charts[e]=!t.charts[e]:(alert('Somehow, "'+e+'" was not in scope.charts!'),t.charts[e]=!1)};var c=i.getCategories("all");c.then(function(e){t.categories=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0})}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,o){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").directive("timeseries",["$window",function(t){var e=timeSeries();return{restrict:"E",scope:{data:"=data"},link:function(n,o,r){n.render=function(){data={data:n.data,config:{width:.6*o.parent().parent().parent()[0].getBoundingClientRect().width}},d3.select(o[0]).datum(data).call(e)},n.$watchCollection("data",function(t){n.render()}),t.onresize=function(){n.render()}}}}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var o={};return o.list=[],o.toggle=function(t){position=n.findIndex(o.list,function(e){return e.name==t.name}),o.list[position].selected=!o.list[position].selected},o.getCategories=function(){return e(o.list.length>0?function(t){t(o)}:function(e,r){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,o,r){t.data[o].data=n.sortByAll(t.data[o].data,"rank")}),t=n.extend({},t,{selected:!0})}),o.list=list,e(o)}).error(function(){r("There was an error getting categories")})})},o}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,o){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){o("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,o,r){var a=o.getCategories();a.then(function(e){t.categories=o.list},function(t){alert("promise rejected!")});var i=r.getContributors();i.then(function(e){t.contributors=r.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){o.toggle(t)},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0}}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from wrap"),console.log(t.toggle)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJhYm91dHBhZ2UvYWJvdXRwYWdlLmNvbnRyb2xsZXIuanMiLCJkYXRhdml6L2RhdGF2aXouY29udHJvbGxlci5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLmRpcmVjdGl2ZS5qcyIsInNpZGViYXIvY2F0ZWdvcmllcy5zZXJ2aWNlLmpzIiwic2lkZWJhci9jb250cmlidXRvcnMuc2VydmljZS5qcyIsInNpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwic2lkZWJhci9zaWRlYmFyZGlzcGxheS5zZXJ2aWNlLmpzIiwic2lkZWJhci93cmFwLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZpbHRlciIsImlucHV0Iiwic3RyIiwicGFyc2VJbnQiLCJsb2Rhc2giLCJhcnIiLCJzdXBwcmVzc2lvbiIsImZsYXR0ZW5EZWVwIiwicGx1Y2siLCJzb21lIiwibyIsInZhbHVlcyIsImluZGV4T2YiLCJwcm9wIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiJHNjZSIsInRydXN0QXNIdG1sIiwiJHNjb3BlIiwiJGh0dHAiLCIkbG9nIiwiJGxvY2F0aW9uIiwic2lkZWJhckRpc3BsYXkiLCJjb250cmlidXRvcnMiLCJ0b2dnbGUiLCJjb25zb2xlIiwibG9nIiwiY29udHJpYnV0b3JQcm9taXNlIiwiZ2V0Q29udHJpYnV0b3JzIiwidGhlbiIsInJlc3VsdCIsImxpc3QiLCJyZWplY3Rpb24iLCJhbGVydCIsIiRvbiIsImV2ZW50Iiwib3BlbiIsIiRmaWx0ZXIiLCJjYXRlZ29yaWVzIiwiY2hhcnRzIiwiYWJvdXRDb2xsYXBzZWQiLCJjaGVja0NoYXJ0Iiwic2x1ZyIsInRvZ2dsZUNoYXJ0IiwicHJvbWlzZSIsImdldENhdGVnb3JpZXMiLCJkaXJlY3RpdmUiLCJjaGFydCIsInRhYmxlQ2hhcnQiLCJyZXN0cmljdCIsInNjb3BlIiwiZGF0YSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCIkd2F0Y2hDb2xsZWN0aW9uIiwiZDMiLCJzZWxlY3QiLCJkYXR1bSIsImNhbGwiLCIkd2luZG93IiwidGltZVNlcmllcyIsInJlbmRlciIsIndpZHRoIiwicGFyZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwib25yZXNpemUiLCJzZXJ2aWNlIiwiJHEiLCJjYXRlZ29yeSIsInBvc2l0aW9uIiwiZmluZEluZGV4IiwibGlzdGNhdCIsIm5hbWUiLCJzZWxlY3RlZCIsImxlbmd0aCIsInJlc29sdmUiLCJyZWplY3QiLCJnZXQiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJtYXAiLCJzb3J0QnkiLCJmb3JFYWNoIiwiaW5kaWNhdG9yIiwiaWkiLCJpYSIsInNvcnRCeUFsbCIsImV4dGVuZCIsImVycm9yIiwiY2F0ZWdvcnlQcm9taXNlIiwidXBkYXRlU2VsZWN0ZWQiLCJjaGVja1NlbGVjdGVkIiwiYm9vbCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxPQUNBLFlBQ0EsZUFDQSxXQUNBLFdDSkFELFNBQUFDLE9BQUEsT0FDQUMsUUFBQSxpQkFBQSxvQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxLQUFBLFNBQ0FDLFlBQUEsa0NBQ0FDLFdBQUEsc0JBRUFGLEtBQUEsVUFDQUMsWUFBQSxtQ0FDQUMsV0FBQSx3QkFFQUMsV0FDQUMsV0FBQSxhQ1pBVCxRQUFBQyxPQUFBLE9BQ0FTLE9BQUEsZUFBQSxXQUNBLE1BQUEsVUFBQUMsR0FDQSxNQUFBLGFBQUFBLEdBQUEsVUFBQUEsRUFDQSxZQUNBLGVBQUFBLEdBQUEsWUFBQUEsRUFDQSxXQUVBQSxLQUlBRCxPQUFBLFVBQUEsV0FDQSxNQUFB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LFdBQ0EsT0FDQTNDLFFBQUFZLE1BQUEsTUNIQTlDLFFBQUFDLE9BQUEsT0FDQU0sV0FBQSxrQkFBQSxTQUFBLGlCQUFBLFNBQUFxQixFQUFBSSxHQUNBSixFQUFBTSxPQUFBRixFQUFBRSxPQUVBTixFQUFBcUMsaUJBQUEsV0FDQSxNQUFBckMsR0FBQU0sUUFDQSxXQUNBQyxRQUFBQyxJQUFBLCtCQUNBRCxRQUFBQyxJQUFBUixFQUFBTSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAnbmdBbmltYXRlJyxcbiAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAnbmdMb2Rhc2gnLFxuICAgICduZ1JvdXRlJ1xuICAgIF0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC53aGVuKCcvZGF0YScsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2RhdGEuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRGF0YVZpekNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvYWJvdXQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9hYm91dC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBYm91dFBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvZGF0YSdcbiAgICAgICAgfSk7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmZpbHRlcignc3VwcHJlc3Npb25zJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgIGlmIChpbnB1dCA9PT0gXCItOSw5OTkuMFwiIHx8IGlucHV0ID09PSBcIi05OTk5XCIpIHtcbiAgICAgICAgcmV0dXJuICcmZGRhZ2dlcjsnO1xuICAgIH0gZWxzZSBpZiAoaW5wdXQgPT09IFwiLTY2Niw2NjYuMFwiIHx8IGlucHV0ID09PSBcIi02NjY2NjZcIikge1xuICAgICAgICByZXR1cm4gJyZkYWdnZXI7JztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuICB9O1xufSlcbi5maWx0ZXIoJ3BlcmNlbnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgIGlmIChwYXJzZUludChzdHIpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ciArIFwiJVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgfVxuICAgIH1cbn0pXG4uZmlsdGVyKCdhbnlTdXBwcmVzc2VkJywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBzdXBwcmVzc2lvbikge1xuICAgICAgICBhcnIgPSBsb2Rhc2guZmxhdHRlbkRlZXAobG9kYXNoLnBsdWNrKGFyciwgXCJkYXRhXCIpKTtcblxuICAgICAgICBpZiAodHlwZW9mIHN1cHByZXNzaW9uICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImNoZWNraW5nIHN1cHByZXNzaW9uOiBcIitzdXBwcmVzc2lvbik7XG4gICAgICAgICAgICByZXR1cm4gbG9kYXNoLnNvbWUoYXJyLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgbyA9IGxvZGFzaC52YWx1ZXMobyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5pbmRleE9mKG8sIHN1cHByZXNzaW9uKSAhPT0gLTE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGFzc3VtZSB0byBjaGVjayBlaXRoZXIgc3VwcHJlc3Npb25cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2hlY2tpbmcgYm90aCBzdXBwcmVzc2lvbiB0eXBlc1wiKTtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgICAgICAgICBvID0gbG9kYXNoLnZhbHVlcyhvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmluZGV4T2YobywgJy02NjY2NjYnKSAhPT0gLTEgfHwgbG9kYXNoLmluZGV4T2YobywgJy05OTk5JykgIT09IC0xO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ2FueScsIFsnbG9kYXNoJywgZnVuY3Rpb24obG9kYXNoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFyciwgcHJvcCkge1xuICAgICAgICBpZiAodHlwZW9mIHByb3AgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIHByb3ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdub25lJywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuICFsb2Rhc2guc29tZShhcnIsIHByb3ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFycilcbiAgICAgICAgfVxuICAgIH1cbn1dKVxuLmZpbHRlcignc2x1Z2dpZnknLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXpBLVowLTlfXS9nLCBcIl9cIilcbiAgICB9O1xufSlcbi5maWx0ZXIoJ3NhZmUnLCBbJyRzY2UnLCBmdW5jdGlvbigkc2NlKSB7XG4gICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWw7XG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQWJvdXRQYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCAnJHJvdXRlUGFyYW1zJywgKi8nc2lkZWJhckRpc3BsYXknLCAnY29udHJpYnV0b3JzJyxcbiAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sLyogJGFuY2hvclNjcm9sbCwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCAqL3NpZGViYXJEaXNwbGF5LCBjb250cmlidXRvcnMpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUudG9nZ2xlKTtcblxuICAgICAgICAvLyAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKG5ld1JvdXRlLCBvbGRSb3V0ZSkge1xuICAgICAgICAvLyAgICAgJGxvY2F0aW9uLmhhc2goJHJvdXRlUGFyYW1zLnNjcm9sbFRvKTtcbiAgICAgICAgLy8gICAgICRhbmNob3JTY3JvbGwoKTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yUHJvbWlzZSA9IGNvbnRyaWJ1dG9ycy5nZXRDb250cmlidXRvcnMoXCJhbGxcIik7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBJIG1hZGUgY2hhbmdlcyB0byB0aGUgc2lkZWJhciBkaXNwbGF5IHNlcnZpY2UsIHJlbmFtaW5nIHRoZSBpbnRlcm5hbFxuICAgICAgICAgICAgLy8gc2V0dGluZyB0byBiZSBcIm9wZW5cIiwgd2hpY2ggbWFrZXMgaXQgZWFzaWVyIHRvIGludGVycHJldCB0aGlzLiBJIG1hZGVcbiAgICAgICAgICAgIC8vIGNvcnJlc3BvbmRpbmcgY2hhbmdlcyBpbiB0aGUgYWJvdXQgYW5kIGRhdGEgdGVtcGxhdGVzLlxuICAgICAgICAgICAgLy8gVGhpcyBsaXN0ZW5lciBlbnN1cmVzIHRoYXQgdGhlIHNpZGViYXIgZG9lc24ndCBnZXQgY2xvc2VkLCB3aGljaCBzb21laG93XG4gICAgICAgICAgICAvLyByZXNvbHZlcyB0aGUgaXNzdWUgb2YgcmVuZGVyaW5nIHRoZSB0ZW1wbGF0ZSB1bmRlcm5lYXQgdGhlIHNsaWRlb3V0IG1lbnVcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IGZhbHNlO1xuICAgICAgICB9KTtcblxufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdEYXRhVml6Q29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnJGZpbHRlcicsLyogJyRhbmNob3JTY3JvbGwnLCAnJHJvb3RTY29wZScsICckcm91dGVQYXJhbXMnLCAqLydzaWRlYmFyRGlzcGxheScsICdjYXRlZ29yaWVzJywgJ2xvZGFzaCcsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCAkZmlsdGVyLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgKi9zaWRlYmFyRGlzcGxheSwgY2F0ZWdvcmllcywgbG9kYXNoKXtcbiAgICAgICAgdmFyIGxvID0gbG9kYXNoO1xuICAgICAgICAkc2NvcGUuY2hhcnRzID0ge307XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLmFib3V0Q29sbGFwc2VkID0gZmFsc2U7XG5cbiAgICAgICAgJHNjb3BlLmNoZWNrQ2hhcnQgPSBmdW5jdGlvbihzbHVnKSB7XG4gICAgICAgICAgICBzbHVnID0gJGZpbHRlcignc2x1Z2dpZnknKShzbHVnKTtcblxuICAgICAgICAgICAgaWYgKCEoc2x1ZyBpbiAkc2NvcGUuY2hhcnRzKSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS50b2dnbGVDaGFydCA9IGZ1bmN0aW9uKHNsdWcpIHtcbiAgICAgICAgICAgIHNsdWcgPSAkZmlsdGVyKCdzbHVnZ2lmeScpKHNsdWcpO1xuXG4gICAgICAgICAgICBpZiAoIShzbHVnIGluICRzY29wZS5jaGFydHMpKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJTb21laG93LCBcXFwiXCIrc2x1ZytcIlxcXCIgd2FzIG5vdCBpbiBzY29wZS5jaGFydHMhXCIpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0c1tzbHVnXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuICRzY29wZS5jaGFydHNbc2x1Z107XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0c1tzbHVnXSA9ICEkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihuZXdSb3V0ZSwgb2xkUm91dGUpIHtcbiAgICAgICAgLy8gICAgICRsb2NhdGlvbi5oYXNoKCRyb3V0ZVBhcmFtcy5zY3JvbGxUbyk7XG4gICAgICAgIC8vICAgICAkYW5jaG9yU2Nyb2xsKCk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIHZhciBwcm9taXNlID0gY2F0ZWdvcmllcy5nZXRDYXRlZ29yaWVzKFwiYWxsXCIpO1xuICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgfSk7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnc2ltcGxldGFibGUnLCBmdW5jdGlvbigpIHtcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHNob3VsZCByZWZsZWN0IHdoYXRldmVyIHlvdXIgZDMgdGFibGUgZnVuY3Rpb24gaXMgY2FsbGVkLlxuICAgIHZhciBjaGFydCA9IHRhYmxlQ2hhcnQoKTtcbiAgICByZXR1cm4gIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGRhdGE6IFwiPWRhdGFcIiAvLyBXZSBjYW4gY2FsbCB0aGlzIHcvZSB3ZSB3YW50LlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJ2RhdGEnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGVsZW1lbnRbMF0pLmRhdHVtKGRhdGEpLmNhbGwoY2hhcnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCd0aW1lc2VyaWVzJywgWyckd2luZG93JywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgIC8vIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHJlZmxlY3Qgd2hhdGV2ZXIgeW91ciBkMyBmdW5jdGlvbiBpcyBjYWxsZWQuXG4gICAgdmFyIGNoYXJ0ID0gdGltZVNlcmllcygpO1xuICAgIHJldHVybiAge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgZGF0YTogXCI9ZGF0YVwiIC8vIFdlIGNhbiBjYWxsIHRoaXMgdy9lIHdlIHdhbnQuXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA6IHNjb3BlLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIiA6IGVsZW1lbnQucGFyZW50KCkucGFyZW50KCkucGFyZW50KClbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggKiAwLjZcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJ2RhdGEnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgZGF0YSA6IGRhdGEsXG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbmZpZyA6IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwid2lkdGhcIiA6IGVsZW1lbnQucGFyZW50KClbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGhcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdChlbGVtZW50WzBdKS5kYXR1bShkYXRhKS5jYWxsKGNoYXJ0KTtcbiAgICAgICAgICAgICAgICBzY29wZS5yZW5kZXIoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICBUaGlzIGNvZGUgaXMgaW50ZW5kZWQgdG8gZ2V0IHRoZSBjaGFydCB0byByZWRyYXcgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWRcbiAgICAgICAgICAgICAgICBCdXQgYXMgaXQgc3RhbmRzLCBzb21laG93IHRoaXMgb3ZlcnJpZGVzIHRoZSBkYXRhIGFuZCB0aGUgY2hhcnQgYmVjb21lcyB1c2VsZXNzLlxuICAgICAgICAgICAgICAgIEkgZG9uJ3QgdGhpbmsgdGhpcyBmZWF0dXJlIGlzIHdvcnRoIHRoZSBkZWJ1ZyB0aW1lIG5vdywgYnV0IGl0J3Mgd29ydGgga2VlcGluZyBpbiBtaW5kIGZvciB0aGUgZnV0dXJlLlxuICAgICAgICAgICAgKiovXG4gICAgICAgICAgICAkd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUucmVuZGVyKClcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJ2RhdGEnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAvLyAgICAgc2NvcGUucmVuZGVyKGRhdGEpO1xuICAgICAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgfVxuICAgIH1cbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY2F0ZWdvcmllcycsIFsnJGh0dHAnLCAnJHEnLCAnbG9kYXNoJywgZnVuY3Rpb24oJGh0dHAsICRxLCBsb2Rhc2gpIHtcbiAgICB2YXIgY2F0ZWdvcmllcyA9IHt9O1xuICAgIGNhdGVnb3JpZXMubGlzdCA9IFtdO1xuXG4gICAgY2F0ZWdvcmllcy50b2dnbGUgPSBmdW5jdGlvbihjYXRlZ29yeSkge1xuICAgICAgICBwb3NpdGlvbiA9IGxvZGFzaC5maW5kSW5kZXgoY2F0ZWdvcmllcy5saXN0LCBmdW5jdGlvbihsaXN0Y2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdGNhdC5uYW1lID09IGNhdGVnb3J5Lm5hbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkID0gIWNhdGVnb3JpZXMubGlzdFtwb3NpdGlvbl0uc2VsZWN0ZWQ7XG4gICAgfTtcblxuICAgIGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY2F0ZWdvcmllcy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjYXRlZ29yaWVzKX0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGdldCBkYXRhIGZyZXNoIGZyb20gZmlsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL3N0YXRpYy9kaXN0L2RhdGEvZGF0YS5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBsb2Rhc2gubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvcnQgY2F0ZWdvcmllcyBieSByYW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9kYXNoLnNvcnRCeShyZXNwb25zZSwgXCJyYW5rXCIpLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggaW5kaWNhdG9yIGluIGVhY2ggY2F0ZWdvcnksIHNvcnQgJ2xldmVscycgYnkgYSByYW5rIGFzIHdlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IsIGlpLCBpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGFbaWldLmRhdGEgPSBsb2Rhc2guc29ydEJ5QWxsKG8uZGF0YVtpaV0uZGF0YSwgXCJyYW5rXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXh0ZW5kIGVhY2ggY2F0ZWdvcnkgdG8gaGF2ZSBhIFwic2VsZWN0ZWRcIiB2YWx1ZSwgZGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGxvZGFzaC5leHRlbmQoe30sIG8sIHtcInNlbGVjdGVkXCIgOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGNhdGVnb3JpZXMubGlzdCB0byBhIHNvcnRlZCBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5saXN0ID0gbGlzdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjYXRlZ29yaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgY2F0ZWdvcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY2F0ZWdvcmllcztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY29udHJpYnV0b3JzJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICAgIHZhciBjb250cmlidXRvcnMgPSB7fTtcbiAgICBjb250cmlidXRvcnMubGlzdCA9IFtdO1xuXG4gICAgY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY29udHJpYnV0b3JzLmxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBvYmplY3QgYWxyZWFkeSBoYXMgZGF0YSwganVzdCB1c2Ugd2hhdCdzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKGNvbnRyaWJ1dG9ycyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2NvbnRyaWJ1dG9ycy5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5saXN0ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRyaWJ1dG9ycyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNvbnRyaWJ1dG9yc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY29udHJpYnV0b3JzO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdTaWRlYmFyQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGxvZycsJ2xvZGFzaCcsICdjYXRlZ29yaWVzJywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBsb2Rhc2gsIGNhdGVnb3JpZXMsIGNvbnRyaWJ1dG9ycykge1xuICAgICAgICAvLyAkc2NvcGUuc3RhdHVzID0ge1xuICAgICAgICAvLyAgICAgaXNvcGVuOiBmYWxzZVxuICAgICAgICAvLyB9O1xuXG4gICAgICAgIHZhciBjYXRlZ29yeVByb21pc2UgPSBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMoKTtcbiAgICAgICAgY2F0ZWdvcnlQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgdGhlIHByZXNlbnRhdGlvbiBvZiB0aGUgc2VsZWN0ZWQgaXRlbXMgaW5cbiAgICAgICAgLy8gdGhlIHNpZGViYXIgYW5kIHByb3BpZ2F0aW5nIHNlbGVjdGlvbnMgdGhyb3VnaCB0aGUgY2F0Z29yaWVzIHNlcnZpY2VcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXMudG9nZ2xlKGNhdGVnb3J5KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hlY2tTZWxlY3RlZCA9IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICAgICAgICAgIGlmIChib29sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzZWxlY3RlZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG9nZ2xlZCB0cmlnZ2VyZWQgZnJvbSBzaWRlYmFyXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdzaWRlYmFyRGlzcGxheScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvZ2dsZTogeyBvcGVuOiB0cnVlIH1cbiAgICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignV3JhcENvbnRyb2xsZXInLCBbJyRzY29wZScsICdzaWRlYmFyRGlzcGxheScsIGZ1bmN0aW9uKCRzY29wZSwgc2lkZWJhckRpc3BsYXkpIHtcbiAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnRvZ2dsZTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvZ2dsZWQgdHJpZ2dlcmVkIGZyb20gd3JhcFwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50b2dnbGUpO1xuICAgICAgICB9KTtcbn1dKVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
