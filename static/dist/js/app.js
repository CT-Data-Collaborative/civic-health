var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/introduction",{templateUrl:"static/dist/templates/introduction.html",controller:"AboutPageController"}).when("/civic-engagement",{templateUrl:"static/dist/templates/civic-engagement.html",controller:"EngagementPageController"}).when("/political-participation",{templateUrl:"static/dist/templates/political-participation.html",controller:"ParticipationPageController"}).when("/community-cohesion",{templateUrl:"static/dist/templates/community-cohesion.html",controller:"CohesionPageController"}).when("/institutional-presence",{templateUrl:"static/dist/templates/institutional-presence.html",controller:"InstitutionPageController"}).when("/call-to-action",{templateUrl:"static/dist/templates/call-to-action.html",controller:"CallToActionPageController"}).when("/partners",{templateUrl:"static/dist/templates/partners.html",controller:"PartnersPageController"}).when("/raw-data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).otherwise({redirectTo:"/introduction"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"&ddagger;":"-666,666.0"===t||"-666666"===t?"&dagger;":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("anySuppressed",["lodash",function(t){return function(e,n){return e=t.flattenDeep(t.pluck(e,"data")),"undefined"!=typeof n?t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,n)}):t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,"-666666")||-1!==t.indexOf(e,"-9999")})}}]).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return t.trustAsHtml}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories","lodash",function(t,e,n,o,i,r,a,l){t.charts={},t.toggle=r.toggle,t.aboutCollapsed=!1,t.checkChart=function(e){return e=i("sluggify")(e),e in t.charts?t.charts[e]:(t.charts[e]=!1,!1)},t.toggleChart=function(e){e=i("sluggify")(e),e in t.charts?t.charts[e]=!t.charts[e]:(alert('Somehow, "'+e+'" was not in scope.charts!'),t.charts[e]=!1)};var c=a.getCategories("all");c.then(function(e){t.categories=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Raw Data"})}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,o){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").directive("timeseries",["$window",function(t){var e=timeSeries();return{restrict:"E",scope:{data:"=data"},link:function(n,o,i){n.render=function(){data={data:n.data,config:{width:.6*o.parent().parent().parent()[0].getBoundingClientRect().width}},d3.select(o[0]).datum(data).call(e)},n.$watchCollection("data",function(t){n.render()}),t.onresize=function(){n.render()}}}}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,o,i,r,a){t.toggle=r.toggle;var l=a.getContributors("all");l.then(function(e){t.contributors=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Introduction",t.nextSection="Civic Engagement",t.nextSectionTeaser="Testing",t.nextSectionURL="#/civic-engagement"})}]),angular.module("app").controller("CallToActionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,o,i){t.toggle=i.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,i.section="Call To Action"})}]),angular.module("app").controller("CohesionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,o,i){t.toggle=i.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,i.section="Social Networks and Community Cohesion",t.nextSection="Institutional Presence",t.nextSectionTeaser="Stuff about institutions",t.nextSectionURL="#/institutional-presence"})}]),angular.module("app").controller("EngagementPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,o,i){t.toggle=i.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,i.section="Civic Engagement",t.nextSection="Political Participation",t.nextSectionTeaser="Stuff about political participation",t.nextSectionURL="#/political-participation"})}]),angular.module("app").controller("ParticipationPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,o,i){t.toggle=i.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,i.section="Political Participation",t.nextSection="Community Cohesion",t.nextSectionTeaser="Stuff about cohesion",t.nextSectionURL="#/community-cohesion"})}]),angular.module("app").controller("PartnersPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,o,i,r,a){t.toggle=r.toggle;var l=a.getContributors("all");l.then(function(e){t.contributors=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,r.section="Partners",t.nextSection="Raw Data",t.nextSectionTeaser="Stuff about raw data",t.nextSectionURL="#/raw-data"})}]),angular.module("app").controller("InstitutionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,o,i){t.toggle=i.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,i.section="Institutional Presence",t.nextSection="Call to Action",t.nextSectionTeaser="Stuff about call to action",t.nextSectionURL="#/call-to-action"})}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var o={};return o.list=[],o.toggle=function(t){position=n.findIndex(o.list,function(e){return e.name==t.name}),o.list[position].selected=!o.list[position].selected},o.getCategories=function(){return e(o.list.length>0?function(t){t(o)}:function(e,i){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,o,i){t.data[o].data=n.sortByAll(t.data[o].data,"rank")}),t=n.extend({},t,{selected:!0})}),o.list=list,e(o)}).error(function(){i("There was an error getting categories")})})},o}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,o){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){o("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,o,i){var r=o.getCategories();r.then(function(e){t.categories=o.list},function(t){alert("promise rejected!")});var a=i.getContributors();a.then(function(e){t.contributors=i.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){o.toggle(t)},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0},section:"Introduction"}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.section=e.section,t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from wrap"),console.log(t.toggle)}),t.$watchCollection(function(){return e.section},function(){t.section=e.section})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJkYXRhdml6L2RhdGF2aXouY29udHJvbGxlci5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLmRpcmVjdGl2ZS5qcyIsInBhZ2VzL2Fib3V0cGFnZS5jb250cm9sbGVyLmpzIiwicGFnZXMvY2FsbHRvYWN0aW9uLmNvbnRyb2xsZXIuanMiLCJwYWdlcy9jb2hlc2lvbi5jb250cm9sbGVyLmpzIiwicGFnZXMvZW5nYWdlbWVudC5jb250cm9sbGVyLmpzIiwicGFnZXMvcGFydGljaXBhdGlvbi5jb250cm9sbGVyLmpzIiwicGFnZXMvcGFydG5lcnMuY29udHJvbGxlcnMuanMiLCJwYWdlcy9wcmVzZW5jZS5jb250cm9sbGVyLmpzIiwic2lkZWJhci9jYXRlZ29yaWVzLnNlcnZpY2UuanMiLCJzaWRlYmFyL2NvbnRyaWJ1dG9ycy5zZXJ2aWNlLmpzIiwic2lkZWJhci9zaWRlYmFyLmNvbnRyb2xsZXIuanMiLCJzaWRlYmFyL3NpZGViYXJkaXNwbGF5LnNlcnZpY2UuanMiLCJzaWRlYmFyL3dyYXAuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmlsdGVyIiwiaW5wdXQiLCJzdHIiLCJwYXJzZUludCIsImxvZGFzaCIsImFyciIsInN1cHByZXNzaW9uIiwiZmxhdHRlbkRlZXAiLCJwbHVjayIsInNvbWUiLCJvIiwidmFsdWVzIiwiaW5kZXhPZiIsInByb3AiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCIkc2NlIiwidHJ1c3RBc0h0bWwiLCIkc2NvcGUiLCIkaHR0cCIsIiRsb2ciLCIkbG9jYXRpb24iLCIkZmlsdGVyIiwic2lkZWJhckRpc3BsYXkiLCJjYXRlZ29yaWVzIiwiY2hhcnRzIiwidG9nZ2xlIiwiYWJvdXRDb2xsYXBzZWQiLCJjaGVja0NoYXJ0Iiwic2x1ZyIsInRvZ2dsZUNoYXJ0IiwiYWxlcnQiLCJwcm9taXNlIiwiZ2V0Q2F0ZWdvcmllcyIsInRoZW4iLCJyZXN1bHQiLCJsaXN0IiwicmVqZWN0aW9uIiwiJG9uIiwiZXZlbnQiLCJvcGVuIiwic2VjdGlvbiIsImRpcmVjdGl2ZSIsImNoYXJ0IiwidGFibGVDaGFydCIsInJlc3RyaWN0Iiwic2NvcGUiLCJkYXRhIiwibGluayIsImVsZW1lbnQiLCJhdHRycyIsIiR3YXRjaENvbGxlY3Rpb24iLCJkMyIsInNlbGVjdCIsImRhdHVtIiwiY2FsbCIsIiR3aW5kb3ciLCJ0aW1lU2VyaWVzIiwicmVuZGVyIiwid2lkdGgiLCJwYXJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvbnJlc2l6ZSIsIiRyb3V0ZVBhcmFtcyIsImNvbnRyaWJ1dG9ycyIsImNvbnRyaWJ1dG9yUHJvbWlzZSIsImdldENvbnRyaWJ1dG9ycyIsIm5leHRTZWN0aW9uIiwibmV4dFNlY3Rpb25UZWFzZXIiLCJuZXh0U2VjdGlvblVSTCIsInNlcnZpY2UiLCIkcSIsImNhdGVnb3J5IiwicG9zaXRpb24iLCJmaW5kSW5kZXgiLCJsaXN0Y2F0IiwibmFtZSIsInNlbGVjdGVkIiwibGVuZ3RoIiwicmVzb2x2ZSIsInJlamVjdCIsImdldCIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsIm1hcCIsInNvcnRCeSIsImZvckVhY2giLCJpbmRpY2F0b3IiLCJpaSIsImlhIiwic29ydEJ5QWxsIiwiZXh0ZW5kIiwiZXJyb3IiLCJjYXRlZ29yeVByb21pc2UiLCJ1cGRhdGVTZWxlY3RlZCIsImNoZWNrU2VsZWN0ZWQiLCJib29sIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxPQUNBLFlBQ0EsZUFDQSxXQUNBLFdDSkFELFNBQUFDLE9B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QUFZLE1BQ0EsU0FBQUMsR0FDQU4sTUFBQSxzQkFHQSxJQUFBa0MsR0FBQUQsRUFBQUUsaUJBQ0FELEdBQUEvQixLQUFBLFNBQUFDLEdBQ0FqQixFQUFBOEMsYUFBQUEsRUFBQTVCLE1BQ0EsU0FBQUMsR0FDQU4sTUFBQSx1QkFLQWIsRUFBQTRFLGVBQUEsU0FBQXRCLEdBQ0FoRCxFQUFBRSxPQUFBOEMsSUFHQXRELEVBQUE2RSxjQUFBLFNBQUFDLEdBQ0EsTUFBQUEsR0FDQSxXQUVBLGNBR0E5RSxFQUFBaUMsaUJBQUEsV0FDQSxNQUFBakMsR0FBQVEsUUFDQSxXQUNBdUUsUUFBQUMsSUFBQSxrQ0FDQUQsUUFBQUMsSUFBQWhGLEVBQUFRLGFDdkNBcEMsUUFBQUMsT0FBQSxPQUNBK0UsUUFBQSxpQkFBQSxXQUNBLE9BQ0E1QyxRQUFBYyxNQUFBLEdBQ0FDLFFBQUEsa0JDSkFuRCxRQUFBQyxPQUFBLE9BQ0FNLFdBQUEsa0JBQUEsU0FBQSxpQkFBQSxTQUFBcUIsRUFBQUssR0FDQUwsRUFBQVEsT0FBQUgsRUFBQUcsT0FDQVIsRUFBQXVCLFFBQUFsQixFQUFBa0IsUUFFQXZCLEVBQUFpQyxpQkFBQSxXQUNBLE1BQUFqQyxHQUFBUSxRQUNBLFdBQ0F1RSxRQUFBQyxJQUFBLCtCQUNBRCxRQUFBQyxJQUFBaEYsRUFBQVEsVUFJQVIsRUFBQWlDLGlCQUFBLFdBQ0EsTUFBQTVCLEdBQUFrQixTQUNBLFdBQ0F2QixFQUFBdUIsUUFBQWxCLEVBQUFrQiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAnbmdBbmltYXRlJyxcbiAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAnbmdMb2Rhc2gnLFxuICAgICduZ1JvdXRlJ1xuICAgIF0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC53aGVuKCcvaW50cm9kdWN0aW9uJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvaW50cm9kdWN0aW9uLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Fib3V0UGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvY2l2aWMtZW5nYWdlbWVudCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2NpdmljLWVuZ2FnZW1lbnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRW5nYWdlbWVudFBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3BvbGl0aWNhbC1wYXJ0aWNpcGF0aW9uJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvcG9saXRpY2FsLXBhcnRpY2lwYXRpb24uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUGFydGljaXBhdGlvblBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NvbW11bml0eS1jb2hlc2lvbicsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2NvbW11bml0eS1jb2hlc2lvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDb2hlc2lvblBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2luc3RpdHV0aW9uYWwtcHJlc2VuY2UnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9pbnN0aXR1dGlvbmFsLXByZXNlbmNlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0luc3RpdHV0aW9uUGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvY2FsbC10by1hY3Rpb24nLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jYWxsLXRvLWFjdGlvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYWxsVG9BY3Rpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wYXJ0bmVycycsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL3BhcnRuZXJzLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BhcnRuZXJzUGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvcmF3LWRhdGEnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9kYXRhLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0RhdGFWaXpDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvaW50cm9kdWN0aW9uJ1xuICAgICAgICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZmlsdGVyKCdzdXBwcmVzc2lvbnMnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgaWYgKGlucHV0ID09PSBcIi05LDk5OS4wXCIgfHwgaW5wdXQgPT09IFwiLTk5OTlcIikge1xuICAgICAgICByZXR1cm4gJyZkZGFnZ2VyOyc7XG4gICAgfSBlbHNlIGlmIChpbnB1dCA9PT0gXCItNjY2LDY2Ni4wXCIgfHwgaW5wdXQgPT09IFwiLTY2NjY2NlwiKSB7XG4gICAgICAgIHJldHVybiAnJmRhZ2dlcjsnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG4gIH07XG59KVxuLmZpbHRlcigncGVyY2VudCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KHN0cikgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyICsgXCIlXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgICB9XG4gICAgfVxufSlcbi5maWx0ZXIoJ2FueVN1cHByZXNzZWQnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHN1cHByZXNzaW9uKSB7XG4gICAgICAgIGFyciA9IGxvZGFzaC5mbGF0dGVuRGVlcChsb2Rhc2gucGx1Y2soYXJyLCBcImRhdGFcIikpO1xuXG4gICAgICAgIGlmICh0eXBlb2Ygc3VwcHJlc3Npb24gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2hlY2tpbmcgc3VwcHJlc3Npb246IFwiK3N1cHByZXNzaW9uKTtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgICAgICAgICBvID0gbG9kYXNoLnZhbHVlcyhvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmluZGV4T2Yobywgc3VwcHJlc3Npb24pICE9PSAtMTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gYXNzdW1lIHRvIGNoZWNrIGVpdGhlciBzdXBwcmVzc2lvblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJjaGVja2luZyBib3RoIHN1cHByZXNzaW9uIHR5cGVzXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgZnVuY3Rpb24obykge1xuICAgICAgICAgICAgICAgIG8gPSBsb2Rhc2gudmFsdWVzKG8pO1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2Rhc2guaW5kZXhPZihvLCAnLTY2NjY2NicpICE9PSAtMSB8fCBsb2Rhc2guaW5kZXhPZihvLCAnLTk5OTknKSAhPT0gLTE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1dKVxuLmZpbHRlcignYW55JywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIpXG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ25vbmUnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHByb3ApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAhbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdzbHVnZ2lmeScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIFwiX1wiKVxuICAgIH07XG59KVxuLmZpbHRlcignc2FmZScsIFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcbiAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbDtcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdEYXRhVml6Q29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnJGZpbHRlcicsLyogJyRhbmNob3JTY3JvbGwnLCAnJHJvb3RTY29wZScsICckcm91dGVQYXJhbXMnLCAqLydzaWRlYmFyRGlzcGxheScsICdjYXRlZ29yaWVzJywgJ2xvZGFzaCcsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCAkZmlsdGVyLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgKi9zaWRlYmFyRGlzcGxheSwgY2F0ZWdvcmllcywgbG9kYXNoKXtcbiAgICAgICAgdmFyIGxvID0gbG9kYXNoO1xuICAgICAgICAkc2NvcGUuY2hhcnRzID0ge307XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLmFib3V0Q29sbGFwc2VkID0gZmFsc2U7XG5cbiAgICAgICAgJHNjb3BlLmNoZWNrQ2hhcnQgPSBmdW5jdGlvbihzbHVnKSB7XG4gICAgICAgICAgICBzbHVnID0gJGZpbHRlcignc2x1Z2dpZnknKShzbHVnKTtcblxuICAgICAgICAgICAgaWYgKCEoc2x1ZyBpbiAkc2NvcGUuY2hhcnRzKSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS50b2dnbGVDaGFydCA9IGZ1bmN0aW9uKHNsdWcpIHtcbiAgICAgICAgICAgIHNsdWcgPSAkZmlsdGVyKCdzbHVnZ2lmeScpKHNsdWcpO1xuXG4gICAgICAgICAgICBpZiAoIShzbHVnIGluICRzY29wZS5jaGFydHMpKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJTb21laG93LCBcXFwiXCIrc2x1ZytcIlxcXCIgd2FzIG5vdCBpbiBzY29wZS5jaGFydHMhXCIpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0c1tzbHVnXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuICRzY29wZS5jaGFydHNbc2x1Z107XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYXJ0c1tzbHVnXSA9ICEkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihuZXdSb3V0ZSwgb2xkUm91dGUpIHtcbiAgICAgICAgLy8gICAgICRsb2NhdGlvbi5oYXNoKCRyb3V0ZVBhcmFtcy5zY3JvbGxUbyk7XG4gICAgICAgIC8vICAgICAkYW5jaG9yU2Nyb2xsKCk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIHZhciBwcm9taXNlID0gY2F0ZWdvcmllcy5nZXRDYXRlZ29yaWVzKFwiYWxsXCIpO1xuICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdSYXcgRGF0YSc7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ3NpbXBsZXRhYmxlJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgcmVmbGVjdCB3aGF0ZXZlciB5b3VyIGQzIHRhYmxlIGZ1bmN0aW9uIGlzIGNhbGxlZC5cbiAgICB2YXIgY2hhcnQgPSB0YWJsZUNoYXJ0KCk7XG4gICAgcmV0dXJuICB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBkYXRhOiBcIj1kYXRhXCIgLy8gV2UgY2FuIGNhbGwgdGhpcyB3L2Ugd2Ugd2FudC5cbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdChlbGVtZW50WzBdKS5kYXR1bShkYXRhKS5jYWxsKGNoYXJ0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgndGltZXNlcmllcycsIFsnJHdpbmRvdycsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHNob3VsZCByZWZsZWN0IHdoYXRldmVyIHlvdXIgZDMgZnVuY3Rpb24gaXMgY2FsbGVkLlxuICAgIHZhciBjaGFydCA9IHRpbWVTZXJpZXMoKTtcbiAgICByZXR1cm4gIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGRhdGE6IFwiPWRhdGFcIiAvLyBXZSBjYW4gY2FsbCB0aGlzIHcvZSB3ZSB3YW50LlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgOiBzY29wZS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGVsZW1lbnRbMF0pLmRhdHVtKGRhdGEpLmNhbGwoY2hhcnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRhdGEgOiBkYXRhLFxuICAgICAgICAgICAgICAgIC8vICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICAgICAgc2NvcGUucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgVGhpcyBjb2RlIGlzIGludGVuZGVkIHRvIGdldCB0aGUgY2hhcnQgdG8gcmVkcmF3IHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgICAgQnV0IGFzIGl0IHN0YW5kcywgc29tZWhvdyB0aGlzIG92ZXJyaWRlcyB0aGUgZGF0YSBhbmQgdGhlIGNoYXJ0IGJlY29tZXMgdXNlbGVzcy5cbiAgICAgICAgICAgICAgICBJIGRvbid0IHRoaW5rIHRoaXMgZmVhdHVyZSBpcyB3b3J0aCB0aGUgZGVidWcgdGltZSBub3csIGJ1dCBpdCdzIHdvcnRoIGtlZXBpbmcgaW4gbWluZCBmb3IgdGhlIGZ1dHVyZS5cbiAgICAgICAgICAgICoqL1xuICAgICAgICAgICAgJHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnJlbmRlcigpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy8gICAgIHNjb3BlLnJlbmRlcihkYXRhKTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgIH1cbiAgICB9XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0Fib3V0UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywqLyAnJHJvdXRlUGFyYW1zJywgJ3NpZGViYXJEaXNwbGF5JywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsKi8gJHJvdXRlUGFyYW1zLCBzaWRlYmFyRGlzcGxheSwgY29udHJpYnV0b3JzKXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICB2YXIgY29udHJpYnV0b3JQcm9taXNlID0gY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyhcImFsbFwiKTtcbiAgICAgICAgY29udHJpYnV0b3JQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY29udHJpYnV0b3JzID0gY29udHJpYnV0b3JzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdJbnRyb2R1Y3Rpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ0NpdmljIEVuZ2FnZW1lbnQnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gJ1Rlc3RpbmcnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvY2l2aWMtZW5nYWdlbWVudCc7XG4gICAgICAgIH0pO1xuXG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0NhbGxUb0FjdGlvblBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsICdzaWRlYmFyRGlzcGxheScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCBzaWRlYmFyRGlzcGxheSl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgICAgICBzaWRlYmFyRGlzcGxheS5zZWN0aW9uID0gJ0NhbGwgVG8gQWN0aW9uJztcbiAgICAgICAgfSk7XG5cbn1dKVxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdDb2hlc2lvblBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsICdzaWRlYmFyRGlzcGxheScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCBzaWRlYmFyRGlzcGxheSl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgICAgICBzaWRlYmFyRGlzcGxheS5zZWN0aW9uID0gJ1NvY2lhbCBOZXR3b3JrcyBhbmQgQ29tbXVuaXR5IENvaGVzaW9uJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdJbnN0aXR1dGlvbmFsIFByZXNlbmNlJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgaW5zdGl0dXRpb25zXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9pbnN0aXR1dGlvbmFsLXByZXNlbmNlJztcbiAgICAgICAgfSk7XG5cbn1dKVxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdFbmdhZ2VtZW50UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywgJyRyb3V0ZVBhcmFtcycsKi8gJ3NpZGViYXJEaXNwbGF5JyxcbiAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sLyogJGFuY2hvclNjcm9sbCwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCovIHNpZGViYXJEaXNwbGF5KXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnQ2l2aWMgRW5nYWdlbWVudCc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnUG9saXRpY2FsIFBhcnRpY2lwYXRpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gXCJTdHVmZiBhYm91dCBwb2xpdGljYWwgcGFydGljaXBhdGlvblwiO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvcG9saXRpY2FsLXBhcnRpY2lwYXRpb24nO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1BhcnRpY2lwYXRpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdQb2xpdGljYWwgUGFydGljaXBhdGlvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnQ29tbXVuaXR5IENvaGVzaW9uJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgY29oZXNpb25cIjtcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL2NvbW11bml0eS1jb2hlc2lvbic7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUGFydG5lcnNQYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCovICckcm91dGVQYXJhbXMnLCAnc2lkZWJhckRpc3BsYXknLCAnY29udHJpYnV0b3JzJyxcbiAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sLyogJGFuY2hvclNjcm9sbCwgJHJvb3RTY29wZSwqLyAkcm91dGVQYXJhbXMsIHNpZGViYXJEaXNwbGF5LCBjb250cmlidXRvcnMpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKFwiYWxsXCIpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnUGFydG5lcnMnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ1JhdyBEYXRhJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9IFwiU3R1ZmYgYWJvdXQgcmF3IGRhdGFcIjtcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL3Jhdy1kYXRhJztcbiAgICAgICAgfSk7XG5cbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignSW5zdGl0dXRpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdJbnN0aXR1dGlvbmFsIFByZXNlbmNlJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdDYWxsIHRvIEFjdGlvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25UZWFzZXIgPSBcIlN0dWZmIGFib3V0IGNhbGwgdG8gYWN0aW9uXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9jYWxsLXRvLWFjdGlvbic7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY2F0ZWdvcmllcycsIFsnJGh0dHAnLCAnJHEnLCAnbG9kYXNoJywgZnVuY3Rpb24oJGh0dHAsICRxLCBsb2Rhc2gpIHtcbiAgICB2YXIgY2F0ZWdvcmllcyA9IHt9O1xuICAgIGNhdGVnb3JpZXMubGlzdCA9IFtdO1xuXG4gICAgY2F0ZWdvcmllcy50b2dnbGUgPSBmdW5jdGlvbihjYXRlZ29yeSkge1xuICAgICAgICBwb3NpdGlvbiA9IGxvZGFzaC5maW5kSW5kZXgoY2F0ZWdvcmllcy5saXN0LCBmdW5jdGlvbihsaXN0Y2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdGNhdC5uYW1lID09IGNhdGVnb3J5Lm5hbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkID0gIWNhdGVnb3JpZXMubGlzdFtwb3NpdGlvbl0uc2VsZWN0ZWQ7XG4gICAgfTtcblxuICAgIGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY2F0ZWdvcmllcy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjYXRlZ29yaWVzKX0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGdldCBkYXRhIGZyZXNoIGZyb20gZmlsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL3N0YXRpYy9kaXN0L2RhdGEvZGF0YS5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBsb2Rhc2gubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvcnQgY2F0ZWdvcmllcyBieSByYW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9kYXNoLnNvcnRCeShyZXNwb25zZSwgXCJyYW5rXCIpLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggaW5kaWNhdG9yIGluIGVhY2ggY2F0ZWdvcnksIHNvcnQgJ2xldmVscycgYnkgYSByYW5rIGFzIHdlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IsIGlpLCBpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGFbaWldLmRhdGEgPSBsb2Rhc2guc29ydEJ5QWxsKG8uZGF0YVtpaV0uZGF0YSwgXCJyYW5rXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXh0ZW5kIGVhY2ggY2F0ZWdvcnkgdG8gaGF2ZSBhIFwic2VsZWN0ZWRcIiB2YWx1ZSwgZGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGxvZGFzaC5leHRlbmQoe30sIG8sIHtcInNlbGVjdGVkXCIgOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGNhdGVnb3JpZXMubGlzdCB0byBhIHNvcnRlZCBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5saXN0ID0gbGlzdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjYXRlZ29yaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgY2F0ZWdvcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY2F0ZWdvcmllcztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY29udHJpYnV0b3JzJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICAgIHZhciBjb250cmlidXRvcnMgPSB7fTtcbiAgICBjb250cmlidXRvcnMubGlzdCA9IFtdO1xuXG4gICAgY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY29udHJpYnV0b3JzLmxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBvYmplY3QgYWxyZWFkeSBoYXMgZGF0YSwganVzdCB1c2Ugd2hhdCdzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKGNvbnRyaWJ1dG9ycyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2NvbnRyaWJ1dG9ycy5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5saXN0ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRyaWJ1dG9ycyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNvbnRyaWJ1dG9yc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY29udHJpYnV0b3JzO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdTaWRlYmFyQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGxvZycsJ2xvZGFzaCcsICdjYXRlZ29yaWVzJywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBsb2Rhc2gsIGNhdGVnb3JpZXMsIGNvbnRyaWJ1dG9ycykge1xuICAgICAgICAvLyAkc2NvcGUuc3RhdHVzID0ge1xuICAgICAgICAvLyAgICAgaXNvcGVuOiBmYWxzZVxuICAgICAgICAvLyB9O1xuXG4gICAgICAgIHZhciBjYXRlZ29yeVByb21pc2UgPSBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMoKTtcbiAgICAgICAgY2F0ZWdvcnlQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgdGhlIHByZXNlbnRhdGlvbiBvZiB0aGUgc2VsZWN0ZWQgaXRlbXMgaW5cbiAgICAgICAgLy8gdGhlIHNpZGViYXIgYW5kIHByb3BpZ2F0aW5nIHNlbGVjdGlvbnMgdGhyb3VnaCB0aGUgY2F0Z29yaWVzIHNlcnZpY2VcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXMudG9nZ2xlKGNhdGVnb3J5KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hlY2tTZWxlY3RlZCA9IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICAgICAgICAgIGlmIChib29sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzZWxlY3RlZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG9nZ2xlZCB0cmlnZ2VyZWQgZnJvbSBzaWRlYmFyXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdzaWRlYmFyRGlzcGxheScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvZ2dsZTogeyBvcGVuOiB0cnVlIH0sXG4gICAgICAgIHNlY3Rpb246ICdJbnRyb2R1Y3Rpb24nXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdXcmFwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3NpZGViYXJEaXNwbGF5JywgZnVuY3Rpb24gKCRzY29wZSwgc2lkZWJhckRpc3BsYXkpIHtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcbiAgICAgICAgJHNjb3BlLnNlY3Rpb24gPSBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvZ2dsZWQgdHJpZ2dlcmVkIGZyb20gd3JhcFwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50b2dnbGUpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VjdGlvbiA9IHNpZGViYXJEaXNwbGF5LnNlY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1dKVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
