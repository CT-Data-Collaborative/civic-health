var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).when("/about",{templateUrl:"static/dist/templates/about.html",controller:"AboutPageController"}).otherwise({redirectTo:"/data"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"NA":"-666,666.0"===t||"-666666"===t?" * ":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("anySuppressed",["lodash",function(t){return function(e,n){return e=t.flattenDeep(t.pluck(e,"data")),"undefined"!=typeof n?t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,n)}):t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,"-666666")||-1!==t.indexOf(e,"-9999")})}}]).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return function(e){return t.trustAsHtml(e.toString())}}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","sidebarDisplay","contributors",function(t,e,n,o,r,a){t.toggle=r.toggle,console.log(t.toggle);var i=a.getContributors("all");i.then(function(e){t.contributors=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1})}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories","lodash",function(t,e,n,o,r,a,i,l){t.charts={},t.toggle=a.toggle,t.aboutCollapsed=!1,t.checkChart=function(e){return e=r("sluggify")(e),e in t.charts?t.charts[e]:(t.charts[e]=!1,!1)},t.toggleChart=function(e){e=r("sluggify")(e),e in t.charts?t.charts[e]=!t.charts[e]:(alert('Somehow, "'+e+'" was not in scope.charts!'),t.charts[e]=!1)};var c=i.getCategories("all");c.then(function(e){t.categories=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0})}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,o){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").directive("timeseries",["$window",function(t){var e=timeSeries();return{restrict:"E",scope:{data:"=data"},link:function(n,o,r){n.render=function(){data={data:n.data,config:{width:.6*o.parent().parent().parent()[0].getBoundingClientRect().width}},d3.select(o[0]).datum(data).call(e)},n.$watchCollection("data",function(t){n.render()}),t.onresize=function(){n.render()}}}}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var o={};return o.list=[],o.toggle=function(t){position=n.findIndex(o.list,function(e){return e.name==t.name}),o.list[position].selected=!o.list[position].selected},o.getCategories=function(){return e(o.list.length>0?function(t){t(o)}:function(e,r){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,o,r){t.data[o].data=n.sortByAll(t.data[o].data,"rank")}),t=n.extend({},t,{selected:!0})}),o.list=list,e(o)}).error(function(){r("There was an error getting categories")})})},o}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,o){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){o("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,o,r){var a=o.getCategories();a.then(function(e){t.categories=o.list},function(t){alert("promise rejected!")});var i=r.getContributors();i.then(function(e){t.contributors=r.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){o.toggle(t)},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0}}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from wrap"),console.log(t.toggle)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJhYm91dHBhZ2UvYWJvdXRwYWdlLmNvbnRyb2xsZXIuanMiLCJkYXRhdml6L2RhdGF2aXouY29udHJvbGxlci5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLmRpcmVjdGl2ZS5qcyIsInNpZGViYXIvY2F0ZWdvcmllcy5zZXJ2aWNlLmpzIiwic2lkZWJhci9jb250cmlidXRvcnMuc2VydmljZS5qcyIsInNpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwic2lkZWJhci9zaWRlYmFyZGlzcGxheS5zZXJ2aWNlLmpzIiwic2lkZWJhci93cmFwLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZpbHRlciIsImlucHV0Iiwic3RyIiwicGFyc2VJbnQiLCJsb2Rhc2giLCJhcnIiLCJzdXBwcmVzc2lvbiIsImZsYXR0ZW5EZWVwIiwicGx1Y2siLCJzb21lIiwibyIsInZhbHVlcyIsImluZGV4T2YiLCJwcm9wIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiJHNjZSIsInZhbCIsInRydXN0QXNIdG1sIiwidG9TdHJpbmciLCIkc2NvcGUiLCIkaHR0cCIsIiRsb2ciLCIkbG9jYXRpb24iLCJzaWRlYmFyRGlzcGxheSIsImNvbnRyaWJ1dG9ycyIsInRvZ2dsZSIsImNvbnNvbGUiLCJsb2ciLCJjb250cmlidXRvclByb21pc2UiLCJnZXRDb250cmlidXRvcnMiLCJ0aGVuIiwicmVzdWx0IiwibGlzdCIsInJlamVjdGlvbiIsImFsZXJ0IiwiJG9uIiwiZXZlbnQiLCJvcGVuIiwiJGZpbHRlciIsImNhdGVnb3JpZXMiLCJjaGFydHMiLCJhYm91dENvbGxhcHNlZCIsImNoZWNrQ2hhcnQiLCJzbHVnIiwidG9nZ2xlQ2hhcnQiLCJwcm9taXNlIiwiZ2V0Q2F0ZWdvcmllcyIsImRpcmVjdGl2ZSIsImNoYXJ0IiwidGFibGVDaGFydCIsInJlc3RyaWN0Iiwic2NvcGUiLCJkYXRhIiwibGluayIsImVsZW1lbnQiLCJhdHRycyIsIiR3YXRjaENvbGxlY3Rpb24iLCJkMyIsInNlbGVjdCIsImRhdHVtIiwiY2FsbCIsIiR3aW5kb3ciLCJ0aW1lU2VyaWVzIiwicmVuZGVyIiwid2lkdGgiLCJwYXJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvbnJlc2l6ZSIsInNlcnZpY2UiLCIkcSIsImNhdGVnb3J5IiwicG9zaXRpb24iLCJmaW5kSW5kZXgiLCJsaXN0Y2F0IiwibmFtZSIsInNlbGVjdGVkIiwibGVuZ3RoIiwicmVzb2x2ZSIsInJlamVjdCIsImdldCIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsIm1hcCIsInNvcnRCeSIsImZvckVhY2giLCJpbmRpY2F0b3IiLCJpaSIsImlhIiwic29ydEJ5QWxsIiwiZXh0ZW5kIiwiZXJyb3IiLCJjYXRlZ29yeVByb21pc2UiLCJ1cGRhdGVTZWxlY3RlZCIsImNoZWNrU2VsZWN0ZWQiLCJib29sIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLE9BQ0EsWUFDQSxlQUNBLFdBQ0EsV0NKQUQsU0FBQUMsT0FBQSxPQUNBQyxRQUFBLGlCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEdBQ0FELEVBQ0FFLEtBQUEsU0FDQUMsWUFBQSxrQ0FDQUMsV0FBQSxzQkFFQUYsS0FBQSxVQUNBQyxZQUFBLG1DQUNBQyxXQUFBLHdCQUVBQyxXQUNBQyxXQUFBLGFDWkFULFFBQUFDLE9BQUEsT0FDQVMsT0FBQSxlQUFBLFdBQ0EsTUFBQSxVQUFBQyxHQUNBLE1BQUEsYUFBQUEsR0FBQSxVQUFBQSxFQUNBLEtBQ0EsZUFBQUEsR0FBQSxZQUFBQSxFQUNBLE1BRUFBLEtBSUFELE9B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QUFBUixFQUFBTSxhQ3ZDQXBDLFFBQUFDLE9BQUEsT0FDQThFLFFBQUEsaUJBQUEsV0FDQSxPQUNBM0MsUUFBQVksTUFBQSxNQ0hBaEQsUUFBQUMsT0FBQSxPQUNBTSxXQUFBLGtCQUFBLFNBQUEsaUJBQUEsU0FBQXVCLEVBQUFJLEdBQ0FKLEVBQUFNLE9BQUFGLEVBQUFFLE9BRUFOLEVBQUFxQyxpQkFBQSxXQUNBLE1BQUFyQyxHQUFBTSxRQUNBLFdBQ0FDLFFBQUFDLElBQUEsK0JBQ0FELFFBQUFDLElBQUFSLEVBQUFNIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICduZ0FuaW1hdGUnLFxuICAgICd1aS5ib290c3RyYXAnLFxuICAgICduZ0xvZGFzaCcsXG4gICAgJ25nUm91dGUnXG4gICAgXSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgLndoZW4oJy9kYXRhJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvZGF0YS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXRhVml6Q29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9hYm91dCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2Fib3V0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Fib3V0UGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgcmVkaXJlY3RUbzogJy9kYXRhJ1xuICAgICAgICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZmlsdGVyKCdzdXBwcmVzc2lvbnMnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgaWYgKGlucHV0ID09PSBcIi05LDk5OS4wXCIgfHwgaW5wdXQgPT09IFwiLTk5OTlcIikge1xuICAgICAgICByZXR1cm4gJ05BJztcbiAgICB9IGVsc2UgaWYgKGlucHV0ID09PSBcIi02NjYsNjY2LjBcIiB8fCBpbnB1dCA9PT0gXCItNjY2NjY2XCIpIHtcbiAgICAgICAgcmV0dXJuICcgKiAnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG4gIH07XG59KVxuLmZpbHRlcigncGVyY2VudCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KHN0cikgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyICsgXCIlXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgICB9XG4gICAgfVxufSlcbi5maWx0ZXIoJ2FueVN1cHByZXNzZWQnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHN1cHByZXNzaW9uKSB7XG4gICAgICAgIGFyciA9IGxvZGFzaC5mbGF0dGVuRGVlcChsb2Rhc2gucGx1Y2soYXJyLCBcImRhdGFcIikpO1xuXG4gICAgICAgIGlmICh0eXBlb2Ygc3VwcHJlc3Npb24gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2hlY2tpbmcgc3VwcHJlc3Npb246IFwiK3N1cHByZXNzaW9uKTtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgICAgICAgICBvID0gbG9kYXNoLnZhbHVlcyhvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmluZGV4T2Yobywgc3VwcHJlc3Npb24pICE9PSAtMTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gYXNzdW1lIHRvIGNoZWNrIGVpdGhlciBzdXBwcmVzc2lvblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJjaGVja2luZyBib3RoIHN1cHByZXNzaW9uIHR5cGVzXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgZnVuY3Rpb24obykge1xuICAgICAgICAgICAgICAgIG8gPSBsb2Rhc2gudmFsdWVzKG8pO1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2Rhc2guaW5kZXhPZihvLCAnLTY2NjY2NicpICE9PSAtMSB8fCBsb2Rhc2guaW5kZXhPZihvLCAnLTk5OTknKSAhPT0gLTE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1dKVxuLmZpbHRlcignYW55JywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIpXG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ25vbmUnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHByb3ApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAhbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdzbHVnZ2lmeScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIFwiX1wiKVxuICAgIH07XG59KVxuLmZpbHRlcignc2FmZScsIFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbC50b1N0cmluZygpKTtcbiAgICB9O1xufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0Fib3V0UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICovJ3NpZGViYXJEaXNwbGF5JywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgKi9zaWRlYmFyRGlzcGxheSwgY29udHJpYnV0b3JzKXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihuZXdSb3V0ZSwgb2xkUm91dGUpIHtcbiAgICAgICAgLy8gICAgICRsb2NhdGlvbi5oYXNoKCRyb3V0ZVBhcmFtcy5zY3JvbGxUbyk7XG4gICAgICAgIC8vICAgICAkYW5jaG9yU2Nyb2xsKCk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKFwiYWxsXCIpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgLy8gSSBtYWRlIGNoYW5nZXMgdG8gdGhlIHNpZGViYXIgZGlzcGxheSBzZXJ2aWNlLCByZW5hbWluZyB0aGUgaW50ZXJuYWxcbiAgICAgICAgICAgIC8vIHNldHRpbmcgdG8gYmUgXCJvcGVuXCIsIHdoaWNoIG1ha2VzIGl0IGVhc2llciB0byBpbnRlcnByZXQgdGhpcy4gSSBtYWRlXG4gICAgICAgICAgICAvLyBjb3JyZXNwb25kaW5nIGNoYW5nZXMgaW4gdGhlIGFib3V0IGFuZCBkYXRhIHRlbXBsYXRlcy5cbiAgICAgICAgICAgIC8vIFRoaXMgbGlzdGVuZXIgZW5zdXJlcyB0aGF0IHRoZSBzaWRlYmFyIGRvZXNuJ3QgZ2V0IGNsb3NlZCwgd2hpY2ggc29tZWhvd1xuICAgICAgICAgICAgLy8gcmVzb2x2ZXMgdGhlIGlzc3VlIG9mIHJlbmRlcmluZyB0aGUgdGVtcGxhdGUgdW5kZXJuZWF0IHRoZSBzbGlkZW91dCBtZW51XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignRGF0YVZpekNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywgJyRmaWx0ZXInLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCAnJHJvdXRlUGFyYW1zJywgKi8nc2lkZWJhckRpc3BsYXknLCAnY2F0ZWdvcmllcycsICdsb2Rhc2gnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgJGZpbHRlciwvKiAkYW5jaG9yU2Nyb2xsLCAkcm9vdFNjb3BlLCAkcm91dGVQYXJhbXMsICovc2lkZWJhckRpc3BsYXksIGNhdGVnb3JpZXMsIGxvZGFzaCl7XG4gICAgICAgIHZhciBsbyA9IGxvZGFzaDtcbiAgICAgICAgJHNjb3BlLmNoYXJ0cyA9IHt9O1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS5hYm91dENvbGxhcHNlZCA9IGZhbHNlO1xuXG4gICAgICAgICRzY29wZS5jaGVja0NoYXJ0ID0gZnVuY3Rpb24oc2x1Zykge1xuICAgICAgICAgICAgc2x1ZyA9ICRmaWx0ZXIoJ3NsdWdnaWZ5Jykoc2x1Zyk7XG5cbiAgICAgICAgICAgIGlmICghKHNsdWcgaW4gJHNjb3BlLmNoYXJ0cykpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhcnRzW3NsdWddID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNoYXJ0c1tzbHVnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUudG9nZ2xlQ2hhcnQgPSBmdW5jdGlvbihzbHVnKSB7XG4gICAgICAgICAgICBzbHVnID0gJGZpbHRlcignc2x1Z2dpZnknKShzbHVnKTtcblxuICAgICAgICAgICAgaWYgKCEoc2x1ZyBpbiAkc2NvcGUuY2hhcnRzKSkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiU29tZWhvdywgXFxcIlwiK3NsdWcrXCJcXFwiIHdhcyBub3QgaW4gc2NvcGUuY2hhcnRzIVwiKVxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiAkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSAhJHNjb3BlLmNoYXJ0c1tzbHVnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24obmV3Um91dGUsIG9sZFJvdXRlKSB7XG4gICAgICAgIC8vICAgICAkbG9jYXRpb24uaGFzaCgkcm91dGVQYXJhbXMuc2Nyb2xsVG8pO1xuICAgICAgICAvLyAgICAgJGFuY2hvclNjcm9sbCgpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICB2YXIgcHJvbWlzZSA9IGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyhcImFsbFwiKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSlcblxuICAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ3NpbXBsZXRhYmxlJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgcmVmbGVjdCB3aGF0ZXZlciB5b3VyIGQzIHRhYmxlIGZ1bmN0aW9uIGlzIGNhbGxlZC5cbiAgICB2YXIgY2hhcnQgPSB0YWJsZUNoYXJ0KCk7XG4gICAgcmV0dXJuICB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBkYXRhOiBcIj1kYXRhXCIgLy8gV2UgY2FuIGNhbGwgdGhpcyB3L2Ugd2Ugd2FudC5cbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdChlbGVtZW50WzBdKS5kYXR1bShkYXRhKS5jYWxsKGNoYXJ0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgndGltZXNlcmllcycsIFsnJHdpbmRvdycsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHNob3VsZCByZWZsZWN0IHdoYXRldmVyIHlvdXIgZDMgZnVuY3Rpb24gaXMgY2FsbGVkLlxuICAgIHZhciBjaGFydCA9IHRpbWVTZXJpZXMoKTtcbiAgICByZXR1cm4gIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGRhdGE6IFwiPWRhdGFcIiAvLyBXZSBjYW4gY2FsbCB0aGlzIHcvZSB3ZSB3YW50LlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgOiBzY29wZS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGVsZW1lbnRbMF0pLmRhdHVtKGRhdGEpLmNhbGwoY2hhcnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRhdGEgOiBkYXRhLFxuICAgICAgICAgICAgICAgIC8vICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICAgICAgc2NvcGUucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgVGhpcyBjb2RlIGlzIGludGVuZGVkIHRvIGdldCB0aGUgY2hhcnQgdG8gcmVkcmF3IHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgICAgQnV0IGFzIGl0IHN0YW5kcywgc29tZWhvdyB0aGlzIG92ZXJyaWRlcyB0aGUgZGF0YSBhbmQgdGhlIGNoYXJ0IGJlY29tZXMgdXNlbGVzcy5cbiAgICAgICAgICAgICAgICBJIGRvbid0IHRoaW5rIHRoaXMgZmVhdHVyZSBpcyB3b3J0aCB0aGUgZGVidWcgdGltZSBub3csIGJ1dCBpdCdzIHdvcnRoIGtlZXBpbmcgaW4gbWluZCBmb3IgdGhlIGZ1dHVyZS5cbiAgICAgICAgICAgICoqL1xuICAgICAgICAgICAgJHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnJlbmRlcigpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy8gICAgIHNjb3BlLnJlbmRlcihkYXRhKTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgIH1cbiAgICB9XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ2NhdGVnb3JpZXMnLCBbJyRodHRwJywgJyRxJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRodHRwLCAkcSwgbG9kYXNoKSB7XG4gICAgdmFyIGNhdGVnb3JpZXMgPSB7fTtcbiAgICBjYXRlZ29yaWVzLmxpc3QgPSBbXTtcblxuICAgIGNhdGVnb3JpZXMudG9nZ2xlID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgcG9zaXRpb24gPSBsb2Rhc2guZmluZEluZGV4KGNhdGVnb3JpZXMubGlzdCwgZnVuY3Rpb24obGlzdGNhdCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3RjYXQubmFtZSA9PSBjYXRlZ29yeS5uYW1lO1xuICAgICAgICB9KTtcbiAgICAgICAgY2F0ZWdvcmllcy5saXN0W3Bvc2l0aW9uXS5zZWxlY3RlZCA9ICFjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkO1xuICAgIH07XG5cbiAgICBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNhdGVnb3JpZXMubGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBpZiB0aGlzIG9iamVjdCBhbHJlYWR5IGhhcyBkYXRhLCBqdXN0IHVzZSB3aGF0J3MgY3VycmVudGx5IGF2YWlsYWJsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUpe3Jlc29sdmUoY2F0ZWdvcmllcyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2RhdGEuanNvbicpXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gbG9kYXNoLm1hcChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzb3J0IGNhdGVnb3JpZXMgYnkgcmFua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZGFzaC5zb3J0QnkocmVzcG9uc2UsIFwicmFua1wiKSwgZnVuY3Rpb24obykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBlYWNoIGluZGljYXRvciBpbiBlYWNoIGNhdGVnb3J5LCBzb3J0ICdsZXZlbHMnIGJ5IGEgcmFuayBhcyB3ZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kYXRhLmZvckVhY2goZnVuY3Rpb24oaW5kaWNhdG9yLCBpaSwgaWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kYXRhW2lpXS5kYXRhID0gbG9kYXNoLnNvcnRCeUFsbChvLmRhdGFbaWldLmRhdGEsIFwicmFua1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4dGVuZCBlYWNoIGNhdGVnb3J5IHRvIGhhdmUgYSBcInNlbGVjdGVkXCIgdmFsdWUsIGRlZmF1bHQgdG8gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBsb2Rhc2guZXh0ZW5kKHt9LCBvLCB7XCJzZWxlY3RlZFwiIDogdHJ1ZX0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBjYXRlZ29yaWVzLmxpc3QgdG8gYSBzb3J0ZWQgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3JpZXMubGlzdCA9IGxpc3Q7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY2F0ZWdvcmllcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNhdGVnb3JpZXNcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGNhdGVnb3JpZXM7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ2NvbnRyaWJ1dG9ycycsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbigkaHR0cCwgJHEpIHtcbiAgICB2YXIgY29udHJpYnV0b3JzID0ge307XG4gICAgY29udHJpYnV0b3JzLmxpc3QgPSBbXTtcblxuICAgIGNvbnRyaWJ1dG9ycy5nZXRDb250cmlidXRvcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNvbnRyaWJ1dG9ycy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjb250cmlidXRvcnMpfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBvdGhlcndpc2UgZ2V0IGRhdGEgZnJlc2ggZnJvbSBmaWxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvc3RhdGljL2Rpc3QvZGF0YS9jb250cmlidXRvcnMuanNvbicpXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnMubGlzdCA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjb250cmlidXRvcnMpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJUaGVyZSB3YXMgYW4gZXJyb3IgZ2V0dGluZyBjb250cmlidXRvcnNcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGNvbnRyaWJ1dG9ycztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignU2lkZWJhckNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRsb2cnLCdsb2Rhc2gnLCAnY2F0ZWdvcmllcycsICdjb250cmlidXRvcnMnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgbG9kYXNoLCBjYXRlZ29yaWVzLCBjb250cmlidXRvcnMpIHtcbiAgICAgICAgLy8gJHNjb3BlLnN0YXR1cyA9IHtcbiAgICAgICAgLy8gICAgIGlzb3BlbjogZmFsc2VcbiAgICAgICAgLy8gfTtcblxuICAgICAgICB2YXIgY2F0ZWdvcnlQcm9taXNlID0gY2F0ZWdvcmllcy5nZXRDYXRlZ29yaWVzKCk7XG4gICAgICAgIGNhdGVnb3J5UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSlcblxuICAgICAgICB2YXIgY29udHJpYnV0b3JQcm9taXNlID0gY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycygpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGdW5jdGlvbnMgZm9yIG1hbmFnaW5nIHRoZSBwcmVzZW50YXRpb24gb2YgdGhlIHNlbGVjdGVkIGl0ZW1zIGluXG4gICAgICAgIC8vIHRoZSBzaWRlYmFyIGFuZCBwcm9waWdhdGluZyBzZWxlY3Rpb25zIHRocm91Z2ggdGhlIGNhdGdvcmllcyBzZXJ2aWNlXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uKGNhdGVnb3J5KSB7XG4gICAgICAgICAgICBjYXRlZ29yaWVzLnRvZ2dsZShjYXRlZ29yeSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNoZWNrU2VsZWN0ZWQgPSBmdW5jdGlvbihib29sKSB7XG4gICAgICAgICAgICBpZiAoYm9vbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcInNlbGVjdGVkXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBcImRlc2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnRvZ2dsZTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvZ2dsZWQgdHJpZ2dlcmVkIGZyb20gc2lkZWJhclwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50b2dnbGUpO1xuICAgICAgICB9KTtcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnc2lkZWJhckRpc3BsYXknLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0b2dnbGU6IHsgb3BlbjogdHJ1ZSB9XG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1dyYXBDb250cm9sbGVyJywgWyckc2NvcGUnLCAnc2lkZWJhckRpc3BsYXknLCBmdW5jdGlvbigkc2NvcGUsIHNpZGViYXJEaXNwbGF5KSB7XG4gICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRzY29wZS50b2dnbGU7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0b2dnbGVkIHRyaWdnZXJlZCBmcm9tIHdyYXBcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUudG9nZ2xlKTtcbiAgICAgICAgfSk7XG59XSlcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
