var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/introduction",{templateUrl:"static/dist/templates/introduction.html",controller:"AboutPageController"}).when("/civic-engagement",{templateUrl:"static/dist/templates/civic-engagement.html",controller:"EngagementPageController"}).when("/political-participation",{templateUrl:"static/dist/templates/political-participation.html",controller:"ParticipationPageController"}).when("/community-cohesion",{templateUrl:"static/dist/templates/community-cohesion.html",controller:"CohesionPageController"}).when("/institutional-presence",{templateUrl:"static/dist/templates/institutional-presence.html",controller:"InstitutionPageController"}).when("/a-closer-look",{templateUrl:"static/dist/templates/closer-look.html",controller:"CloserLookPageController"}).when("/call-to-action",{templateUrl:"static/dist/templates/call-to-action.html",controller:"CallToActionPageController"}).when("/partners",{templateUrl:"static/dist/templates/partners.html",controller:"PartnersPageController"}).when("/raw-data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).otherwise({redirectTo:"/introduction"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"&ddagger;":"-666,666.0"===t||"-666666"===t?"&dagger;":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("anySuppressed",["lodash",function(t){return function(e,n){return e=t.flattenDeep(t.pluck(e,"data")),"undefined"!=typeof n?t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,n)}):t.some(e,function(e){return e=t.values(e),-1!==t.indexOf(e,"-666666")||-1!==t.indexOf(e,"-9999")})}}]).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return t.trustAsHtml}]),angular.module("app").service("barChartService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){var e=this.getBoundingClientRect(),n={top:.05*e.height,right:.05*e.width,bottom:.2*e.height,left:d3.max([.05*e.width,55])},a=e.width-(n.left+n.right);height=e.height-(n.top+n.bottom),svg=d3.select(this).append("svg").attr("height",e.height).attr("width",e.width),chart=svg.append("g").attr("height",height).attr("width",a).attr("transform","translate("+n.left+", "+n.top+")"),x=d3.scale.ordinal().rangeRoundBands([0,a],.1,.1).domain(o),y=d3.scale.linear().range([height,0]).domain([0,yRangeMax]).nice(10),xAxis=d3.svg.axis().scale(x).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-a).tickPadding(10).tickFormat(function(t){return d3.format("f")(t)+"%"}),chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(xAxis),chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis),chart.selectAll("rect.barchart-bar").data(t).enter().append("rect").attr("class",function(t,e){var n="bar-color-"+(e%2+1);return["barchart-bar",n].join(" ")}).attr("width",x.rangeBand()).attr("height",function(t){return height-y(t.Value)}).attr("x",function(t){return x(t.Bar)}).attr("y",function(t){return y(t.Value)}),chart.selectAll("text.barchart-value").data(t).enter().append("text").classed("barchart-value",!0).text(function(t){return d3.format("f")(t.Value)+"%"}).attr("width",x.rangeBand()).attr("y",function(t){return y(t.Value)}).attr("text-anchor","middle").attr("x",function(t){return x(t.Bar)+x.rangeBand()/2}).attr("dy",-4)})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var o=n.chain(e).map(function(t){return t.Bar}).unique().value();return yRangeMax=n.chain(e).map(function(t){return+t.Value}).max().value(),chartContainer=d3.select(t).append("div").classed("barchart-container",!0).append("div").classed("barchart-container-internal",!0).datum(e),void r(chartContainer)},a}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getCategories("all");l.then(function(e){t.categories=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0,o.section="Raw Data"})}]),angular.module("app").directive("dataviz",["$window","$http","timeseriesService","groupedBarChartService","barChartService","tableService",function(t,e,n,a,r,o){var i={line:n.chart,bar:r.chart,groupedBar:a.chart,table:o.chart};return{restrict:"E",scope:{which:"=which",type:"=type"},link:function(t,n,a){t.render=function(){t.data?i[t.type](n[0],result.data,{}):e.get("/static/dist/data/csv/"+t.which+".csv").then(function(e){t.data=e.data,i[t.type](n[0],t.data,{})})},t.$watchCollection("which",function(){t.render()})}}}]),angular.module("app").service("groupedBarChartService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){var e=this.getBoundingClientRect(),a={top:.05*e.height,right:.05*e.width,bottom:.2*e.height,left:d3.max([.05*e.width,55])},r=e.width-(a.left+a.right);height=e.height-(a.top+a.bottom),svg=d3.select(this).append("svg").attr("height",e.height).attr("width",e.width),chart=svg.append("g").attr("height",height).attr("width",r).attr("transform","translate("+a.left+", "+a.top+")"),colors=d3.scale.ordinal().range(["bar-color-1","bar-color-2","bar-color-3","bar-color-4"]).domain(i),x0=d3.scale.ordinal().rangeRoundBands([0,r],.2,.2).domain(o),x1=d3.scale.ordinal().rangeRoundBands([0,x0.rangeBand()],.1,0).domain(i),y=d3.scale.linear().range([height,0]).domain([0,yRangeMax]).nice(5),x0Axis=d3.svg.axis().scale(x0).orient("bottom"),x1Axis=d3.svg.axis().scale(x1).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-r).tickPadding(10).tickFormat(function(t){return d3.format("f")(t)+"%"});var l=chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(x0Axis);chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis);var c=chart.selectAll("g.groupedbar-group").data(t).enter().append("g").classed("groupedbar-group",!0).attr("width",x0.rangeBand()).attr("height",height).attr("transform",function(t){return"translate("+x0(t.key)+", 0)"}).datum(function(t){return t.values});c.each(function(t){var e=n.chain(t).map(function(t){return t.Bar}).without("").value(),r=n.chain(t).map(function(t){return t.Label}).without("").value(),o=x1.copy().domain(e);r.length>0&&l.attr("transform","translate(0, "+(height+a.bottom/2)+")"),d3.select(this).selectAll("rect.groupdbar-bar").data(t).enter().append("rect").attr("class",function(t){return["groupedbar-bar",colors(t.Bar)].join(" ")}).attr("width",o.rangeBand()).attr("height",function(t){return height-y(t.Value)}).attr("x",function(t){return o(t.Bar)}).attr("y",function(t){return y(t.Value)}),d3.select(this).selectAll("text.groupdbar-value").data(t).enter().append("text").classed("groupdbar-value",!0).text(function(t){return d3.format("0.1f")(t.Value)+"%"}).attr("width",o.rangeBand()).attr("y",function(t){return y(t.Value)}).attr("text-anchor","middle").attr("x",function(t){return o(t.Bar)+o.rangeBand()/2}).attr("dy",-4),d3.select(this).selectAll("text.groupdbar-label").data(t).enter().append("text").classed("groupdbar-label",!0).text(function(t){return t.Label}).attr("width",x1.rangeBand()).attr("y",height).attr("text-anchor","middle").attr("x",function(t){return x1(t.Bar)+x1.rangeBand()/2}).attr("dy",16)})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var o=n.chain(e).map(function(t){return t.Group}).unique().value(),i=n.chain(e).map(function(t){return t.Bar}).unique().value();return yRangeMax=n.chain(e).map(function(t){return+t.Value}).max().value(),e=d3.nest().key(function(t){return t.Group}).entries(e),chartContainer=d3.select(t).append("div").classed("groupedbar-container",!0).append("div").classed("groupedbar-container-internal",!0).datum(e),void r(chartContainer)},a}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,a){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").service("tableService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){var e=d3.select(this).append("table").attr("class","ctdata-table"),n=e.append("thead"),a=e.append("tbody");n.append("tr").selectAll("th").data(o).enter().append("th").attr("class",function(t){return"Indicator"===t?"hide":"col-name"}).text(function(t){return t});var r=a.selectAll("tr").data(t).enter().append("tr");r.selectAll("td").data(function(t){return o.map(function(e){return{column:e,value:t[e]}})}).enter().append("td").attr("class",function(t){return"Indicator"===t.column?"name":"value"}).html(function(t){return t.value})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var o=[];for(k in e[0])o.push(k);chartContainer=d3.select(t).append("div").classed("table-container-internal",!0).datum(e),r(chartContainer)},a}]),angular.module("app").service("timeseriesService",["$q","$http","lodash",function(t,e,n){var a={};return a.chart=function(t,e,a){function r(t){t.each(function(t){var e=this.getBoundingClientRect(),n={top:.01*e.height,right:.01*e.width,bottom:.01*e.height,left:.01*e.width},a=e.width-(n.left+n.right);height=e.height-(n.top+n.bottom),colors=d3.scale.ordinal().range(["#1EACF1","#B94A48"]).domain(t);var r=(d3.select(this).selectAll("div").data(t).enter().append("svg").attr("height",height).attr("width",a).append("g").classed("legend",!0).attr("height",height).attr("width",a).attr("transform","translate("+n.left+", "+n.top+")"),legend.selectAll("g.entry").data(legendData).enter().append("g").attr("data-class",function(t){return sluggify(t)}).attr("class",function(t){var e=["entry",sluggify(t)].join(" ");return e}).attr("transform",function(t,e){return"translate(0, "+19*e+")"}).datum(function(t){return t}));r.each(function(){var t=r.selectAll("tspan").size();d3.select(this).attr("transform",function(e,n){return"translate(0, "+19*n+19*(t-n)+")"}),d3.select(this).append("path").attr("fill",function(t,e){return colors(t)}).attr("stroke",function(t,e){return colors(t)}).attr("stroke-width",0).attr("d",d3.svg.symbol().type(function(t){return symbolScale(t)}).size(25)),d3.select(this).append("text").attr("fill","#4A4A4A").attr("y",6).attr("dx",8).tspans(function(t){return d3.wordwrap(t,20)})}),d3.selectAll("tspan").attr("dx",8)})}function o(t){t.each(function(t){var e=this.getBoundingClientRect(),a={top:.05*e.height,right:.05*e.width,bottom:.1*e.height,left:d3.max([.05*e.width,55])},r=e.width-(a.left+a.right);height=e.height-(a.top+a.bottom),svg=d3.select(this).append("svg").attr("height",e.height).attr("width",e.width),chart=svg.append("g").attr("height",height).attr("width",r).attr("transform","translate("+a.left+", "+a.top+")"),colors=d3.scale.ordinal().range(["#1EACF1","#B94A48"]).domain(i),symbolScale=d3.scale.ordinal().range(d3.svg.symbolTypes).domain(i),timeFormat=d3.time.format("%Y"),timeRange=n.chain(t).map(function(t){return t.Year}).value(),x=d3.time.scale().range([12,r]).domain(d3.extent(timeRange).map(function(t){return timeFormat.parse(t)})),y=d3.scale.linear().range([height,0]).domain(d3.extent(n.chain(t).map(function(t){return i.map(function(e){return+t[e]})}).flatten().unique().value())).nice(5,10),xAxis=d3.svg.axis().scale(x).orient("bottom").ticks(d3.time.year,1),yAxis=d3.svg.axis().scale(y).orient("left").innerTickSize(-r).tickPadding(10),line=d3.svg.line().x(function(t){return x(t.Year)}).y(function(t){return y(t.Value)}),t=i.map(function(e){return{Key:e,Values:n.map(t,function(t){return{Year:timeFormat.parse(t.Year),Value:+t[e]}})}}),chart.append("g").classed({"x-axis":!0,axis:!0}).attr("transform","translate(0, "+height+")").call(xAxis),chart.append("g").classed({"y-axis":!0,axis:!0}).attr("transform","translate(-12, 0)").call(yAxis),chart.selectAll("g.timeseries-lines").data(t).enter().append("g").classed("timeseries-lines",!0).append("path").classed("timeseries-path",!0).attr("d",function(t){return line(t.Values)}).attr("stroke",function(t,e){return colors(t.Key)});var o=t.map(function(t,e,n){return t.Values.map(function(e,n,a){return e.Key=t.Key,e})});o=n.flatten(o),chart.append("g").classed("timeseries-points",!0).selectAll("g").data(o).enter().append("path").attr("stroke",function(t,e){return colors(t.Key)}).attr("d",d3.svg.symbol().type("circle").size(65)).attr("transform",function(t){return"translate("+x(t.Year)+", "+y(t.Value)+")"})})}a.facet=n.difference(["structure","time"],[a.facet])[0],e=d3.csv.parse(e);var i=n.chain(e[0]).keys().filter(function(t){return"Year"!==t}).value();chartContainer=d3.select(t).append("div").classed("timeseries-container",!0).append("div").classed("timeseries-container-internal",!0).datum(e),legendContainer=d3.select(t).append("div").classed({"legend-container":!0,"timeseries-legend-container":!0}),o(chartContainer);var l=legendContainer.selectAll("div.legend").data([i]).enter().append("div").classed({legend:!0,"timeseries-legend":!0});r(l)},a}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getContributors("all");l.then(function(e){t.contributors=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,o.section="Introduction",t.nextSection="Civic Engagement",t.nextSectionTeaser="Testing",t.nextSectionURL="#/civic-engagement"})}]),angular.module("app").controller("CallToActionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Call To Action"})}]),angular.module("app").controller("CloserLookPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="A Closer Look",t.nextSection="Institutional Presence",t.nextSectionTeaser="Stuff about institutions",t.nextSectionURL="#/institutional-presence"})}]),angular.module("app").controller("CohesionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Social Networks and Community Cohesion",t.nextSection="Institutional Presence",t.nextSectionTeaser="Stuff about institutions",t.nextSectionURL="#/institutional-presence"})}]),angular.module("app").controller("EngagementPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Civic Engagement",t.nextSection="Political Participation",t.nextSectionTeaser="Stuff about political participation",t.nextSectionURL="#/political-participation"})}]),angular.module("app").controller("ParticipationPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Political Participation",t.nextSection="Community Cohesion",t.nextSectionTeaser="Stuff about cohesion",t.nextSectionURL="#/community-cohesion"})}]),angular.module("app").controller("PartnersPageController",["$scope","$http","$log","$location","$routeParams","sidebarDisplay","contributors",function(t,e,n,a,r,o,i){t.toggle=o.toggle;var l=i.getContributors("all");l.then(function(e){t.contributors=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,o.section="Partners",t.nextSection="Raw Data",t.nextSectionTeaser="Stuff about raw data",t.nextSectionURL="#/raw-data"})}]),angular.module("app").controller("InstitutionPageController",["$scope","$http","$log","$location","sidebarDisplay",function(t,e,n,a,r){t.toggle=r.toggle,t.$on("$viewContentLoaded",function(e){t.toggle.open=!1,r.section="Institutional Presence",t.nextSection="Call to Action",t.nextSectionTeaser="Stuff about call to action",t.nextSectionURL="#/call-to-action"})}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var a={};return a.list=[],a.toggle=function(t){position=n.findIndex(a.list,function(e){return e.name==t.name}),a.list[position].selected=!a.list[position].selected},a.getCategories=function(){return e(a.list.length>0?function(t){t(a)}:function(e,r){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,a,r){t.data[a].data=n.sortByAll(t.data[a].data,"rank")}),t=n.extend({},t,{selected:!0})}),a.list=list,e(a)}).error(function(){r("There was an error getting categories")})})},a}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,a){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){a("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,a,r){var o=a.getCategories();o.then(function(e){t.categories=a.list},function(t){alert("promise rejected!")});var i=r.getContributors();i.then(function(e){t.contributors=r.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){a.toggle(t)},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0},section:"Introduction"}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.section=e.section,t.$watchCollection(function(){return e.section},function(){t.section=e.section})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJkYXRhdml6L2JhckNoYXJ0U2VydmljZS5zZXJ2aWNlLmpzIiwiZGF0YXZpei9kYXRhdml6LmNvbnRyb2xsZXIuanMiLCJkYXRhdml6L2RhdGF2aXouZGlyZWN0aXZlLmpzIiwiZGF0YXZpei9ncm91cGVkQmFyQ2hhcnQuc2VydmljZS5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90YWJsZS5zZXJ2aWNlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLnNlcnZpY2UuanMiLCJwYWdlcy9hYm91dHBhZ2UuY29udHJvbGxlci5qcyIsInBhZ2VzL2NhbGx0b2FjdGlvbi5jb250cm9sbGVyLmpzIiwicGFnZXMvY2xvc2VybG9vay5jb250cm9sbGVyLmpzIiwicGFnZXMvY29oZXNpb24uY29udHJvbGxlci5qcyIsInBhZ2VzL2VuZ2FnZW1lbnQuY29udHJvbGxlci5qcyIsInBhZ2VzL3BhcnRpY2lwYXRpb24uY29udHJvbGxlci5qcyIsInBhZ2VzL3BhcnRuZXJzLmNvbnRyb2xsZXJzLmpzIiwicGFnZXMvcHJlc2VuY2UuY29udHJvbGxlci5qcyIsInNpZGViYXIvY2F0ZWdvcmllcy5zZXJ2aWNlLmpzIiwic2lkZWJhci9jb250cmlidXRvcnMuc2VydmljZS5qcyIsInNpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwic2lkZWJhci9zaWRlYmFyZGlzcGxheS5zZXJ2aWNlLmpzIiwic2lkZWJhci93cmFwLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZpbHRlciIsImlucHV0Iiwic3RyIiwicGFyc2VJbnQiLCJsb2Rhc2giLCJhcnIiLCJzdXBwcmVzc2lvbiIsImZsYXR0ZW5EZWVwIiwicGx1Y2siLCJzb21lIiwibyIsInZhbHVlcyIsImluZGV4T2YiLCJwcm9wIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiJHNjZSIsInRydXN0QXNIdG1sIiwic2VydmljZSIsIiRxIiwiJGh0dHAiLCJiYXJDaGFydFNlcnZpY2UiLCJjaGFydCIsImNvbnRhaW5lciIsImRhdGEiLCJtYWtlYmFyY2hhcnRDaGFydCIsInNlbGVjdGlvbiIsImVhY2giLCJCQm94IiwidGhpcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm1hcmdpbiIsInRvcCIsImhlaWdodCIsInJpZ2h0Iiwid2lkdGgiLCJib3R0b20iLCJsZWZ0IiwiZDMiLCJtYXgiLCJzdmciLCJzZWxlY3QiLCJhcHBlbmQiLCJhdHRyIiwieCIsInNjYWxlIiwib3JkaW5hbCIsInJhbmdlUm91bmRCYW5kcyIsImRvbWFpbiIsImJhcktleXMiLCJ5IiwibGluZWFyIiwicmFuZ2UiLCJ5UmFuZ2VNYXgiLCJuaWNlIiwieEF4aXMiLCJheGlzIiwib3JpZW50IiwieUF4aXMiLCJpbm5lclRpY2tTaXplIiwidGlja1BhZGRpbmciLCJ0aWNrRm9ybWF0IiwidCIsImZvcm1hdCIsImNsYXNzZWQiLCJ4LWF4aXMiLCJjYWxsIiwieS1heGlzIiwic2VsZWN0QWxsIiwiZW50ZXIiLCJkIiwiaSIsImNvbG9yQ2xhc3MiLCJqb2luIiwicmFuZ2VCYW5kIiwiVmFsdWUiLCJCYXIiLCJ0ZXh0IiwiZmFjZXQiLCJkaWZmZXJlbmNlIiwiY3N2IiwicGFyc2UiLCJjaGFpbiIsIm1hcCIsInVuaXF1ZSIsInZhbHVlIiwiY2hhcnRDb250YWluZXIiLCJkYXR1bSIsIiRzY29wZSIsIiRsb2ciLCIkbG9jYXRpb24iLCIkZmlsdGVyIiwic2lkZWJhckRpc3BsYXkiLCJjYXRlZ29yaWVzIiwidG9nZ2xlIiwicHJvbWlzZSIsImdldENhdGVnb3JpZXMiLCJ0aGVuIiwicmVzdWx0IiwibGlzdCIsInJlamVjdGlvbiIsImFsZXJ0IiwiJG9uIiwiZXZlbnQiLCJvcGVuIiwic2VjdGlvbiIsImRpcmVjdGl2ZSIsIiR3aW5kb3ciLCJ0aW1lc2VyaWVzU2VydmljZSIsImdyb3VwZWRCYXJDaGFydFNlcnZpY2UiLCJ0YWJsZVNlcnZpY2UiLCJjaGFydHMiLCJsaW5lIiwiYmFyIiwiZ3JvdXBlZEJhciIsInRhYmxlIiwicmVzdHJpY3QiLCJzY29wZSIsIndoaWNoIiwidHlwZSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJyZW5kZXIiLCJnZXQiLCIkd2F0Y2hDb2xsZWN0aW9uIiwibWFrZUdyb3VwZWRCYXJDaGFydCIsImNvbG9ycyIsIngwIiwiZ3JvdXBLZXlzIiwieDEiLCJ4MEF4aXMiLCJ4MUF4aXMiLCJ4MEF4aXNHcm91cCIsImJhckdyb3VwcyIsImtleSIsImdyb3VwRGF0YSIsInRoaXNHcm91cEJhcnMiLCJ3aXRob3V0IiwidGhpc0dyb3VwTGFiZWxzIiwiTGFiZWwiLCJ0aGlzR3JvdXBYMSIsImNvcHkiLCJsZW5ndGgiLCJHcm91cCIsIm5lc3QiLCJlbnRyaWVzIiwidGFibGVDaGFydCIsIm1ha2VUYWJsZSIsInRoZWFkIiwidGJvZHkiLCJjb2x1bW5zIiwicm93cyIsInJvdyIsImNvbHVtbiIsImh0bWwiLCJrIiwicHVzaCIsIm1ha2VMZWdlbmQiLCJsZWdlbmRHcm91cHMiLCJsZWdlbmQiLCJsZWdlbmREYXRhIiwic2x1Z2dpZnkiLCJjbGFzc2VzIiwidHNwYW5Db3VudCIsInNpemUiLCJzeW1ib2wiLCJzeW1ib2xTY2FsZSIsInRzcGFucyIsIndvcmR3cmFwIiwibWFrZVRpbWVTZXJpZXMiLCJsaW5lS2V5cyIsInN5bWJvbFR5cGVzIiwidGltZUZvcm1hdCIsInRpbWUiLCJ0aW1lUmFuZ2UiLCJZZWFyIiwiZXh0ZW50IiwiZmxhdHRlbiIsInRpY2tzIiwieWVhciIsIktleSIsIlZhbHVlcyIsInBvaW50RGF0YSIsImRpIiwiZGEiLCJ2IiwidmkiLCJ2YSIsImtleXMiLCJsZWdlbmRDb250YWluZXIiLCJsZWdlbmQtY29udGFpbmVyIiwidGltZXNlcmllcy1sZWdlbmQtY29udGFpbmVyIiwibGVnZW5kRGl2IiwidGltZXNlcmllcy1sZWdlbmQiLCIkcm91dGVQYXJhbXMiLCJjb250cmlidXRvcnMiLCJjb250cmlidXRvclByb21pc2UiLCJnZXRDb250cmlidXRvcnMiLCJuZXh0U2VjdGlvbiIsIm5leHRTZWN0aW9uVGVhc2VyIiwibmV4dFNlY3Rpb25VUkwiLCJjYXRlZ29yeSIsInBvc2l0aW9uIiwiZmluZEluZGV4IiwibGlzdGNhdCIsIm5hbWUiLCJzZWxlY3RlZCIsInJlc29sdmUiLCJyZWplY3QiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzb3J0QnkiLCJmb3JFYWNoIiwiaW5kaWNhdG9yIiwiaWkiLCJpYSIsInNvcnRCeUFsbCIsImV4dGVuZCIsImVycm9yIiwiY2F0ZWdvcnlQcm9taXNlIiwidXBkYXRlU2VsZWN0ZWQiLCJjaGVja1NlbGVjdGVkIiwiYm9vbCIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsV0FDQSxXQ0pBRCxTQUFBQyxPQUFBLE9BQ0FDLFFBQUEsaUJBQUEsb0JBQUEsU0FBQUMsRUFBQUMsR0FDQUQsRUFDQUUsS0FBQSxpQkFDQUMsWUFBQSwwQ0FDQUMsV0FBQSx3QkFFQUYsS0FBQSxxQkFDQUMsWUFBQSw4Q0FDQUMsV0FBQSw2QkFFQUYsS0FBQSw0QkFDQUMsWUFBQSxxREFDQUMsV0FBQSxnQ0FFQUYsS0FBQSx1QkFDQUMsWUFBQSxnREFDQUMsV0FBQSwyQkFFQUYsS0FBQSwyQkFDQUMsWUFBQSxvREFDQUMsV0FBQSw4QkFFQUYsS0FBQSxrQkFDQUMsWUFBQSx5Q0FDQUMsV0FBQSw2QkFFQUYsS0FBQSxtQkFDQUMsWUFBQSw0Q0FDQUMsV0FBQSwrQkFFQUYsS0FBQSxhQUNBQyxZQUFBLHNDQUNBQyxXQUFBLDJCQUVBRixLQUFBLGFBQ0FDLFlBQUEsa0NBQ0FDLFdBQUEsc0JBRUFDLFdBQ0FDLFdBQUEs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LE1BQUEsV0FDQVYsRUFBQSxnREFNQWIsS0N4QkE5TSxRQUFBQyxPQUFBLE9BQ0FNLFdBQUEscUJBQ0EsU0FBQSxPQUFBLFNBQUEsYUFBQSxlQUNBLFNBQUEyRixFQUFBQyxFQUFBckYsRUFBQXlGLEVBQUF1RyxHQUtBLEdBQUF3QixHQUFBL0gsRUFBQUcsZUFDQTRILEdBQUEzSCxLQUFBLFNBQUFDLEdBQ0FWLEVBQUFLLFdBQUFBLEVBQUFNLE1BQ0EsU0FBQUMsR0FDQUMsTUFBQSxzQkFHQSxJQUFBZ0csR0FBQUQsRUFBQUUsaUJBQ0FELEdBQUFwRyxLQUFBLFNBQUFDLEdBQ0FWLEVBQUE0RyxhQUFBQSxFQUFBakcsTUFDQSxTQUFBQyxHQUNBQyxNQUFBLHVCQUtBYixFQUFBcUksZUFBQSxTQUFBbkIsR0FDQTdHLEVBQUFDLE9BQUE0RyxJQUdBbEgsRUFBQXNJLGNBQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUNBLFdBRUEsY0FHQXZJLEVBQUFxQyxpQkFBQSxXQUNBLE1BQUFyQyxHQUFBTSxRQUNBLFdBQ0FrSSxRQUFBQyxJQUFBLGtDQUNBRCxRQUFBQyxJQUFBekksRUFBQU0sYUN2Q0F4RyxRQUFBQyxPQUFBLE9BQ0EyQixRQUFBLGlCQUFBLFdBQ0EsT0FDQTRFLFFBQUFVLE1BQUEsR0FDQUMsUUFBQSxrQkNKQW5ILFFBQUFDLE9BQUEsT0FDQU0sV0FBQSxrQkFBQSxTQUFBLGlCQUFBLFNBQUEyRixFQUFBSSxHQUNBSixFQUFBTSxPQUFBRixFQUFBRSxPQUNBTixFQUFBaUIsUUFBQWIsRUFBQWEsUUFFQWpCLEVBQUFxQyxpQkFBQSxXQUNBLE1BQUFqQyxHQUFBYSxTQUNBLFdBQ0FqQixFQUFBaUIsUUFBQWIsRUFBQWEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgJ25nQW5pbWF0ZScsXG4gICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgJ25nTG9kYXNoJyxcbiAgICAnbmdSb3V0ZSdcbiAgICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignL2ludHJvZHVjdGlvbicsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL2ludHJvZHVjdGlvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBYm91dFBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NpdmljLWVuZ2FnZW1lbnQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jaXZpYy1lbmdhZ2VtZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0VuZ2FnZW1lbnRQYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wb2xpdGljYWwtcGFydGljaXBhdGlvbicsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL3BvbGl0aWNhbC1wYXJ0aWNpcGF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BhcnRpY2lwYXRpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9jb21tdW5pdHktY29oZXNpb24nLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jb21tdW5pdHktY29oZXNpb24uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ29oZXNpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9pbnN0aXR1dGlvbmFsLXByZXNlbmNlJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvaW5zdGl0dXRpb25hbC1wcmVzZW5jZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdJbnN0aXR1dGlvblBhZ2VDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2EtY2xvc2VyLWxvb2snLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jbG9zZXItbG9vay5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDbG9zZXJMb29rUGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvY2FsbC10by1hY3Rpb24nLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9jYWxsLXRvLWFjdGlvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYWxsVG9BY3Rpb25QYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wYXJ0bmVycycsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2Rpc3QvdGVtcGxhdGVzL3BhcnRuZXJzLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BhcnRuZXJzUGFnZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvcmF3LWRhdGEnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9kYXRhLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0RhdGFWaXpDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvaW50cm9kdWN0aW9uJ1xuICAgICAgICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZmlsdGVyKCdzdXBwcmVzc2lvbnMnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgaWYgKGlucHV0ID09PSBcIi05LDk5OS4wXCIgfHwgaW5wdXQgPT09IFwiLTk5OTlcIikge1xuICAgICAgICByZXR1cm4gJyZkZGFnZ2VyOyc7XG4gICAgfSBlbHNlIGlmIChpbnB1dCA9PT0gXCItNjY2LDY2Ni4wXCIgfHwgaW5wdXQgPT09IFwiLTY2NjY2NlwiKSB7XG4gICAgICAgIHJldHVybiAnJmRhZ2dlcjsnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG4gIH07XG59KVxuLmZpbHRlcigncGVyY2VudCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KHN0cikgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyICsgXCIlXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgICB9XG4gICAgfVxufSlcbi5maWx0ZXIoJ2FueVN1cHByZXNzZWQnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHN1cHByZXNzaW9uKSB7XG4gICAgICAgIGFyciA9IGxvZGFzaC5mbGF0dGVuRGVlcChsb2Rhc2gucGx1Y2soYXJyLCBcImRhdGFcIikpO1xuXG4gICAgICAgIGlmICh0eXBlb2Ygc3VwcHJlc3Npb24gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2hlY2tpbmcgc3VwcHJlc3Npb246IFwiK3N1cHByZXNzaW9uKTtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIsIGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgICAgICAgICBvID0gbG9kYXNoLnZhbHVlcyhvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9kYXNoLmluZGV4T2Yobywgc3VwcHJlc3Npb24pICE9PSAtMTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gYXNzdW1lIHRvIGNoZWNrIGVpdGhlciBzdXBwcmVzc2lvblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJjaGVja2luZyBib3RoIHN1cHByZXNzaW9uIHR5cGVzXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgZnVuY3Rpb24obykge1xuICAgICAgICAgICAgICAgIG8gPSBsb2Rhc2gudmFsdWVzKG8pO1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2Rhc2guaW5kZXhPZihvLCAnLTY2NjY2NicpICE9PSAtMSB8fCBsb2Rhc2guaW5kZXhPZihvLCAnLTk5OTknKSAhPT0gLTE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1dKVxuLmZpbHRlcignYW55JywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIpXG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ25vbmUnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHByb3ApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAhbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdzbHVnZ2lmeScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIFwiX1wiKVxuICAgIH07XG59KVxuLmZpbHRlcignc2FmZScsIFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcbiAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbDtcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdiYXJDaGFydFNlcnZpY2UnLCBbJyRxJywgJyRodHRwJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRxLCAkaHR0cCwgbG9kYXNoKSB7XG4gICAgdmFyIGJhckNoYXJ0U2VydmljZSA9IHt9O1xuXG4gICAgYmFyQ2hhcnRTZXJ2aWNlLmNoYXJ0ID0gZnVuY3Rpb24oY29udGFpbmVyLCBkYXRhLCBjb25maWcpIHtcbiAgICAgICAgdmFyIHRpbWVGb3JtYXRzID0ge1xuICAgICAgICAgICAgXCJ5ZWFyXCIgOiBcIllZWVlcIixcbiAgICAgICAgICAgIFwicXVhcnRlclwiIDogXCJbUV1RIFlZWVlcIixcbiAgICAgICAgICAgIFwibW9udGhcIiA6IFwiTU1NIFlZWVlcIlxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbmZpZy5mYWNldCA9IGxvZGFzaC5kaWZmZXJlbmNlKFtcInN0cnVjdHVyZVwiLCBcInRpbWVcIl0sIFtjb25maWcuZmFjZXRdKVswXVxuXG4gICAgICAgIC8vIGNvbnZlcnQgZGF0YSBmcm9tIHN0cmluZyAtPiBhcnJheSBvZiBvYmpcbiAgICAgICAgZGF0YSA9IGQzLmNzdi5wYXJzZShkYXRhKTtcblxuICAgICAgICB2YXIgYmFyS2V5cyA9bG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkJhcjsgfSlcbiAgICAgICAgICAgICAgICAudW5pcXVlKClcbiAgICAgICAgICAgICAgICAudmFsdWUoKVxuICAgICAgICAgICAgeVJhbmdlTWF4ID0gbG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiArZC5WYWx1ZTsgfSlcbiAgICAgICAgICAgICAgICAubWF4KClcbiAgICAgICAgICAgICAgICAudmFsdWUoKTtcblxuICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBtYXBzXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImJhcmNoYXJ0LWNvbnRhaW5lclwiLCB0cnVlKVxuICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwiYmFyY2hhcnQtY29udGFpbmVyLWludGVybmFsXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgLmRhdHVtKGRhdGEpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIGxlZ2VuZHNcbiAgICAgICAgLy8gbGVnZW5kQ29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxlZ2VuZC1jb250YWluZXJcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgXCJiYXJjaGFydC1sZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgfSk7XG5cbiAgICAgICAgLy8gY2hhcnRDb250YWluZXIuYXBwZW5kKFwicHJlXCIpXG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSk7XG4gICAgICAgICAgICAvLyAudGV4dChKU09OLnN0cmluZ2lmeSh5UmFuZ2VNYXgsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGJhcktleXMsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGNvbmZpZywgbnVsbCwgNCkpO1xuICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgbWFrZWJhcmNoYXJ0Q2hhcnQoY2hhcnRDb250YWluZXIpO1xuXG4gICAgICAgIHJldHVybjtcblxuICAgICAgICB2YXIgbGVnZW5kRGl2ID0gbGVnZW5kQ29udGFpbmVyLnNlbGVjdEFsbChcImRpdi5sZWdlbmRcIilcbiAgICAgICAgICAgIC5kYXRhKFtiYXJLZXlzXSlcbiAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICBcImxlZ2VuZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcImJhcmNoYXJ0LWxlZ2VuZFwiOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICBtYWtlTGVnZW5kKGxlZ2VuZERpdik7XG5cbiAgICAgICAgLy8gLyoqIFNUQVJUIFNDUk9MTCBOT1RJQ0UgKiovXG4gICAgICAgIC8vIC8vIGlmIHdlIGFyZSB1bmRlciBhIGNlcnRhaW4gcGl4ZWwgc2l6ZSwgdGhlcmUgd2lsbCBiZSBob3Jpem9udGFsIHNjcm9sbGluZ1xuICAgICAgICAvLyB2YXIgaW50ZXJuYWxDb250YWluZXJTaXplID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2LmJhcmNoYXJ0LWNvbnRhaW5lci1pbnRlcm5hbFwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIC8vICAgICBjb250YWluZXJTaXplID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2LmJhcmNoYXJ0LWNvbnRhaW5lclwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgLy8gLy8gY29uc29sZS5sb2coaW50ZXJuYWxDb250YWluZXJTaXplLndpZHRoICsgXCIgLyBcIiArIGNvbnRhaW5lclNpemUud2lkdGgpXG4gICAgICAgIC8vIGlmIChpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggPiBjb250YWluZXJTaXplLndpZHRoKSB7XG4gICAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhcInNjcm9sbCBOb3RpY2UhXCIpXG4gICAgICAgIC8vICAgICAvLyBjcmVhdGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAvLyAgICAgdmFyIHNjcm9sbE5vdGljZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi5iYXJjaGFydC1jb250YWluZXJcIikuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoXCJzY3JvbGwtbm90aWNlXCIsIHRydWUpXG4gICAgICAgIC8vICAgICAgICAgLmFwcGVuZChcInBcIik7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBcImZhXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwic3BhblwiKVxuICAgICAgICAvLyAgICAgICAgIC50ZXh0KFwiU2Nyb2xsIGZvciBtb3JlXCIpO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwiaVwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYVwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYS1hbmdsZS1kb3VibGUtZG93biBcIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICB9KTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIC8vIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5iYXJjaGFydC1jb250YWluZXJcIikub24oXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAvLyBpZiBzY3JvbGwgYXQgYm90dG9tLCBoaWRlIHNjcm9sbCBub3RpY2VcbiAgICAgICAgLy8gICAgIC8vIHVzaW5nIGEgZGlmZmVyZW50IGNsYXNzIHNvIGFzIG5vdCB0byBpbnRlcmZlcmUgd2l0aCB0aGUgbW91c2VvdmVyIGVmZmVjdHNcbiAgICAgICAgLy8gICAgIGlmICgoZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5zY3JvbGxMZWZ0ICsgZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5vZmZzZXRXaWR0aCkgPj0gKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsV2lkdGggKiAwLjk3NSkpIHtcbiAgICAgICAgLy8gICAgICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcImhpZGRlblwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gICAgIH0gZWxzZSB7XG4gICAgICAgIC8vICAgICAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAvKiogRU5EIFNDUk9MTCBOT1RJQ0UgKiovXG5cbiAgICAgICAgLy8gLy8gYWRkIGhvdmVyIGVmZmVjdHMgLSB1c2UgY2xhc3NlcyBcImhpZ2hsaWdodFwiIGFuZCBcImxvd2xpZ2h0XCJcbiAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy5iYXJjaGFydC1saW5lcyA+IHBhdGgsIGcuYmFyY2hhcnQtcG9pbnRzID4gcGF0aFwiKVxuICAgICAgICAvLyAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIHZhciBjbGFzc1RvSGlnaGxpZ2h0ID0gZDMuc2VsZWN0KHRoaXMpLmF0dHIoXCJkYXRhLWNsYXNzXCIpO1xuXG4gICAgICAgIC8vICAgICAvLyBsb3dsaWdodCBhbGwgZWxlbWVudHNcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcuYmFyY2hhcnQtbGluZXMgPiBwYXRoLCBnLmJhcmNoYXJ0LXBvaW50cyA+IHBhdGgsIGRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIC8vICAgICAvLyBoaWdobGlnaHQgYWxsIGVsZW1lbnRzIHdpdGggbWF0Y2hpbmcgZGF0YS1jbGFzc1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeS5cIitjbGFzc1RvSGlnaGxpZ2h0K1wiLCBnLmJhcmNoYXJ0LWxpbmVzID4gcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0K1wiLCBnLmJhcmNoYXJ0LXBvaW50cyBwYXRoLlwiK2NsYXNzVG9IaWdobGlnaHQpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogZmFsc2UsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IHRydWVcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgLy8gcmVtb3ZlIGFsbCBoaWdobGlnaHQvbG93bGlnaHQgY2xhc3Nlc1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy5iYXJjaGFydC1saW5lcyA+IHBhdGgsIGcuYmFyY2hhcnQtcG9pbnRzID4gcGF0aCwgZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiBmYWxzZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICBmdW5jdGlvbiBtYWtlTGVnZW5kKHNlbGVjdGlvbikge1xuICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgLy8gc2l6aW5nIGFuZCBtYXJnaW4gdmFyc1xuICAgICAgICAgICAgICAgIHZhciBCQm94ID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICBtYXJnaW4gPSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFwidG9wXCIgOiBkMy5tYXgoW0JCb3guaGVpZ2h0ICogMC4wOCwgMzJdKSxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIiA6IEJCb3guaGVpZ2h0ICogMC4wMSxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiIDogQkJveC53aWR0aCAqIDAuMDEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCIgOiBCQm94LmhlaWdodCAqIDAuMDEsXG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiIDogQkJveC53aWR0aCAqIDAuMDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoID0gQkJveC53aWR0aCAtIChtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBCQm94LmhlaWdodCAtIChtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSksXG5cbiAgICAgICAgICAgICAgICAvLyAvLyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgLy8gc3ZnID0gZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG5cbiAgICAgICAgICAgICAgICAvLyBjb2xvciBzY2FsZVxuICAgICAgICAgICAgICAgIGNvbG9ycyA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW1wiIzFFQUNGMVwiLCBcIiNCOTRBNDhcIl0pXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGVnZW5kRW50cmllcyA9IGQzLnNlbGVjdCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0QWxsKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwibGVnZW5kXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGVnZW5kR3JvdXBzID0gbGVnZW5kLnNlbGVjdEFsbChcImcuZW50cnlcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEobGVnZW5kRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRhdGEtY2xhc3NcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzbHVnZ2lmeShkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnRyeVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbHVnZ2lmeShkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gXCJ0cmFuc2xhdGUoMCwgXCIgKyAoMTkgKiBpKSArIFwiKVwiO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0dW0oZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSk7XG5cbiAgICAgICAgICAgICAgICBsZWdlbmRHcm91cHMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuQ291bnQgPSBsZWdlbmRHcm91cHMuc2VsZWN0QWxsKFwidHNwYW5cIikuc2l6ZSgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBcInRyYW5zbGF0ZSgwLCBcIiArICgxOSAqIGkpICsgKCh0c3BhbkNvdW50IC0gaSkgKiAxOSkgKyBcIilcIjt9KVxuXG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkge3JldHVybiBjb2xvcnMoZCk7IH0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkge3JldHVybiBjb2xvcnMoZCk7IH0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBkMy5zdmcuc3ltYm9sKCkudHlwZShmdW5jdGlvbihkKSB7cmV0dXJuIHN5bWJvbFNjYWxlKGQpOyB9KS5zaXplKDI1KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIiM0QTRBNEFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeFwiLCA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRzcGFucyhmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLndvcmR3cmFwKGQsIDIwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAvLyBhbGwgc3BhbnMgYXJlIGJ5IGRlZmF1bHQgdW5zdHlsZWQsIHdpdGggbm8gd2F5IHRvIGRvIGl0IGluIGpldHBhY2ssXG4gICAgICAgICAgICAgICAgLy8gc28gaW4gb3JkZXIgdG8gZmlnaHQgdGhlIGhhbmdpbmcgaW5kZW50IGVmZmVjdCwgbW92ZSB0aGVtIG92ZXIgOCBweFxuICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbChcInRzcGFuXCIpLmF0dHIoXCJkeFwiLCA4KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtYWtlYmFyY2hhcnRDaGFydChzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBzaXppbmcgYW5kIG1hcmdpbiB2YXJzXG4gICAgICAgICAgICAgICAgdmFyIEJCb3ggPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiIDogQkJveC5oZWlnaHQgKiAwLjA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiIDogQkJveC53aWR0aCAqIDAuMDUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiIDogQkJveC5oZWlnaHQgKiAwLjIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIiA6IGQzLm1heChbQkJveC53aWR0aCAqIDAuMDUsIDU1XSlcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBCQm94LndpZHRoIC0gKG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBCQm94LmhlaWdodCAtIChtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGFpbmVyc1xuICAgICAgICAgICAgICAgICAgICBzdmcgPSBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwic3ZnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBCQm94LmhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgQkJveC53aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIDApXCIpLFxuICAgICAgICAgICAgICAgICAgICBjaGFydCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIiksXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlc3Rpbmcgc3R1ZmYgLSBkcmF3cyBvdXRsaW5lcyBhcm91bmQgc3ZnIGFuZCBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gc3ZnT3V0bGluZSA9IHN2Zy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcImhlaWdodFwiLCBzdmcuYXR0cihcImhlaWdodFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwid2lkdGhcIiwgc3ZnLmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwicmVkXCIpLFxuICAgICAgICAgICAgICAgICAgICAvLyBjaGFydE91dGxpbmUgPSBzdmcuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGNoYXJ0LmF0dHIoXCJoZWlnaHRcIikpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcIndpZHRoXCIsIGNoYXJ0LmF0dHIoXCJ3aWR0aFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwwLDAsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIgLFwiYmx1ZVwiKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyB4IGFuZCB5IHNjYWxlc1xuICAgICAgICAgICAgICAgICAgICB4ID0gZDMuc2NhbGUub3JkaW5hbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2VSb3VuZEJhbmRzKFswLCB3aWR0aF0sIDAuMSwgMC4xKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihiYXJLZXlzKSxcbiAgICAgICAgICAgICAgICAgICAgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW2hlaWdodCwgMF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFswLCB5UmFuZ2VNYXhdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm5pY2UoMTApLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIC8vIGF4aXMgZnVuY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgIHhBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNjYWxlKHgpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JpZW50KFwiYm90dG9tXCIpLFxuICAgICAgICAgICAgICAgICAgICB5QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yaWVudChcImxlZnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbm5lclRpY2tTaXplKC13aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrUGFkZGluZygxMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrRm9ybWF0KGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KFwiZlwiKSh0KSArIFwiJVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gdGVzdCBvdXRwdXQgZm9yIHRyb3VibGVzaG9vdGluZyB0aGUgZGF0YSBzdHVmZlxuICAgICAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwicHJlXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSlcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIngtYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF4aXNcIiA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCBcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeEF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInktYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF4aXNcIiA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgtMTIsIDApXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh5QXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuc2VsZWN0QWxsKFwicmVjdC5iYXJjaGFydC1iYXJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yQ2xhc3MgPSBcImJhci1jb2xvci1cIiArICgoaSAlIDIpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXCJiYXJjaGFydC1iYXJcIiwgY29sb3JDbGFzc10uam9pbihcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHgucmFuZ2VCYW5kKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gaGVpZ2h0IC0geShkLlZhbHVlKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLkJhcik7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkoZC5WYWx1ZSk7IH0pXG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuc2VsZWN0QWxsKFwidGV4dC5iYXJjaGFydC12YWx1ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcImJhcmNoYXJ0LXZhbHVlXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KFwiZlwiKShkLlZhbHVlKSArIFwiJVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB4LnJhbmdlQmFuZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQuVmFsdWUpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLkJhcikgKyAoeC5yYW5nZUJhbmQoKS8yKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR5XCIsIC00KVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGJhckNoYXJ0U2VydmljZTtcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ0RhdGFWaXpDb250cm9sbGVyJyxcbiAgICAgICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnJGZpbHRlcicsICdzaWRlYmFyRGlzcGxheScsICdjYXRlZ29yaWVzJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9nLCAkbG9jYXRpb24sICRmaWx0ZXIsIHNpZGViYXJEaXNwbGF5LCBjYXRlZ29yaWVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gY2F0ZWdvcmllcy5nZXRDYXRlZ29yaWVzKFwiYWxsXCIpO1xuICAgICAgICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gY2F0ZWdvcmllcy5saXN0O1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWplY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzaWRlYmFyRGlzcGxheS5zZWN0aW9uID0gJ1JhdyBEYXRhJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdkYXRhdml6JywgWyckd2luZG93JywgJyRodHRwJywgJ3RpbWVzZXJpZXNTZXJ2aWNlJywgJ2dyb3VwZWRCYXJDaGFydFNlcnZpY2UnLCAnYmFyQ2hhcnRTZXJ2aWNlJywgJ3RhYmxlU2VydmljZScsIGZ1bmN0aW9uKCR3aW5kb3csICRodHRwLCB0aW1lc2VyaWVzU2VydmljZSwgZ3JvdXBlZEJhckNoYXJ0U2VydmljZSwgYmFyQ2hhcnRTZXJ2aWNlLCB0YWJsZVNlcnZpY2UpIHtcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHNob3VsZCByZWZsZWN0IHdoYXRldmVyIHlvdXIgZDMgZnVuY3Rpb24gaXMgY2FsbGVkLlxuICAgIHZhciBjaGFydHMgPSB7XG4gICAgICAgIFwibGluZVwiIDogdGltZXNlcmllc1NlcnZpY2UuY2hhcnQsXG4gICAgICAgIFwiYmFyXCIgOiBiYXJDaGFydFNlcnZpY2UuY2hhcnQsXG4gICAgICAgIFwiZ3JvdXBlZEJhclwiIDogZ3JvdXBlZEJhckNoYXJ0U2VydmljZS5jaGFydCxcbiAgICAgICAgXCJ0YWJsZVwiIDogdGFibGVTZXJ2aWNlLmNoYXJ0XG4gICAgfTtcbiAgICByZXR1cm4gIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHdoaWNoOiBcIj13aGljaFwiLFxuICAgICAgICAgICAgdHlwZTogXCI9dHlwZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjaGFydHNbc2NvcGUudHlwZV0oZWxlbWVudFswXSwgcmVzdWx0LmRhdGEsIHt9KTsgLy9zY29wZS5jb25maWdcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQoXCIvc3RhdGljL2Rpc3QvZGF0YS9jc3YvXCIgKyBzY29wZS53aGljaCArIFwiLmNzdlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGF0YSA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0c1tzY29wZS50eXBlXShlbGVtZW50WzBdLCBzY29wZS5kYXRhLCB7fSk7IC8vc2NvcGUuY29uZmlnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJ3doaWNoJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgVGhpcyBjb2RlIGlzIGludGVuZGVkIHRvIGdldCB0aGUgY2hhcnQgdG8gcmVkcmF3IHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgICAgQnV0IGFzIGl0IHN0YW5kcywgc29tZWhvdyB0aGlzIG92ZXJyaWRlcyB0aGUgZGF0YSBhbmQgdGhlIGNoYXJ0IGJlY29tZXMgdXNlbGVzcy5cbiAgICAgICAgICAgICAgICBJIGRvbid0IHRoaW5rIHRoaXMgZmVhdHVyZSBpcyB3b3J0aCB0aGUgZGVidWcgdGltZSBub3csIGJ1dCBpdCdzIHdvcnRoIGtlZXBpbmcgaW4gbWluZCBmb3IgdGhlIGZ1dHVyZS5cbiAgICAgICAgICAgICoqL1xuICAgICAgICAgICAgLy8gJHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gICAgIHNjb3BlLnJlbmRlcigpXG4gICAgICAgICAgICAvLyB9O1xuXG4gICAgICAgICAgICAvLyBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy8gICAgIHNjb3BlLnJlbmRlcihkYXRhKTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgIH1cbiAgICB9XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ2dyb3VwZWRCYXJDaGFydFNlcnZpY2UnLCBbJyRxJywgJyRodHRwJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRxLCAkaHR0cCwgbG9kYXNoKSB7XG4gICAgdmFyIGdyb3VwZWRCYXJDaGFydFNlcnZpY2UgPSB7fTtcblxuXG4gICAgLy92YXIgd2luZG93V2lkdGggPSBkMy5zZWxlY3QoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKVswXVswXTtcbiAgICAvLyAgICAgICAgICAgIGlmICh3aW5kb3dXaWR0aCA8IDk5Mikge1xuICAgIC8vICAgICAgICAgICAgICAgIHZhciBsaW5lSGVpZ2h0ID0gMC41NTtcbiAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICAgdmFyIGxpbmVIZWlnaHQgPSAxLjE7XG4gICAgLy8gICAgICAgICAgICB9XG5cblxuICAgIGdyb3VwZWRCYXJDaGFydFNlcnZpY2UuY2hhcnQgPSBmdW5jdGlvbihjb250YWluZXIsIGRhdGEsIGNvbmZpZykge1xuICAgICAgICB2YXIgdGltZUZvcm1hdHMgPSB7XG4gICAgICAgICAgICBcInllYXJcIiA6IFwiWVlZWVwiLFxuICAgICAgICAgICAgXCJxdWFydGVyXCIgOiBcIltRXVEgWVlZWVwiLFxuICAgICAgICAgICAgXCJtb250aFwiIDogXCJNTU0gWVlZWVwiXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uZmlnLmZhY2V0ID0gbG9kYXNoLmRpZmZlcmVuY2UoW1wic3RydWN0dXJlXCIsIFwidGltZVwiXSwgW2NvbmZpZy5mYWNldF0pWzBdXG5cbiAgICAgICAgLy8gY29udmVydCBkYXRhIGZyb20gc3RyaW5nIC0+IGFycmF5IG9mIG9ialxuICAgICAgICBkYXRhID0gZDMuY3N2LnBhcnNlKGRhdGEpO1xuXG4gICAgICAgIHZhciBncm91cEtleXMgPSBsb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuR3JvdXA7IH0pXG4gICAgICAgICAgICAgICAgLnVuaXF1ZSgpXG4gICAgICAgICAgICAgICAgLnZhbHVlKCksXG4gICAgICAgICAgICBiYXJLZXlzID1sb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuQmFyOyB9KVxuICAgICAgICAgICAgICAgIC51bmlxdWUoKVxuICAgICAgICAgICAgICAgIC52YWx1ZSgpXG4gICAgICAgICAgICB5UmFuZ2VNYXggPSBsb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuICtkLlZhbHVlOyB9KVxuICAgICAgICAgICAgICAgIC5tYXgoKVxuICAgICAgICAgICAgICAgIC52YWx1ZSgpO1xuXG4gICAgICAgIC8vIG5lc3QgZGF0YSBieSBiYXIgZ3JvdXBzXG4gICAgICAgIGRhdGEgPSBkMy5uZXN0KClcbiAgICAgICAgICAgIC5rZXkoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5Hcm91cDsgfSlcbiAgICAgICAgICAgIC5lbnRyaWVzKGRhdGEpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIG1hcHNcbiAgICAgICAgY2hhcnRDb250YWluZXIgPSBkMy5zZWxlY3QoY29udGFpbmVyKVxuICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwiZ3JvdXBlZGJhci1jb250YWluZXJcIiwgdHJ1ZSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcImdyb3VwZWRiYXItY29udGFpbmVyLWludGVybmFsXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgLmRhdHVtKGRhdGEpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIGxlZ2VuZHNcbiAgICAgICAgLy8gbGVnZW5kQ29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxlZ2VuZC1jb250YWluZXJcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgXCJncm91cGVkYmFyLWxlZ2VuZC1jb250YWluZXJcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICB9KTtcblxuICAgICAgICAvLyBjaGFydENvbnRhaW5lci5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KHlSYW5nZU1heCwgbnVsbCwgNCkpO1xuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoYmFyS2V5cywgbnVsbCwgNCkpO1xuICAgICAgICAgICAgLy8gLnRleHQoSlNPTi5zdHJpbmdpZnkoY29uZmlnLCBudWxsLCA0KSk7XG4gICAgICAgIC8vIHJldHVybjtcblxuICAgICAgICBtYWtlR3JvdXBlZEJhckNoYXJ0KGNoYXJ0Q29udGFpbmVyKTtcblxuICAgICAgICByZXR1cm47XG5cbiAgICAgICAgdmFyIGxlZ2VuZERpdiA9IGxlZ2VuZENvbnRhaW5lci5zZWxlY3RBbGwoXCJkaXYubGVnZW5kXCIpXG4gICAgICAgICAgICAuZGF0YShbYmFyS2V5c10pXG4gICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWdlbmRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJncm91cGVkYmFyLWxlZ2VuZFwiOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICBtYWtlTGVnZW5kKGxlZ2VuZERpdik7XG5cbiAgICAgICAgLy8gLyoqIFNUQVJUIFNDUk9MTCBOT1RJQ0UgKiovXG4gICAgICAgIC8vIC8vIGlmIHdlIGFyZSB1bmRlciBhIGNlcnRhaW4gcGl4ZWwgc2l6ZSwgdGhlcmUgd2lsbCBiZSBob3Jpem9udGFsIHNjcm9sbGluZ1xuICAgICAgICAvLyB2YXIgaW50ZXJuYWxDb250YWluZXJTaXplID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2Lmdyb3VwZWRiYXItY29udGFpbmVyLWludGVybmFsXCIpLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgLy8gICAgIGNvbnRhaW5lclNpemUgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYuZ3JvdXBlZGJhci1jb250YWluZXJcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIC8vIC8vIGNvbnNvbGUubG9nKGludGVybmFsQ29udGFpbmVyU2l6ZS53aWR0aCArIFwiIC8gXCIgKyBjb250YWluZXJTaXplLndpZHRoKVxuICAgICAgICAvLyBpZiAoaW50ZXJuYWxDb250YWluZXJTaXplLndpZHRoID4gY29udGFpbmVyU2l6ZS53aWR0aCkge1xuICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2coXCJzY3JvbGwgTm90aWNlIVwiKVxuICAgICAgICAvLyAgICAgLy8gY3JlYXRlIHNjcm9sbCBub3RpY2VcbiAgICAgICAgLy8gICAgIHZhciBzY3JvbGxOb3RpY2UgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYuZ3JvdXBlZGJhci1jb250YWluZXJcIikuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoXCJzY3JvbGwtbm90aWNlXCIsIHRydWUpXG4gICAgICAgIC8vICAgICAgICAgLmFwcGVuZChcInBcIik7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBcImZhXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwic3BhblwiKVxuICAgICAgICAvLyAgICAgICAgIC50ZXh0KFwiU2Nyb2xsIGZvciBtb3JlXCIpO1xuXG4gICAgICAgIC8vICAgICBzY3JvbGxOb3RpY2UuYXBwZW5kKFwiaVwiKVxuICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYVwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICAgICAgXCJmYS1hbmdsZS1kb3VibGUtZG93biBcIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICB9KTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIC8vIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5ncm91cGVkYmFyLWNvbnRhaW5lclwiKS5vbihcInNjcm9sbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gICAgIC8vIGlmIHNjcm9sbCBhdCBib3R0b20sIGhpZGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAvLyAgICAgLy8gdXNpbmcgYSBkaWZmZXJlbnQgY2xhc3Mgc28gYXMgbm90IHRvIGludGVyZmVyZSB3aXRoIHRoZSBtb3VzZW92ZXIgZWZmZWN0c1xuICAgICAgICAvLyAgICAgaWYgKChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbExlZnQgKyBkMy5zZWxlY3QodGhpcykubm9kZSgpLm9mZnNldFdpZHRoKSA+PSAoZDMuc2VsZWN0KHRoaXMpLm5vZGUoKS5zY3JvbGxXaWR0aCAqIDAuOTc1KSkge1xuICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwiaGlkZGVuXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gICAgICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcImhpZGRlblwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vIC8qKiBFTkQgU0NST0xMIE5PVElDRSAqKi9cblxuICAgICAgICAvLyAvLyBhZGQgaG92ZXIgZWZmZWN0cyAtIHVzZSBjbGFzc2VzIFwiaGlnaGxpZ2h0XCIgYW5kIFwibG93bGlnaHRcIlxuICAgICAgICAvLyBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLmdyb3VwZWRiYXItbGluZXMgPiBwYXRoLCBnLmdyb3VwZWRiYXItcG9pbnRzID4gcGF0aFwiKVxuICAgICAgICAvLyAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIHZhciBjbGFzc1RvSGlnaGxpZ2h0ID0gZDMuc2VsZWN0KHRoaXMpLmF0dHIoXCJkYXRhLWNsYXNzXCIpO1xuXG4gICAgICAgIC8vICAgICAvLyBsb3dsaWdodCBhbGwgZWxlbWVudHNcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcuZ3JvdXBlZGJhci1saW5lcyA+IHBhdGgsIGcuZ3JvdXBlZGJhci1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IGZhbHNlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAvLyAgICAgLy8gaGlnaGxpZ2h0IGFsbCBlbGVtZW50cyB3aXRoIG1hdGNoaW5nIGRhdGEtY2xhc3NcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnkuXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy5ncm91cGVkYmFyLWxpbmVzID4gcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0K1wiLCBnLmdyb3VwZWRiYXItcG9pbnRzIHBhdGguXCIrY2xhc3NUb0hpZ2hsaWdodClcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiBmYWxzZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICAvLyByZW1vdmUgYWxsIGhpZ2hsaWdodC9sb3dsaWdodCBjbGFzc2VzXG4gICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLmdyb3VwZWRiYXItbGluZXMgPiBwYXRoLCBnLmdyb3VwZWRiYXItcG9pbnRzID4gcGF0aCwgZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICBcImxvd2xpZ2h0XCIgOiBmYWxzZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICBmdW5jdGlvbiBtYWtlTGVnZW5kKHNlbGVjdGlvbikge1xuICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgLy8gc2l6aW5nIGFuZCBtYXJnaW4gdmFyc1xuICAgICAgICAgICAgICAgIHZhciBCQm94ID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICBtYXJnaW4gPSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFwidG9wXCIgOiBkMy5tYXgoW0JCb3guaGVpZ2h0ICogMC4wOCwgMzJdKSxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIiA6IEJCb3guaGVpZ2h0ICogMC4wMSxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiIDogQkJveC53aWR0aCAqIDAuMDEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCIgOiBCQm94LmhlaWdodCAqIDAuMDEsXG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiIDogQkJveC53aWR0aCAqIDAuMDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoID0gQkJveC53aWR0aCAtIChtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBCQm94LmhlaWdodCAtIChtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSksXG5cbiAgICAgICAgICAgICAgICAvLyAvLyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgLy8gc3ZnID0gZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG5cbiAgICAgICAgICAgICAgICAvLyBjb2xvciBzY2FsZVxuICAgICAgICAgICAgICAgIGNvbG9ycyA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoW1wiIzFFQUNGMVwiLCBcIiNCOTRBNDhcIl0pXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGVnZW5kRW50cmllcyA9IGQzLnNlbGVjdCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0QWxsKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwibGVnZW5kXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGVnZW5kR3JvdXBzID0gbGVnZW5kLnNlbGVjdEFsbChcImcuZW50cnlcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEobGVnZW5kRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRhdGEtY2xhc3NcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzbHVnZ2lmeShkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnRyeVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbHVnZ2lmeShkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gXCJ0cmFuc2xhdGUoMCwgXCIgKyAoMTkgKiBpKSArIFwiKVwiO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0dW0oZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSk7XG5cbiAgICAgICAgICAgICAgICBsZWdlbmRHcm91cHMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuQ291bnQgPSBsZWdlbmRHcm91cHMuc2VsZWN0QWxsKFwidHNwYW5cIikuc2l6ZSgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBcInRyYW5zbGF0ZSgwLCBcIiArICgxOSAqIGkpICsgKCh0c3BhbkNvdW50IC0gaSkgKiAxOSkgKyBcIilcIjt9KVxuXG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkge3JldHVybiBjb2xvcnMoZCk7IH0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZnVuY3Rpb24oZCwgaSkge3JldHVybiBjb2xvcnMoZCk7IH0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBkMy5zdmcuc3ltYm9sKCkudHlwZShmdW5jdGlvbihkKSB7cmV0dXJuIHN5bWJvbFNjYWxlKGQpOyB9KS5zaXplKDI1KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIiM0QTRBNEFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCA2KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeFwiLCA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRzcGFucyhmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLndvcmR3cmFwKGQsIDIwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAvLyBhbGwgc3BhbnMgYXJlIGJ5IGRlZmF1bHQgdW5zdHlsZWQsIHdpdGggbm8gd2F5IHRvIGRvIGl0IGluIGpldHBhY2ssXG4gICAgICAgICAgICAgICAgLy8gc28gaW4gb3JkZXIgdG8gZmlnaHQgdGhlIGhhbmdpbmcgaW5kZW50IGVmZmVjdCwgbW92ZSB0aGVtIG92ZXIgOCBweFxuICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbChcInRzcGFuXCIpLmF0dHIoXCJkeFwiLCA4KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtYWtlR3JvdXBlZEJhckNoYXJ0KHNlbGVjdGlvbikge1xuICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIHNpemluZyBhbmQgbWFyZ2luIHZhcnNcbiAgICAgICAgICAgICAgICB2YXIgQkJveCA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCIgOiBCQm94LmhlaWdodCAqIDAuMDUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCIgOiBCQm94LndpZHRoICogMC4wNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCIgOiBCQm94LmhlaWdodCAqIDAuMixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGVmdFwiIDogZDMubWF4KFtCQm94LndpZHRoICogMC4wNSwgNTVdKVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IEJCb3gud2lkdGggLSAobWFyZ2luLmxlZnQgKyBtYXJnaW4ucmlnaHQpXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IEJCb3guaGVpZ2h0IC0gKG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgICAgIHN2ZyA9IGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIEJCb3guaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBCQm94LndpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwgMClcIiksXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0ID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGVzdGluZyBzdHVmZiAtIGRyYXdzIG91dGxpbmVzIGFyb3VuZCBzdmcgYW5kIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICAvLyBzdmdPdXRsaW5lID0gc3ZnLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHN2Zy5hdHRyKFwiaGVpZ2h0XCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ3aWR0aFwiLCBzdmcuYXR0cihcIndpZHRoXCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmdiYSgwLDAsMCwwKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCJyZWRcIiksXG4gICAgICAgICAgICAgICAgICAgIC8vIGNoYXJ0T3V0bGluZSA9IHN2Zy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJoZWlnaHRcIiwgY2hhcnQuYXR0cihcImhlaWdodFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwid2lkdGhcIiwgY2hhcnQuYXR0cihcIndpZHRoXCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmdiYSgwLDAsMCwwKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJzdHJva2VcIiAsXCJibHVlXCIpLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbG9yIHNjYWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbG9ycyA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtcImJhci1jb2xvci0xXCIsIFwiYmFyLWNvbG9yLTJcIiwgXCJiYXItY29sb3ItM1wiLCBcImJhci1jb2xvci00XCJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXJLZXlzXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHggYW5kIHkgc2NhbGVzXG4gICAgICAgICAgICAgICAgICAgIHgwID0gZDMuc2NhbGUub3JkaW5hbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2VSb3VuZEJhbmRzKFswLCB3aWR0aF0sIDAuMiwgMC4yKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihncm91cEtleXMpLFxuICAgICAgICAgICAgICAgICAgICB4MSA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlUm91bmRCYW5kcyhbMCwgeDAucmFuZ2VCYW5kKCldLCAwLjEsIDApXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKGJhcktleXMpLFxuICAgICAgICAgICAgICAgICAgICB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHlSYW5nZU1heF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAubmljZSg1KSxcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyBheGlzIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICAgICAgICB4MEF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGUoeDApXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JpZW50KFwiYm90dG9tXCIpLFxuICAgICAgICAgICAgICAgICAgICB4MUF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGUoeDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JpZW50KFwiYm90dG9tXCIpLFxuICAgICAgICAgICAgICAgICAgICB5QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yaWVudChcImxlZnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbm5lclRpY2tTaXplKC13aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrUGFkZGluZygxMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrRm9ybWF0KGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KFwiZlwiKSh0KSArIFwiJVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gdGVzdCBvdXRwdXQgZm9yIHRyb3VibGVzaG9vdGluZyB0aGUgZGF0YSBzdHVmZlxuICAgICAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwicHJlXCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAudGV4dChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCA0KSlcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB4MEF4aXNHcm91cCA9IGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIngtYXhpc1wiIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF4aXNcIiA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCBcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeDBBeGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBjaGFydC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ5LWF4aXNcIiA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJheGlzXCIgOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoLTEyLCAwKVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoeUF4aXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIG1ha2UgYmFyIGdyb3Vwc1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXJHcm91cHMgPSBjaGFydC5zZWxlY3RBbGwoXCJnLmdyb3VwZWRiYXItZ3JvdXBcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcImdyb3VwZWRiYXItZ3JvdXBcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHgwLnJhbmdlQmFuZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIHgwKGQua2V5KSArIFwiLCAwKVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdHVtKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudmFsdWVzOyB9KVxuXG4gICAgICAgICAgICAgICAgICAgIGJhckdyb3Vwcy5lYWNoKGZ1bmN0aW9uKGdyb3VwRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHNvbWUgZ3JvdXAtc3BlY2lmaWMgdmFycyBzZXQgdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzR3JvdXBCYXJzID0gbG9kYXNoLmNoYWluKGdyb3VwRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkJhcjsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpdGhvdXQoXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0dyb3VwTGFiZWxzID0gbG9kYXNoLmNoYWluKGdyb3VwRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkxhYmVsOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2l0aG91dChcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsdWUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzR3JvdXBYMSA9IHgxLmNvcHkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKHRoaXNHcm91cEJhcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0dyb3VwTGFiZWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3ZlIHgwLWF4aXMgZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgwQXhpc0dyb3VwLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwgXCIgKyAoaGVpZ2h0ICsgKG1hcmdpbi5ib3R0b20vMikpICsgXCIpXCIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAvLyAvLyBVc2luZyB4MSBheGlzIHRvIGxhYmVsIGluZGl2aWR1YWwgYmFyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwieC1heGlzXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgXCJheGlzXCIgOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIFwiICsgaGVpZ2h0ICsgXCIpXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5jYWxsKHgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnNlbGVjdEFsbChcInJlY3QuZ3JvdXBkYmFyLWJhclwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGdyb3VwRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtcImdyb3VwZWRiYXItYmFyXCIsIGNvbG9ycyhkLkJhcildLmpvaW4oXCIgXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHRoaXNHcm91cFgxLnJhbmdlQmFuZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBoZWlnaHQgLSB5KGQuVmFsdWUpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gdGhpc0dyb3VwWDEoZC5CYXIpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geShkLlZhbHVlKTsgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLnNlbGVjdEFsbChcInRleHQuZ3JvdXBkYmFyLXZhbHVlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoZ3JvdXBEYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwiZ3JvdXBkYmFyLXZhbHVlXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5mb3JtYXQoXCIwLjFmXCIpKGQuVmFsdWUpICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgdGhpc0dyb3VwWDEucmFuZ2VCYW5kKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQuVmFsdWUpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB0aGlzR3JvdXBYMShkLkJhcikgKyAodGhpc0dyb3VwWDEucmFuZ2VCYW5kKCkvMik7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgLTQpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzaW5nIHRleHQgdG8gbGFiZWwgaW5kaXZpZHVhbCBiYXJzXG4gICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuc2VsZWN0QWxsKFwidGV4dC5ncm91cGRiYXItbGFiZWxcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShncm91cERhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJncm91cGRiYXItbGFiZWxcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5MYWJlbDsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB4MS5yYW5nZUJhbmQoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogVkFSSUFUSU9OUyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5kZXIgYmFycywgbWlkZGxlIGFsaWduZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geDEoZC5CYXIpICsgKHgxLnJhbmdlQmFuZCgpLzIpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR5XCIsIDE2KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5zaWRlIGJhcnMsIHJvdGF0ZWQgcmlnaHQgOTAgZGVnLCBhdCByaWdodCBzaWRlIG9mIGJhciB3aXRoIHggYW5kIHkgcGFkZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSgtOTApXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCAtaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR4XCIsIDQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJzdGFydFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geDEoZC5CYXIpICsgeDEucmFuZ2VCYW5kKCk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgLTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ3JvdXBlZEJhckNoYXJ0U2VydmljZTtcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdzaW1wbGV0YWJsZScsIGZ1bmN0aW9uKCkge1xuICAgIC8vIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHJlZmxlY3Qgd2hhdGV2ZXIgeW91ciBkMyB0YWJsZSBmdW5jdGlvbiBpcyBjYWxsZWQuXG4gICAgdmFyIGNoYXJ0ID0gdGFibGVDaGFydCgpO1xuICAgIHJldHVybiAge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgZGF0YTogXCI9ZGF0YVwiIC8vIFdlIGNhbiBjYWxsIHRoaXMgdy9lIHdlIHdhbnQuXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignZGF0YScsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuc2VydmljZSgndGFibGVTZXJ2aWNlJywgWyckcScsICckaHR0cCcsICdsb2Rhc2gnLCBmdW5jdGlvbiAoJHEsICRodHRwLCBsb2Rhc2gpIHtcbiAgICAgICAgdmFyIHRhYmxlU2VydmljZSA9IHt9O1xuXG4gICAgICAgIHRhYmxlU2VydmljZS5jaGFydCA9IGZ1bmN0aW9uIChjb250YWluZXIsIGRhdGEsIGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmZhY2V0ID0gbG9kYXNoLmRpZmZlcmVuY2UoW1wic3RydWN0dXJlXCIsIFwidGltZVwiXSwgW2NvbmZpZy5mYWNldF0pWzBdXG5cbiAgICAgICAgICAgIC8vIGNvbnZlcnQgZGF0YSBmcm9tIHN0cmluZyAtPiBhcnJheSBvZiBvYmpcbiAgICAgICAgICAgIGRhdGEgPSBkMy5jc3YucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgLy8gdmFyIGdyb3VwS2V5cyA9IGxvZGFzaC5jaGFpbihkYXRhKVxuICAgICAgICAgICAgLy8gICAgICAgICAubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuR3JvdXA7IH0pXG4gICAgICAgICAgICAvLyAgICAgICAgIC51bmlxdWUoKVxuICAgICAgICAgICAgLy8gICAgICAgICAudmFsdWUoKSxcbiAgICAgICAgICAgIC8vICAgICBiYXJLZXlzID1sb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgICAgIC8vICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7IHJldHVybiBkLkJhcjsgfSlcbiAgICAgICAgICAgIC8vICAgICAgICAgLnVuaXF1ZSgpXG4gICAgICAgICAgICAvLyAgICAgICAgIC52YWx1ZSgpXG4gICAgICAgICAgICAvLyAgICAgeVJhbmdlTWF4ID0gbG9kYXNoLmNoYWluKGRhdGEpXG4gICAgICAgICAgICAvLyAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gK2QuVmFsdWU7IH0pXG4gICAgICAgICAgICAvLyAgICAgICAgIC5tYXgoKVxuICAgICAgICAgICAgLy8gICAgICAgICAudmFsdWUoKTtcblxuXG4gICAgICAgICAgICB2YXIgY29sdW1ucyA9IFtdO1xuICAgICAgICAgICAgZm9yIChrIGluIGRhdGFbMF0pIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2goayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIG1hcHNcbiAgICAgICAgICAgIGNoYXJ0Q29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgICAgICAgICAvLy5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAvLy5jbGFzc2VkKFwidGFibGUtY29udGFpbmVyXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwidGFibGUtY29udGFpbmVyLWludGVybmFsXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgLmRhdHVtKGRhdGEpO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGZvciBsZWdlbmRzXG4gICAgICAgICAgICAvLyBsZWdlbmRDb250YWluZXIgPSBkMy5zZWxlY3QoY29udGFpbmVyKVxuICAgICAgICAgICAgLy8gICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAvLyAgICAgICAgIFwibGVnZW5kLWNvbnRhaW5lclwiIDogdHJ1ZSxcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJ0YWJsZS1sZWdlbmQtY29udGFpbmVyXCIgOiB0cnVlLFxuICAgICAgICAgICAgLy8gICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBjaGFydENvbnRhaW5lci5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGNvbHVtbnMsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIHJldHVybjtcblxuICAgICAgICAgICAgbWFrZVRhYmxlKGNoYXJ0Q29udGFpbmVyKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAvL3ZhciBsZWdlbmREaXYgPSBsZWdlbmRDb250YWluZXIuc2VsZWN0QWxsKFwiZGl2LmxlZ2VuZFwiKVxuICAgICAgICAgICAgLy8gICAgLmRhdGEoW2JhcktleXNdKVxuICAgICAgICAgICAgLy8gICAgLmVudGVyKClcbiAgICAgICAgICAgIC8vICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgIC8vICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgIFwibGVnZW5kXCI6IHRydWUsXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIFwidGFibGUtbGVnZW5kXCI6IHRydWVcbiAgICAgICAgICAgIC8vICAgICAgICB9KVxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vbWFrZUxlZ2VuZChsZWdlbmREaXYpO1xuXG5cbiAgICAgICAgICAgIC8vIC8qKiBTVEFSVCBTQ1JPTEwgTk9USUNFICoqL1xuICAgICAgICAgICAgLy8gLy8gaWYgd2UgYXJlIHVuZGVyIGEgY2VydGFpbiBwaXhlbCBzaXplLCB0aGVyZSB3aWxsIGJlIGhvcml6b250YWwgc2Nyb2xsaW5nXG4gICAgICAgICAgICAvLyB2YXIgaW50ZXJuYWxDb250YWluZXJTaXplID0gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0KFwiZGl2LnRhYmxlLWNvbnRhaW5lci1pbnRlcm5hbFwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAvLyAgICAgY29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50YWJsZS1jb250YWluZXJcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgICAgICAvLyAvLyBjb25zb2xlLmxvZyhpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggKyBcIiAvIFwiICsgY29udGFpbmVyU2l6ZS53aWR0aClcbiAgICAgICAgICAgIC8vIGlmIChpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggPiBjb250YWluZXJTaXplLndpZHRoKSB7XG4gICAgICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2coXCJzY3JvbGwgTm90aWNlIVwiKVxuICAgICAgICAgICAgLy8gICAgIC8vIGNyZWF0ZSBzY3JvbGwgbm90aWNlXG4gICAgICAgICAgICAvLyAgICAgdmFyIHNjcm9sbE5vdGljZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50YWJsZS1jb250YWluZXJcIikuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKFwic2Nyb2xsLW5vdGljZVwiLCB0cnVlKVxuICAgICAgICAgICAgLy8gICAgICAgICAuYXBwZW5kKFwicFwiKTtcblxuICAgICAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgICAgICAvLyAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAgICAgLy8gICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgICAgICAvLyAgICAgICAgIC50ZXh0KFwiU2Nyb2xsIGZvciBtb3JlXCIpO1xuXG4gICAgICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgXCJmYVwiIDogdHJ1ZSxcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAvLyBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJkaXYudGFibGUtY29udGFpbmVyXCIpLm9uKFwic2Nyb2xsXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gICAgIC8vIGlmIHNjcm9sbCBhdCBib3R0b20sIGhpZGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAgICAgLy8gICAgIC8vIHVzaW5nIGEgZGlmZmVyZW50IGNsYXNzIHNvIGFzIG5vdCB0byBpbnRlcmZlcmUgd2l0aCB0aGUgbW91c2VvdmVyIGVmZmVjdHNcbiAgICAgICAgICAgIC8vICAgICBpZiAoKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsTGVmdCArIGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkub2Zmc2V0V2lkdGgpID49IChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbFdpZHRoICogMC45NzUpKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IHRydWVcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IGZhbHNlXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICAgICAgLy8gLyoqIEVORCBTQ1JPTEwgTk9USUNFICoqL1xuXG4gICAgICAgICAgICAvLyAvLyBhZGQgaG92ZXIgZWZmZWN0cyAtIHVzZSBjbGFzc2VzIFwiaGlnaGxpZ2h0XCIgYW5kIFwibG93bGlnaHRcIlxuICAgICAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy50YWJsZS1saW5lcyA+IHBhdGgsIGcudGFibGUtcG9pbnRzID4gcGF0aFwiKVxuICAgICAgICAgICAgLy8gLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvLyAgICAgdmFyIGNsYXNzVG9IaWdobGlnaHQgPSBkMy5zZWxlY3QodGhpcykuYXR0cihcImRhdGEtY2xhc3NcIik7XG5cbiAgICAgICAgICAgIC8vICAgICAvLyBsb3dsaWdodCBhbGwgZWxlbWVudHNcbiAgICAgICAgICAgIC8vICAgICBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3RBbGwoXCJnLmVudHJ5LCBnLnRhYmxlLWxpbmVzID4gcGF0aCwgZy50YWJsZS1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogdHJ1ZSxcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJoaWdobGlnaHRcIiA6IGZhbHNlXG4gICAgICAgICAgICAvLyAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vICAgICAvLyBoaWdobGlnaHQgYWxsIGVsZW1lbnRzIHdpdGggbWF0Y2hpbmcgZGF0YS1jbGFzc1xuICAgICAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnkuXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy50YWJsZS1saW5lcyA+IHBhdGguXCIrY2xhc3NUb0hpZ2hsaWdodCtcIiwgZy50YWJsZS1wb2ludHMgcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0KVxuICAgICAgICAgICAgLy8gICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogZmFsc2UsXG4gICAgICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiB0cnVlXG4gICAgICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICAgICAgLy8gLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vICAgICAvLyByZW1vdmUgYWxsIGhpZ2hsaWdodC9sb3dsaWdodCBjbGFzc2VzXG4gICAgICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy50YWJsZS1saW5lcyA+IHBhdGgsIGcudGFibGUtcG9pbnRzID4gcGF0aCwgZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBtYWtlVGFibGUoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGFpbmVyc1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwidGFibGVcIikuYXR0cihcImNsYXNzXCIsIFwiY3RkYXRhLXRhYmxlXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhlYWQgPSB0YWJsZS5hcHBlbmQoXCJ0aGVhZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRib2R5ID0gdGFibGUuYXBwZW5kKFwidGJvZHlcIik7XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyB0ZXN0IG91dHB1dCBmb3IgdHJvdWJsZXNob290aW5nIHRoZSBkYXRhIHN0dWZmXG4gICAgICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKVxuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgIHRoZWFkLmFwcGVuZChcInRyXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0QWxsKFwidGhcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGNvbHVtbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInRoXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZD09PSdJbmRpY2F0b3InKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnaGlkZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdjb2wtbmFtZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBidWlsZCByb3dzXG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dzID0gdGJvZHkuc2VsZWN0QWxsKFwidHJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJ0clwiKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBmaWxsIGluIGNlbGxzXG4gICAgICAgICAgICAgICAgICAgIHZhciBjZWxscyA9IHJvd3Muc2VsZWN0QWxsKCd0ZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGF0YShmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbHVtbnMubWFwKGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtjb2x1bW46IGNvbHVtbiwgdmFsdWU6IHJvd1tjb2x1bW5dfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgndGQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuY29sdW1uPT09J0luZGljYXRvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwibmFtZVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInZhbHVlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0YWJsZVNlcnZpY2U7XG4gICAgfV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCd0aW1lc2VyaWVzU2VydmljZScsIFsnJHEnLCAnJGh0dHAnLCAnbG9kYXNoJywgZnVuY3Rpb24oJHEsICRodHRwLCBsb2Rhc2gpIHtcbiAgICB2YXIgdGltZXNlcmllc1NlcnZpY2UgPSB7fTtcblxuICAgIHRpbWVzZXJpZXNTZXJ2aWNlLmNoYXJ0ID0gZnVuY3Rpb24oY29udGFpbmVyLCBkYXRhLCBjb25maWcpIHtcbiAgICAgICAgdmFyIHRpbWVGb3JtYXRzID0ge1xuICAgICAgICAgICAgXCJ5ZWFyXCIgOiBcIllZWVlcIixcbiAgICAgICAgICAgIFwicXVhcnRlclwiIDogXCJbUV1RIFlZWVlcIixcbiAgICAgICAgICAgIFwibW9udGhcIiA6IFwiTU1NIFlZWVlcIlxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbmZpZy5mYWNldCA9IGxvZGFzaC5kaWZmZXJlbmNlKFtcInN0cnVjdHVyZVwiLCBcInRpbWVcIl0sIFtjb25maWcuZmFjZXRdKVswXVxuXG4gICAgICAgIC8vIGNvbnZlcnQgZGF0YSBmcm9tIHN0cmluZyAtPiBhcnJheSBvZiBvYmpcbiAgICAgICAgZGF0YSA9IGQzLmNzdi5wYXJzZShkYXRhKTtcblxuICAgICAgICAvLyBrZXlzIGZvciBjb2xvciBhbmQgc2hhcGUgc2NhbGVzXG4gICAgICAgIHZhciBsaW5lS2V5cyA9IGxvZGFzaC5jaGFpbihkYXRhWzBdKVxuICAgICAgICAgICAgLmtleXMoKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihrKSB7IHJldHVybiBrICE9PSBcIlllYXJcIjsgfSlcbiAgICAgICAgICAgIC52YWx1ZSgpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIG1hcHNcbiAgICAgICAgY2hhcnRDb250YWluZXIgPSBkMy5zZWxlY3QoY29udGFpbmVyKVxuICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwidGltZXNlcmllcy1jb250YWluZXJcIiwgdHJ1ZSlcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtY29udGFpbmVyLWludGVybmFsXCIsIHRydWUpXG4gICAgICAgICAgICAgICAgLmRhdHVtKGRhdGEpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBjb250YWluZXIgZm9yIGxlZ2VuZHNcbiAgICAgICAgbGVnZW5kQ29udGFpbmVyID0gZDMuc2VsZWN0KGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgICAgICAgICBcImxlZ2VuZC1jb250YWluZXJcIiA6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJ0aW1lc2VyaWVzLWxlZ2VuZC1jb250YWluZXJcIiA6IHRydWUsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBjaGFydENvbnRhaW5lci5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKTtcbiAgICAgICAgICAgIC8vIC50ZXh0KEpTT04uc3RyaW5naWZ5KGNvbmZpZywgbnVsbCwgNCkpO1xuICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgbWFrZVRpbWVTZXJpZXMoY2hhcnRDb250YWluZXIpO1xuXG4gICAgICAgIHZhciBsZWdlbmREaXYgPSBsZWdlbmRDb250YWluZXIuc2VsZWN0QWxsKFwiZGl2LmxlZ2VuZFwiKVxuICAgICAgICAgICAgLmRhdGEoW2xpbmVLZXlzXSlcbiAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICBcImxlZ2VuZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcInRpbWVzZXJpZXMtbGVnZW5kXCI6IHRydWVcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgIG1ha2VMZWdlbmQobGVnZW5kRGl2KTtcblxuICAgICAgICAvLyAvKiogU1RBUlQgU0NST0xMIE5PVElDRSAqKi9cbiAgICAgICAgLy8gLy8gaWYgd2UgYXJlIHVuZGVyIGEgY2VydGFpbiBwaXhlbCBzaXplLCB0aGVyZSB3aWxsIGJlIGhvcml6b250YWwgc2Nyb2xsaW5nXG4gICAgICAgIC8vIHZhciBpbnRlcm5hbENvbnRhaW5lclNpemUgPSBkMy5zZWxlY3QoY29udGFpbmVyKS5zZWxlY3QoXCJkaXYudGltZXNlcmllcy1jb250YWluZXItaW50ZXJuYWxcIikubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAvLyAgICAgY29udGFpbmVyU2l6ZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50aW1lc2VyaWVzLWNvbnRhaW5lclwiKS5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgLy8gLy8gY29uc29sZS5sb2coaW50ZXJuYWxDb250YWluZXJTaXplLndpZHRoICsgXCIgLyBcIiArIGNvbnRhaW5lclNpemUud2lkdGgpXG4gICAgICAgIC8vIGlmIChpbnRlcm5hbENvbnRhaW5lclNpemUud2lkdGggPiBjb250YWluZXJTaXplLndpZHRoKSB7XG4gICAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhcInNjcm9sbCBOb3RpY2UhXCIpXG4gICAgICAgIC8vICAgICAvLyBjcmVhdGUgc2Nyb2xsIG5vdGljZVxuICAgICAgICAvLyAgICAgdmFyIHNjcm9sbE5vdGljZSA9IGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdChcImRpdi50aW1lc2VyaWVzLWNvbnRhaW5lclwiKS5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZChcInNjcm9sbC1ub3RpY2VcIiwgdHJ1ZSlcbiAgICAgICAgLy8gICAgICAgICAuYXBwZW5kKFwicFwiKTtcblxuICAgICAgICAvLyAgICAgc2Nyb2xsTm90aWNlLmFwcGVuZChcImlcIilcbiAgICAgICAgLy8gICAgICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmFcIiA6IHRydWUsXG4gICAgICAgIC8vICAgICAgICAgICAgIFwiZmEtYW5nbGUtZG91YmxlLWRvd24gXCIgOiB0cnVlXG4gICAgICAgIC8vICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJzcGFuXCIpXG4gICAgICAgIC8vICAgICAgICAgLnRleHQoXCJTY3JvbGwgZm9yIG1vcmVcIik7XG5cbiAgICAgICAgLy8gICAgIHNjcm9sbE5vdGljZS5hcHBlbmQoXCJpXCIpXG4gICAgICAgIC8vICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBcImZhXCIgOiB0cnVlLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZhLWFuZ2xlLWRvdWJsZS1kb3duIFwiIDogdHJ1ZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgLy8gZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnRpbWVzZXJpZXMtY29udGFpbmVyXCIpLm9uKFwic2Nyb2xsXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgLy8gaWYgc2Nyb2xsIGF0IGJvdHRvbSwgaGlkZSBzY3JvbGwgbm90aWNlXG4gICAgICAgIC8vICAgICAvLyB1c2luZyBhIGRpZmZlcmVudCBjbGFzcyBzbyBhcyBub3QgdG8gaW50ZXJmZXJlIHdpdGggdGhlIG1vdXNlb3ZlciBlZmZlY3RzXG4gICAgICAgIC8vICAgICBpZiAoKGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkuc2Nyb2xsTGVmdCArIGQzLnNlbGVjdCh0aGlzKS5ub2RlKCkub2Zmc2V0V2lkdGgpID49IChkMy5zZWxlY3QodGhpcykubm9kZSgpLnNjcm9sbFdpZHRoICogMC45NzUpKSB7XG4gICAgICAgIC8vICAgICAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZGl2LnNjcm9sbC1ub3RpY2VcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJoaWRkZW5cIiA6IHRydWVcbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5jbGFzc2VkKHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwiaGlkZGVuXCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLyoqIEVORCBTQ1JPTEwgTk9USUNFICoqL1xuXG4gICAgICAgIC8vIC8vIGFkZCBob3ZlciBlZmZlY3RzIC0gdXNlIGNsYXNzZXMgXCJoaWdobGlnaHRcIiBhbmQgXCJsb3dsaWdodFwiXG4gICAgICAgIC8vIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcudGltZXNlcmllcy1saW5lcyA+IHBhdGgsIGcudGltZXNlcmllcy1wb2ludHMgPiBwYXRoXCIpXG4gICAgICAgIC8vIC5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgdmFyIGNsYXNzVG9IaWdobGlnaHQgPSBkMy5zZWxlY3QodGhpcykuYXR0cihcImRhdGEtY2xhc3NcIik7XG5cbiAgICAgICAgLy8gICAgIC8vIGxvd2xpZ2h0IGFsbCBlbGVtZW50c1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeSwgZy50aW1lc2VyaWVzLWxpbmVzID4gcGF0aCwgZy50aW1lc2VyaWVzLXBvaW50cyA+IHBhdGgsIGRpdi5zY3JvbGwtbm90aWNlXCIpXG4gICAgICAgIC8vICAgICAuY2xhc3NlZCh7XG4gICAgICAgIC8vICAgICAgICAgXCJsb3dsaWdodFwiIDogdHJ1ZSxcbiAgICAgICAgLy8gICAgICAgICBcImhpZ2hsaWdodFwiIDogZmFsc2VcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIC8vICAgICAvLyBoaWdobGlnaHQgYWxsIGVsZW1lbnRzIHdpdGggbWF0Y2hpbmcgZGF0YS1jbGFzc1xuICAgICAgICAvLyAgICAgZDMuc2VsZWN0KGNvbnRhaW5lcikuc2VsZWN0QWxsKFwiZy5lbnRyeS5cIitjbGFzc1RvSGlnaGxpZ2h0K1wiLCBnLnRpbWVzZXJpZXMtbGluZXMgPiBwYXRoLlwiK2NsYXNzVG9IaWdobGlnaHQrXCIsIGcudGltZXNlcmllcy1wb2ludHMgcGF0aC5cIitjbGFzc1RvSGlnaGxpZ2h0KVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiB0cnVlXG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSlcbiAgICAgICAgLy8gLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIC8vIHJlbW92ZSBhbGwgaGlnaGxpZ2h0L2xvd2xpZ2h0IGNsYXNzZXNcbiAgICAgICAgLy8gICAgIGQzLnNlbGVjdChjb250YWluZXIpLnNlbGVjdEFsbChcImcuZW50cnksIGcudGltZXNlcmllcy1saW5lcyA+IHBhdGgsIGcudGltZXNlcmllcy1wb2ludHMgPiBwYXRoLCBkaXYuc2Nyb2xsLW5vdGljZVwiKVxuICAgICAgICAvLyAgICAgLmNsYXNzZWQoe1xuICAgICAgICAvLyAgICAgICAgIFwibG93bGlnaHRcIiA6IGZhbHNlLFxuICAgICAgICAvLyAgICAgICAgIFwiaGlnaGxpZ2h0XCIgOiBmYWxzZVxuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VMZWdlbmQoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBzZWxlY3Rpb24uZWFjaChmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBzaXppbmcgYW5kIG1hcmdpbiB2YXJzXG4gICAgICAgICAgICAgICAgdmFyIEJCb3ggPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgIG1hcmdpbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gXCJ0b3BcIiA6IGQzLm1heChbQkJveC5oZWlnaHQgKiAwLjA4LCAzMl0pLFxuICAgICAgICAgICAgICAgICAgICBcInRvcFwiIDogQkJveC5oZWlnaHQgKiAwLjAxLFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCIgOiBCQm94LndpZHRoICogMC4wMSxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIiA6IEJCb3guaGVpZ2h0ICogMC4wMSxcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCIgOiBCQm94LndpZHRoICogMC4wMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgd2lkdGggPSBCQm94LndpZHRoIC0gKG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAgICAgICAgIGhlaWdodCA9IEJCb3guaGVpZ2h0IC0gKG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKSxcblxuICAgICAgICAgICAgICAgIC8vIC8vIGNvbnRhaW5lcnNcbiAgICAgICAgICAgICAgICAvLyBzdmcgPSBkMy5zZWxlY3QodGhpcylcbiAgICAgICAgICAgICAgICAvLyAgICAgLmFwcGVuZChcInN2Z1wiKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcblxuICAgICAgICAgICAgICAgIC8vIGNvbG9yIHNjYWxlXG4gICAgICAgICAgICAgICAgY29sb3JzID0gZDMuc2NhbGUub3JkaW5hbCgpXG4gICAgICAgICAgICAgICAgICAgIC5yYW5nZShbXCIjMUVBQ0YxXCIsIFwiI0I5NEE0OFwiXSlcbiAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihkYXRhKTtcblxuICAgICAgICAgICAgICAgIHZhciBsZWdlbmRFbnRyaWVzID0gZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgIC5zZWxlY3RBbGwoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInN2Z1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJsZWdlbmRcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBsZWdlbmRHcm91cHMgPSBsZWdlbmQuc2VsZWN0QWxsKFwiZy5lbnRyeVwiKVxuICAgICAgICAgICAgICAgICAgICAuZGF0YShsZWdlbmREYXRhKVxuICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZGF0YS1jbGFzc1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNsdWdnaWZ5KGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVudHJ5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsdWdnaWZ5KGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3NlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBcInRyYW5zbGF0ZSgwLCBcIiArICgxOSAqIGkpICsgXCIpXCI7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXR1bShmdW5jdGlvbihkKSB7IHJldHVybiBkOyB9KTtcblxuICAgICAgICAgICAgICAgIGxlZ2VuZEdyb3Vwcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHNwYW5Db3VudCA9IGxlZ2VuZEdyb3Vwcy5zZWxlY3RBbGwoXCJ0c3BhblwiKS5zaXplKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIFwidHJhbnNsYXRlKDAsIFwiICsgKDE5ICogaSkgKyAoKHRzcGFuQ291bnQgLSBpKSAqIDE5KSArIFwiKVwiO30pXG5cbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBmdW5jdGlvbihkLCBpKSB7cmV0dXJuIGNvbG9ycyhkKTsgfSApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbihkLCBpKSB7cmV0dXJuIGNvbG9ycyhkKTsgfSApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN2Zy5zeW1ib2woKS50eXBlKGZ1bmN0aW9uKGQpIHtyZXR1cm4gc3ltYm9sU2NhbGUoZCk7IH0pLnNpemUoMjUpKTtcblxuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcykuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwiIzRBNEE0QVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIDYpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImR4XCIsIDgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudHNwYW5zKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMud29yZHdyYXAoZCwgMjApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC8vIGFsbCBzcGFucyBhcmUgYnkgZGVmYXVsdCB1bnN0eWxlZCwgd2l0aCBubyB3YXkgdG8gZG8gaXQgaW4gamV0cGFjayxcbiAgICAgICAgICAgICAgICAvLyBzbyBpbiBvcmRlciB0byBmaWdodCB0aGUgaGFuZ2luZyBpbmRlbnQgZWZmZWN0LCBtb3ZlIHRoZW0gb3ZlciA4IHB4XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0QWxsKFwidHNwYW5cIikuYXR0cihcImR4XCIsIDgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VUaW1lU2VyaWVzKHNlbGVjdGlvbikge1xuICAgICAgICAgICAgc2VsZWN0aW9uLmVhY2goZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIHNpemluZyBhbmQgbWFyZ2luIHZhcnNcbiAgICAgICAgICAgICAgICB2YXIgQkJveCA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCIgOiBCQm94LmhlaWdodCAqIDAuMDUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCIgOiBCQm94LndpZHRoICogMC4wNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCIgOiBCQm94LmhlaWdodCAqIDAuMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGVmdFwiIDogZDMubWF4KFtCQm94LndpZHRoICogMC4wNSwgNTVdKVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IEJCb3gud2lkdGggLSAobWFyZ2luLmxlZnQgKyBtYXJnaW4ucmlnaHQpXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IEJCb3guaGVpZ2h0IC0gKG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgICAgIHN2ZyA9IGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIEJCb3guaGVpZ2h0KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBCQm94LndpZHRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwgMClcIiksXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0ID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGVzdGluZyBzdHVmZiAtIGRyYXdzIG91dGxpbmVzIGFyb3VuZCBzdmcgYW5kIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICAvLyBzdmdPdXRsaW5lID0gc3ZnLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHN2Zy5hdHRyKFwiaGVpZ2h0XCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJ3aWR0aFwiLCBzdmcuYXR0cihcIndpZHRoXCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmdiYSgwLDAsMCwwKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCJyZWRcIiksXG4gICAgICAgICAgICAgICAgICAgIC8vIGNoYXJ0T3V0bGluZSA9IHN2Zy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJoZWlnaHRcIiwgY2hhcnQuYXR0cihcImhlaWdodFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC5hdHRyKFwid2lkdGhcIiwgY2hhcnQuYXR0cihcIndpZHRoXCIpKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmdiYSgwLDAsMCwwKVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLmF0dHIoXCJzdHJva2VcIiAsXCJibHVlXCIpLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbG9yIHNjYWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbG9ycyA9IGQzLnNjYWxlLm9yZGluYWwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtcIiMxRUFDRjFcIiwgXCIjQjk0QTQ4XCJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lS2V5c1xuICAgICAgICAgICAgICAgICAgICAgICAgKSxcblxuICAgICAgICAgICAgICAgICAgICAvLyBwb2ludCBzaGFwZSBcInNjYWxlXCJcbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2NhbGUgPSBkMy5zY2FsZS5vcmRpbmFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShkMy5zdmcuc3ltYm9sVHlwZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVLZXlzXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHggYW5kIHkgc2NhbGVzXG4gICAgICAgICAgICAgICAgICAgIHRpbWVGb3JtYXQgPSBkMy50aW1lLmZvcm1hdChcIiVZXCIpLFxuICAgICAgICAgICAgICAgICAgICB0aW1lUmFuZ2UgPSBsb2Rhc2guY2hhaW4oZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLlllYXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIHggPSBkMy50aW1lLnNjYWxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMTIsIHdpZHRoXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZDMuZXh0ZW50KHRpbWVSYW5nZSkubWFwKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRpbWVGb3JtYXQucGFyc2UodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJhbmdlKFtoZWlnaHQsIDBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbWFpbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5leHRlbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZGFzaC5jaGFpbihkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmVLZXlzLm1hcChmdW5jdGlvbihrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICtkW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mbGF0dGVuKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51bmlxdWUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLy8ubWFwKGZ1bmN0aW9uKHYsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHJldHVybiAoTWF0aC5jZWlsKHYvMTApICogMTApIC0gMTA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gKE1hdGguZmxvb3Iodi8xMCkgKiAxMCkgKyAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAubmljZSg1LCAxMCksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gYXhpcyBmdW5jdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgeEF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGUoeClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vcmllbnQoXCJib3R0b21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrcyhkMy50aW1lLnllYXIsIDEpLFxuICAgICAgICAgICAgICAgICAgICB5QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yaWVudChcImxlZnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbm5lclRpY2tTaXplKC13aWR0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aWNrUGFkZGluZygxMCksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gbGluZSBjaGFydGluZyBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4KGQuWWVhcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geShkLlZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIC8vIHNsdWcgZnVuY3Rpb24gZm9yIGNsYXNzaW5nIGFuZCBoaWdobGlnaHRpbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gc2x1Z2dpZnkgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm4gdGV4dC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIl9cIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIH07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzaGFwZSBkYXRhIGZvciBsaW5lc1xuICAgICAgICAgICAgICAgICAgICBkYXRhID0gbGluZUtleXMubWFwKGZ1bmN0aW9uKGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLZXlcIiA6IGssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWVzIDogbG9kYXNoLm1hcChkYXRhLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1wiWWVhclwiIDogdGltZUZvcm1hdC5wYXJzZShkLlllYXIpLCBcIlZhbHVlXCIgOiArZFtrXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAvLyAvLyB0ZXN0IG91dHB1dCBmb3IgdHJvdWJsZXNob290aW5nIHRoZSBkYXRhIHN0dWZmXG4gICAgICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdCh0aGlzKS5hcHBlbmQoXCJwcmVcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC50ZXh0KEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKVxuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwieC1heGlzXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXhpc1wiIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsIFwiICsgaGVpZ2h0ICsgXCIpXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh4QXhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwieS1heGlzXCIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXhpc1wiIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKC0xMiwgMClcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKHlBeGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBjaGFydC5zZWxlY3RBbGwoXCJnLnRpbWVzZXJpZXMtbGluZXNcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtbGluZXNcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZChcInRpbWVzZXJpZXMtcGF0aFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUoZC5WYWx1ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzKGQuS2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50RGF0YSA9IGRhdGEubWFwKGZ1bmN0aW9uKGQsIGRpLCBkYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuVmFsdWVzLm1hcChmdW5jdGlvbih2LCB2aSwgdmEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LktleSA9IGQuS2V5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIHBvaW50RGF0YSA9IGxvZGFzaC5mbGF0dGVuKHBvaW50RGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhcnQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJ0aW1lc2VyaWVzLXBvaW50c1wiLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNlbGVjdEFsbChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKHBvaW50RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBmdW5jdGlvbihkLCBpKSB7cmV0dXJuIGNvbG9ycyhkLktleSk7IH0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBkMy5zdmcuc3ltYm9sKCkudHlwZShcImNpcmNsZVwiKS5zaXplKDY1KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBcInRyYW5zbGF0ZShcIiArIHgoZC5ZZWFyKSArIFwiLCBcIiArIHkoZC5WYWx1ZSkgK1wiKVwiO30pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRpbWVzZXJpZXNTZXJ2aWNlO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBYm91dFBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsLyogJyRhbmNob3JTY3JvbGwnLCAnJHJvb3RTY29wZScsKi8gJyRyb3V0ZVBhcmFtcycsICdzaWRlYmFyRGlzcGxheScsICdjb250cmlidXRvcnMnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwvKiAkYW5jaG9yU2Nyb2xsLCAkcm9vdFNjb3BlLCovICRyb3V0ZVBhcmFtcywgc2lkZWJhckRpc3BsYXksIGNvbnRyaWJ1dG9ycyl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yUHJvbWlzZSA9IGNvbnRyaWJ1dG9ycy5nZXRDb250cmlidXRvcnMoXCJhbGxcIik7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnSW50cm9kdWN0aW9uJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdDaXZpYyBFbmdhZ2VtZW50JztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblRlYXNlciA9ICdUZXN0aW5nJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL2NpdmljLWVuZ2FnZW1lbnQnO1xuICAgICAgICB9KTtcblxufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdDYWxsVG9BY3Rpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnQ2FsbCBUbyBBY3Rpb24nO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0Nsb3Nlckxvb2tQYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnQSBDbG9zZXIgTG9vayc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnSW5zdGl0dXRpb25hbCBQcmVzZW5jZSc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25UZWFzZXIgPSBcIlN0dWZmIGFib3V0IGluc3RpdHV0aW9uc1wiO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvaW5zdGl0dXRpb25hbC1wcmVzZW5jZSc7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQ29oZXNpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnU29jaWFsIE5ldHdvcmtzIGFuZCBDb21tdW5pdHkgQ29oZXNpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ0luc3RpdHV0aW9uYWwgUHJlc2VuY2UnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gXCJTdHVmZiBhYm91dCBpbnN0aXR1dGlvbnNcIjtcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvblVSTCA9ICcjL2luc3RpdHV0aW9uYWwtcHJlc2VuY2UnO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0VuZ2FnZW1lbnRQYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCAnJHJvdXRlUGFyYW1zJywqLyAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwvKiAkYW5jaG9yU2Nyb2xsLCAkcm9vdFNjb3BlLCAkcm91dGVQYXJhbXMsKi8gc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnQ2l2aWMgRW5nYWdlbWVudCc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnUG9saXRpY2FsIFBhcnRpY2lwYXRpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gXCJTdHVmZiBhYm91dCBwb2xpdGljYWwgcGFydGljaXBhdGlvblwiO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvcG9saXRpY2FsLXBhcnRpY2lwYXRpb24nO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1BhcnRpY2lwYXRpb25QYWdlQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvZycsICckbG9jYXRpb24nLCAnc2lkZWJhckRpc3BsYXknLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgc2lkZWJhckRpc3BsYXkpe1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHNpZGViYXJEaXNwbGF5LnNlY3Rpb24gPSAnUG9saXRpY2FsIFBhcnRpY2lwYXRpb24nO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uID0gJ0NvbW11bml0eSBDb2hlc2lvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25UZWFzZXIgPSBcIlN0dWZmIGFib3V0IGNvaGVzaW9uXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9jb21tdW5pdHktY29oZXNpb24nO1xuICAgICAgICB9KTtcblxufV0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1BhcnRuZXJzUGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywqLyAnJHJvdXRlUGFyYW1zJywgJ3NpZGViYXJEaXNwbGF5JywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsKi8gJHJvdXRlUGFyYW1zLCBzaWRlYmFyRGlzcGxheSwgY29udHJpYnV0b3JzKXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcblxuICAgICAgICB2YXIgY29udHJpYnV0b3JQcm9taXNlID0gY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyhcImFsbFwiKTtcbiAgICAgICAgY29udHJpYnV0b3JQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY29udHJpYnV0b3JzID0gY29udHJpYnV0b3JzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdQYXJ0bmVycyc7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb24gPSAnUmF3IERhdGEnO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVGVhc2VyID0gXCJTdHVmZiBhYm91dCByYXcgZGF0YVwiO1xuICAgICAgICAgICAgJHNjb3BlLm5leHRTZWN0aW9uVVJMID0gJyMvcmF3LWRhdGEnO1xuICAgICAgICB9KTtcblxufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdJbnN0aXR1dGlvblBhZ2VDb250cm9sbGVyJyxcbiAgICBbJyRzY29wZScsICckaHR0cCcsICckbG9nJywgJyRsb2NhdGlvbicsICdzaWRlYmFyRGlzcGxheScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLCBzaWRlYmFyRGlzcGxheSl7XG4gICAgICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgc2lkZWJhckRpc3BsYXkuc2VjdGlvbiA9ICdJbnN0aXR1dGlvbmFsIFByZXNlbmNlJztcbiAgICAgICAgICAgICRzY29wZS5uZXh0U2VjdGlvbiA9ICdDYWxsIHRvIEFjdGlvbic7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25UZWFzZXIgPSBcIlN0dWZmIGFib3V0IGNhbGwgdG8gYWN0aW9uXCI7XG4gICAgICAgICAgICAkc2NvcGUubmV4dFNlY3Rpb25VUkwgPSAnIy9jYWxsLXRvLWFjdGlvbic7XG4gICAgICAgIH0pO1xuXG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY2F0ZWdvcmllcycsIFsnJGh0dHAnLCAnJHEnLCAnbG9kYXNoJywgZnVuY3Rpb24oJGh0dHAsICRxLCBsb2Rhc2gpIHtcbiAgICB2YXIgY2F0ZWdvcmllcyA9IHt9O1xuICAgIGNhdGVnb3JpZXMubGlzdCA9IFtdO1xuXG4gICAgY2F0ZWdvcmllcy50b2dnbGUgPSBmdW5jdGlvbihjYXRlZ29yeSkge1xuICAgICAgICBwb3NpdGlvbiA9IGxvZGFzaC5maW5kSW5kZXgoY2F0ZWdvcmllcy5saXN0LCBmdW5jdGlvbihsaXN0Y2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdGNhdC5uYW1lID09IGNhdGVnb3J5Lm5hbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkID0gIWNhdGVnb3JpZXMubGlzdFtwb3NpdGlvbl0uc2VsZWN0ZWQ7XG4gICAgfTtcblxuICAgIGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY2F0ZWdvcmllcy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjYXRlZ29yaWVzKX0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGdldCBkYXRhIGZyZXNoIGZyb20gZmlsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL3N0YXRpYy9kaXN0L2RhdGEvZGF0YS5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBsb2Rhc2gubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvcnQgY2F0ZWdvcmllcyBieSByYW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9kYXNoLnNvcnRCeShyZXNwb25zZSwgXCJyYW5rXCIpLCBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggaW5kaWNhdG9yIGluIGVhY2ggY2F0ZWdvcnksIHNvcnQgJ2xldmVscycgYnkgYSByYW5rIGFzIHdlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpbmRpY2F0b3IsIGlpLCBpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmRhdGFbaWldLmRhdGEgPSBsb2Rhc2guc29ydEJ5QWxsKG8uZGF0YVtpaV0uZGF0YSwgXCJyYW5rXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXh0ZW5kIGVhY2ggY2F0ZWdvcnkgdG8gaGF2ZSBhIFwic2VsZWN0ZWRcIiB2YWx1ZSwgZGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGxvZGFzaC5leHRlbmQoe30sIG8sIHtcInNlbGVjdGVkXCIgOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGNhdGVnb3JpZXMubGlzdCB0byBhIHNvcnRlZCBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5saXN0ID0gbGlzdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjYXRlZ29yaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgY2F0ZWdvcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY2F0ZWdvcmllcztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnY29udHJpYnV0b3JzJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICAgIHZhciBjb250cmlidXRvcnMgPSB7fTtcbiAgICBjb250cmlidXRvcnMubGlzdCA9IFtdO1xuXG4gICAgY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY29udHJpYnV0b3JzLmxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBvYmplY3QgYWxyZWFkeSBoYXMgZGF0YSwganVzdCB1c2Ugd2hhdCdzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKGNvbnRyaWJ1dG9ycyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2NvbnRyaWJ1dG9ycy5qc29uJylcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5saXN0ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRyaWJ1dG9ycyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNvbnRyaWJ1dG9yc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gY29udHJpYnV0b3JzO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdTaWRlYmFyQ29udHJvbGxlcicsXG4gICAgWyckc2NvcGUnLCAnJGxvZycsJ2xvZGFzaCcsICdjYXRlZ29yaWVzJywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBsb2Rhc2gsIGNhdGVnb3JpZXMsIGNvbnRyaWJ1dG9ycykge1xuICAgICAgICAvLyAkc2NvcGUuc3RhdHVzID0ge1xuICAgICAgICAvLyAgICAgaXNvcGVuOiBmYWxzZVxuICAgICAgICAvLyB9O1xuXG4gICAgICAgIHZhciBjYXRlZ29yeVByb21pc2UgPSBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMoKTtcbiAgICAgICAgY2F0ZWdvcnlQcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5saXN0O1xuICAgICAgICB9LCBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgICAgICAgIGFsZXJ0KFwicHJvbWlzZSByZWplY3RlZCFcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgdGhlIHByZXNlbnRhdGlvbiBvZiB0aGUgc2VsZWN0ZWQgaXRlbXMgaW5cbiAgICAgICAgLy8gdGhlIHNpZGViYXIgYW5kIHByb3BpZ2F0aW5nIHNlbGVjdGlvbnMgdGhyb3VnaCB0aGUgY2F0Z29yaWVzIHNlcnZpY2VcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXMudG9nZ2xlKGNhdGVnb3J5KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hlY2tTZWxlY3RlZCA9IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICAgICAgICAgIGlmIChib29sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzZWxlY3RlZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG9nZ2xlZCB0cmlnZ2VyZWQgZnJvbSBzaWRlYmFyXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdzaWRlYmFyRGlzcGxheScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvZ2dsZTogeyBvcGVuOiB0cnVlIH0sXG4gICAgICAgIHNlY3Rpb246ICdJbnRyb2R1Y3Rpb24nXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdXcmFwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3NpZGViYXJEaXNwbGF5JywgZnVuY3Rpb24gKCRzY29wZSwgc2lkZWJhckRpc3BsYXkpIHtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcbiAgICAgICAgJHNjb3BlLnNlY3Rpb24gPSBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBzaWRlYmFyRGlzcGxheS5zZWN0aW9uO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VjdGlvbiA9IHNpZGViYXJEaXNwbGF5LnNlY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1dKVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
