var app=angular.module("app",["ngAnimate","ui.bootstrap","ngLodash","ngRoute"]);angular.module("app").config(["$routeProvider","$locationProvider",function(t,e){t.when("/data",{templateUrl:"static/dist/templates/data.html",controller:"DataVizController"}).when("/about",{templateUrl:"static/dist/templates/about.html",controller:"AboutPageController"}).otherwise({redirectTo:"/data"})}]),angular.module("app").filter("suppressions",function(){return function(t){return"-9,999.0"===t||"-9999"===t?"NA":"-666,666.0"===t||"-666666"===t?" * ":t}}).filter("percent",function(){return function(t){return parseInt(t)>0?t+"%":t}}).filter("any",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?t.some(e,n):t.some(e)}}]).filter("none",["lodash",function(t){return function(e,n){return"undefined"!=typeof n?!t.some(e,n):!t.some(e)}}]).filter("sluggify",function(){return function(t){return t.toLowerCase().replace(/[^a-zA-Z0-9_]/g,"_")}}).filter("safe",["$sce",function(t){return function(e){return t.trustAsHtml(e.toString())}}]),angular.module("app").controller("AboutPageController",["$scope","$http","$log","$location","sidebarDisplay","contributors",function(t,e,n,o,r,a){t.toggle=r.toggle,console.log(t.toggle);var i=a.getContributors("all");i.then(function(e){t.contributors=a.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!1})}]),angular.module("app").controller("DataVizController",["$scope","$http","$log","$location","$filter","sidebarDisplay","categories","lodash",function(t,e,n,o,r,a,i,l){t.charts={},t.toggle=a.toggle,t.aboutCollapsed=!1,t.checkChart=function(e){return e=r("sluggify")(e),e in t.charts?t.charts[e]:(t.charts[e]=!1,!1)},t.toggleChart=function(e){e=r("sluggify")(e),e in t.charts?t.charts[e]=!t.charts[e]:(alert('Somehow, "'+e+'" was not in scope.charts!'),t.charts[e]=!1)};var c=i.getCategories("all");c.then(function(e){t.categories=i.list},function(t){alert("promise rejected!")}),t.$on("$viewContentLoaded",function(e){t.toggle.open=!0})}]),angular.module("app").directive("simpletable",function(){var t=tableChart();return{restrict:"E",scope:{data:"=data"},link:function(e,n,o){e.$watchCollection("data",function(e){d3.select(n[0]).datum(e).call(t)})}}}),angular.module("app").directive("timeseries",["$window",function(t){var e=timeSeries();return{restrict:"E",scope:{data:"=data"},link:function(n,o,r){n.render=function(){data={data:n.data,config:{width:.6*o.parent().parent().parent()[0].getBoundingClientRect().width}},d3.select(o[0]).datum(data).call(e)},n.$watchCollection("data",function(t){n.render()}),t.onresize=function(){n.render()}}}}]),angular.module("app").service("categories",["$http","$q","lodash",function(t,e,n){var o={};return o.list=[],o.toggle=function(t){position=n.findIndex(o.list,function(e){return e.name==t.name}),o.list[position].selected=!o.list[position].selected},o.getCategories=function(){return e(o.list.length>0?function(t){t(o)}:function(e,r){t.get("/static/dist/data/data.json").success(function(t){list=n.map(n.sortBy(t,"rank"),function(t){return t.data.forEach(function(e,o,r){t.data[o].data=n.sortByAll(t.data[o].data,"rank")}),t=n.extend({},t,{selected:!0})}),o.list=list,e(o)}).error(function(){r("There was an error getting categories")})})},o}]),angular.module("app").service("contributors",["$http","$q",function(t,e){var n={};return n.list=[],n.getContributors=function(){return e(n.list.length>0?function(t){t(n)}:function(e,o){t.get("/static/dist/data/contributors.json").success(function(t){n.list=t,e(n)}).error(function(){o("There was an error getting contributors")})})},n}]),angular.module("app").controller("SidebarController",["$scope","$log","lodash","categories","contributors",function(t,e,n,o,r){var a=o.getCategories();a.then(function(e){t.categories=o.list},function(t){alert("promise rejected!")});var i=r.getContributors();i.then(function(e){t.contributors=r.list},function(t){alert("promise rejected!")}),t.updateSelected=function(t){o.toggle(t),console.log(n.pluck(o.list,"selected"))},t.checkSelected=function(t){return t?"selected":"deselected"},t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from sidebar"),console.log(t.toggle)})}]),angular.module("app").service("sidebarDisplay",function(){return{toggle:{open:!0}}}),angular.module("app").controller("WrapController",["$scope","sidebarDisplay",function(t,e){t.toggle=e.toggle,t.$watchCollection(function(){return t.toggle},function(){console.log("toggled triggered from wrap"),console.log(t.toggle)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInJvdXRlcy5qcyIsImZpbHRlcnMuanMiLCJhYm91dHBhZ2UvYWJvdXRwYWdlLmNvbnRyb2xsZXIuanMiLCJkYXRhdml6L2RhdGF2aXouY29udHJvbGxlci5qcyIsImRhdGF2aXovc2ltcGxldGFibGUuZGlyZWN0aXZlLmpzIiwiZGF0YXZpei90aW1lc2VyaWVzLmRpcmVjdGl2ZS5qcyIsInNpZGViYXIvY2F0ZWdvcmllcy5zZXJ2aWNlLmpzIiwic2lkZWJhci9jb250cmlidXRvcnMuc2VydmljZS5qcyIsInNpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwic2lkZWJhci9zaWRlYmFyZGlzcGxheS5zZXJ2aWNlLmpzIiwic2lkZWJhci93cmFwLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZpbHRlciIsImlucHV0Iiwic3RyIiwicGFyc2VJbnQiLCJsb2Rhc2giLCJhcnIiLCJwcm9wIiwic29tZSIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsIiRzY2UiLCJ2YWwiLCJ0cnVzdEFzSHRtbCIsInRvU3RyaW5nIiwiJHNjb3BlIiwiJGh0dHAiLCIkbG9nIiwiJGxvY2F0aW9uIiwic2lkZWJhckRpc3BsYXkiLCJjb250cmlidXRvcnMiLCJ0b2dnbGUiLCJjb25zb2xlIiwibG9nIiwiY29udHJpYnV0b3JQcm9taXNlIiwiZ2V0Q29udHJpYnV0b3JzIiwidGhlbiIsInJlc3VsdCIsImxpc3QiLCJyZWplY3Rpb24iLCJhbGVydCIsIiRvbiIsImV2ZW50Iiwib3BlbiIsIiRmaWx0ZXIiLCJjYXRlZ29yaWVzIiwiY2hhcnRzIiwiYWJvdXRDb2xsYXBzZWQiLCJjaGVja0NoYXJ0Iiwic2x1ZyIsInRvZ2dsZUNoYXJ0IiwicHJvbWlzZSIsImdldENhdGVnb3JpZXMiLCJkaXJlY3RpdmUiLCJjaGFydCIsInRhYmxlQ2hhcnQiLCJyZXN0cmljdCIsInNjb3BlIiwiZGF0YSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCIkd2F0Y2hDb2xsZWN0aW9uIiwiZDMiLCJzZWxlY3QiLCJkYXR1bSIsImNhbGwiLCIkd2luZG93IiwidGltZVNlcmllcyIsInJlbmRlciIsIndpZHRoIiwicGFyZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwib25yZXNpemUiLCJzZXJ2aWNlIiwiJHEiLCJjYXRlZ29yeSIsInBvc2l0aW9uIiwiZmluZEluZGV4IiwibGlzdGNhdCIsIm5hbWUiLCJzZWxlY3RlZCIsImxlbmd0aCIsInJlc29sdmUiLCJyZWplY3QiLCJnZXQiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJtYXAiLCJzb3J0QnkiLCJvIiwiZm9yRWFjaCIsImluZGljYXRvciIsImlpIiwiaWEiLCJzb3J0QnlBbGwiLCJleHRlbmQiLCJlcnJvciIsImNhdGVnb3J5UHJvbWlzZSIsInVwZGF0ZVNlbGVjdGVkIiwicGx1Y2siLCJjaGVja1NlbGVjdGVkIiwiYm9vbCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxPQUNBLFlBQ0EsZUFDQSxXQUNBLFdDSkFELFNBQUFDLE9BQUEsT0FDQUMsUUFBQSxpQkFBQSxvQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxLQUFBLFNBQ0FDLFlBQUEsa0NBQ0FDLFdBQUEsc0JBRUFGLEtBQUEsVUFDQUMsWUFBQSxtQ0FDQUMsV0FBQSx3QkFFQUMsV0FDQUMsV0FBQSxhQ1pBVCxRQUFBQyxPQUFBLE9BQ0FTLE9BQUEsZUFBQSxXQUNBLE1BQUEsVUFBQUMsR0FDQSxNQUFBLGFBQUFBLEdBQUEsVUFBQUEsRUFDQSxLQUNBLGVBQUFBLEdBQUEsWUFBQUEsRUFDQSxNQUVBQSxLQUlBRCxPQUFBLFVBQUEsV0FDQSxNQUFBLFVBQUFFLEdBQ0EsTUFBQUMsVUFBQUQsR0FBQSxF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SUFBQSx1Q0FDQUMsUUFBQSxTQUFBQyxHQUNBekQsRUFBQVEsS0FBQWlELEVBQ0FKLEVBQUFyRCxLQUVBbUUsTUFBQSxXQUNBYixFQUFBLGdEQU1BdEQsS0N4QkE3QixRQUFBQyxPQUFBLE9BQ0FNLFdBQUEscUJBQ0EsU0FBQSxPQUFBLFNBQUEsYUFBQSxlQUNBLFNBQUFpQixFQUFBRSxFQUFBWixFQUFBOEIsRUFBQWYsR0FLQSxHQUFBb0UsR0FBQXJELEVBQUFPLGVBQ0E4QyxHQUFBOUQsS0FBQSxTQUFBQyxHQUNBWixFQUFBb0IsV0FBQUEsRUFBQVAsTUFDQSxTQUFBQyxHQUNBQyxNQUFBLHNCQUdBLElBQUFOLEdBQUFKLEVBQUFLLGlCQUNBRCxHQUFBRSxLQUFBLFNBQUFDLEdBQ0FaLEVBQUFLLGFBQUFBLEVBQUFRLE1BQ0EsU0FBQUMsR0FDQUMsTUFBQSx1QkFLQWYsRUFBQTBFLGVBQUEsU0FBQXZCLEdBQ0EvQixFQUFBZCxPQUFBNkMsR0FDQTVDLFFBQUFDLElBQUFsQixFQUFBcUYsTUFBQXZELEVBQUFQLEtBQUEsY0FHQWIsRUFBQTRFLGNBQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUNBLFdBRUEsY0FHQTdFLEVBQUFxQyxpQkFBQSxXQUNBLE1BQUFyQyxHQUFBTSxRQUNBLFdBQ0FDLFFBQUFDLElBQUEsa0NBQ0FELFFBQUFDLElBQUFSLEVBQUFNLGFDeENBOUIsUUFBQUMsT0FBQSxPQUNBd0UsUUFBQSxpQkFBQSxXQUNBLE9BQ0EzQyxRQUFBWSxNQUFBLE1DSEExQyxRQUFBQyxPQUFBLE9BQ0FNLFdBQUEsa0JBQUEsU0FBQSxpQkFBQSxTQUFBaUIsRUFBQUksR0FDQUosRUFBQU0sT0FBQUYsRUFBQUUsT0FFQU4sRUFBQXFDLGlCQUFBLFdBQ0EsTUFBQXJDLEdBQUFNLFFBQ0EsV0FDQUMsUUFBQUMsSUFBQSwrQkFDQUQsUUFBQUMsSUFBQVIsRUFBQU0iLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgJ25nQW5pbWF0ZScsXG4gICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgJ25nTG9kYXNoJyxcbiAgICAnbmdSb3V0ZSdcbiAgICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignL2RhdGEnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9kaXN0L3RlbXBsYXRlcy9kYXRhLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0RhdGFWaXpDb250cm9sbGVyJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2Fib3V0Jywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvZGlzdC90ZW1wbGF0ZXMvYWJvdXQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQWJvdXRQYWdlQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnL2RhdGEnXG4gICAgICAgIH0pO1xufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5maWx0ZXIoJ3N1cHByZXNzaW9ucycsIGZ1bmN0aW9uKCkge1xuICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICBpZiAoaW5wdXQgPT09IFwiLTksOTk5LjBcIiB8fCBpbnB1dCA9PT0gXCItOTk5OVwiKSB7XG4gICAgICAgIHJldHVybiAnTkEnO1xuICAgIH0gZWxzZSBpZiAoaW5wdXQgPT09IFwiLTY2Niw2NjYuMFwiIHx8IGlucHV0ID09PSBcIi02NjY2NjZcIikge1xuICAgICAgICByZXR1cm4gJyAqICc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cbiAgfTtcbn0pXG4uZmlsdGVyKCdwZXJjZW50JywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cikge1xuICAgICAgICBpZiAocGFyc2VJbnQoc3RyKSA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBzdHIgKyBcIiVcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzdHI7XG4gICAgICAgIH1cbiAgICB9XG59KVxuLmZpbHRlcignYW55JywgWydsb2Rhc2gnLCBmdW5jdGlvbihsb2Rhc2gpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYXJyLCBwcm9wKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBsb2Rhc2guc29tZShhcnIpXG4gICAgICAgIH1cbiAgICB9XG59XSlcbi5maWx0ZXIoJ25vbmUnLCBbJ2xvZGFzaCcsIGZ1bmN0aW9uKGxvZGFzaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnIsIHByb3ApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gIWxvZGFzaC5zb21lKGFyciwgcHJvcClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAhbG9kYXNoLnNvbWUoYXJyKVxuICAgICAgICB9XG4gICAgfVxufV0pXG4uZmlsdGVyKCdzbHVnZ2lmeScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIFwiX1wiKVxuICAgIH07XG59KVxuLmZpbHRlcignc2FmZScsIFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbC50b1N0cmluZygpKTtcbiAgICB9O1xufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0Fib3V0UGFnZUNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywvKiAnJGFuY2hvclNjcm9sbCcsICckcm9vdFNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICovJ3NpZGViYXJEaXNwbGF5JywgJ2NvbnRyaWJ1dG9ycycsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvZywgJGxvY2F0aW9uLC8qICRhbmNob3JTY3JvbGwsICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgKi9zaWRlYmFyRGlzcGxheSwgY29udHJpYnV0b3JzKXtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZSA9IHNpZGViYXJEaXNwbGF5LnRvZ2dsZTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihuZXdSb3V0ZSwgb2xkUm91dGUpIHtcbiAgICAgICAgLy8gICAgICRsb2NhdGlvbi5oYXNoKCRyb3V0ZVBhcmFtcy5zY3JvbGxUbyk7XG4gICAgICAgIC8vICAgICAkYW5jaG9yU2Nyb2xsKCk7XG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIHZhciBjb250cmlidXRvclByb21pc2UgPSBjb250cmlidXRvcnMuZ2V0Q29udHJpYnV0b3JzKFwiYWxsXCIpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgLy8gSSBtYWRlIGNoYW5nZXMgdG8gdGhlIHNpZGViYXIgZGlzcGxheSBzZXJ2aWNlLCByZW5hbWluZyB0aGUgaW50ZXJuYWxcbiAgICAgICAgICAgIC8vIHNldHRpbmcgdG8gYmUgXCJvcGVuXCIsIHdoaWNoIG1ha2VzIGl0IGVhc2llciB0byBpbnRlcnByZXQgdGhpcy4gSSBtYWRlXG4gICAgICAgICAgICAvLyBjb3JyZXNwb25kaW5nIGNoYW5nZXMgaW4gdGhlIGFib3V0IGFuZCBkYXRhIHRlbXBsYXRlcy5cbiAgICAgICAgICAgIC8vIFRoaXMgbGlzdGVuZXIgZW5zdXJlcyB0aGF0IHRoZSBzaWRlYmFyIGRvZXNuJ3QgZ2V0IGNsb3NlZCwgd2hpY2ggc29tZWhvd1xuICAgICAgICAgICAgLy8gcmVzb2x2ZXMgdGhlIGlzc3VlIG9mIHJlbmRlcmluZyB0aGUgdGVtcGxhdGUgdW5kZXJuZWF0IHRoZSBzbGlkZW91dCBtZW51XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignRGF0YVZpekNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2cnLCAnJGxvY2F0aW9uJywgJyRmaWx0ZXInLC8qICckYW5jaG9yU2Nyb2xsJywgJyRyb290U2NvcGUnLCAnJHJvdXRlUGFyYW1zJywgKi8nc2lkZWJhckRpc3BsYXknLCAnY2F0ZWdvcmllcycsICdsb2Rhc2gnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2csICRsb2NhdGlvbiwgJGZpbHRlciwvKiAkYW5jaG9yU2Nyb2xsLCAkcm9vdFNjb3BlLCAkcm91dGVQYXJhbXMsICovc2lkZWJhckRpc3BsYXksIGNhdGVnb3JpZXMsIGxvZGFzaCl7XG4gICAgICAgIHZhciBsbyA9IGxvZGFzaDtcbiAgICAgICAgJHNjb3BlLmNoYXJ0cyA9IHt9O1xuICAgICAgICAkc2NvcGUudG9nZ2xlID0gc2lkZWJhckRpc3BsYXkudG9nZ2xlO1xuXG4gICAgICAgICRzY29wZS5hYm91dENvbGxhcHNlZCA9IGZhbHNlO1xuXG4gICAgICAgICRzY29wZS5jaGVja0NoYXJ0ID0gZnVuY3Rpb24oc2x1Zykge1xuICAgICAgICAgICAgc2x1ZyA9ICRmaWx0ZXIoJ3NsdWdnaWZ5Jykoc2x1Zyk7XG5cbiAgICAgICAgICAgIGlmICghKHNsdWcgaW4gJHNjb3BlLmNoYXJ0cykpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhcnRzW3NsdWddID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNoYXJ0c1tzbHVnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUudG9nZ2xlQ2hhcnQgPSBmdW5jdGlvbihzbHVnKSB7XG4gICAgICAgICAgICBzbHVnID0gJGZpbHRlcignc2x1Z2dpZnknKShzbHVnKTtcblxuICAgICAgICAgICAgaWYgKCEoc2x1ZyBpbiAkc2NvcGUuY2hhcnRzKSkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiU29tZWhvdywgXFxcIlwiK3NsdWcrXCJcXFwiIHdhcyBub3QgaW4gc2NvcGUuY2hhcnRzIVwiKVxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiAkc2NvcGUuY2hhcnRzW3NsdWddO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFydHNbc2x1Z10gPSAhJHNjb3BlLmNoYXJ0c1tzbHVnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24obmV3Um91dGUsIG9sZFJvdXRlKSB7XG4gICAgICAgIC8vICAgICAkbG9jYXRpb24uaGFzaCgkcm91dGVQYXJhbXMuc2Nyb2xsVG8pO1xuICAgICAgICAvLyAgICAgJGFuY2hvclNjcm9sbCgpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICB2YXIgcHJvbWlzZSA9IGNhdGVnb3JpZXMuZ2V0Q2F0ZWdvcmllcyhcImFsbFwiKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSlcblxuICAgICAgICAgJHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUub3BlbiA9IHRydWU7XG4gICAgICAgIH0pO1xufV0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ3NpbXBsZXRhYmxlJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgcmVmbGVjdCB3aGF0ZXZlciB5b3VyIGQzIHRhYmxlIGZ1bmN0aW9uIGlzIGNhbGxlZC5cbiAgICB2YXIgY2hhcnQgPSB0YWJsZUNoYXJ0KCk7XG4gICAgcmV0dXJuICB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBkYXRhOiBcIj1kYXRhXCIgLy8gV2UgY2FuIGNhbGwgdGhpcyB3L2Ugd2Ugd2FudC5cbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdChlbGVtZW50WzBdKS5kYXR1bShkYXRhKS5jYWxsKGNoYXJ0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgndGltZXNlcmllcycsIFsnJHdpbmRvdycsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHNob3VsZCByZWZsZWN0IHdoYXRldmVyIHlvdXIgZDMgZnVuY3Rpb24gaXMgY2FsbGVkLlxuICAgIHZhciBjaGFydCA9IHRpbWVTZXJpZXMoKTtcbiAgICByZXR1cm4gIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGRhdGE6IFwiPWRhdGFcIiAvLyBXZSBjYW4gY2FsbCB0aGlzIHcvZSB3ZSB3YW50LlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgOiBzY29wZS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGVsZW1lbnRbMF0pLmRhdHVtKGRhdGEpLmNhbGwoY2hhcnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRhdGEgOiBkYXRhLFxuICAgICAgICAgICAgICAgIC8vICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBcIndpZHRoXCIgOiBlbGVtZW50LnBhcmVudCgpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgICAvLyBkMy5zZWxlY3QoZWxlbWVudFswXSkuZGF0dW0oZGF0YSkuY2FsbChjaGFydCk7XG4gICAgICAgICAgICAgICAgc2NvcGUucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgVGhpcyBjb2RlIGlzIGludGVuZGVkIHRvIGdldCB0aGUgY2hhcnQgdG8gcmVkcmF3IHdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkXG4gICAgICAgICAgICAgICAgQnV0IGFzIGl0IHN0YW5kcywgc29tZWhvdyB0aGlzIG92ZXJyaWRlcyB0aGUgZGF0YSBhbmQgdGhlIGNoYXJ0IGJlY29tZXMgdXNlbGVzcy5cbiAgICAgICAgICAgICAgICBJIGRvbid0IHRoaW5rIHRoaXMgZmVhdHVyZSBpcyB3b3J0aCB0aGUgZGVidWcgdGltZSBub3csIGJ1dCBpdCdzIHdvcnRoIGtlZXBpbmcgaW4gbWluZCBmb3IgdGhlIGZ1dHVyZS5cbiAgICAgICAgICAgICoqL1xuICAgICAgICAgICAgJHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnJlbmRlcigpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy8gICAgIHNjb3BlLnJlbmRlcihkYXRhKTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgIH1cbiAgICB9XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ2NhdGVnb3JpZXMnLCBbJyRodHRwJywgJyRxJywgJ2xvZGFzaCcsIGZ1bmN0aW9uKCRodHRwLCAkcSwgbG9kYXNoKSB7XG4gICAgdmFyIGNhdGVnb3JpZXMgPSB7fTtcbiAgICBjYXRlZ29yaWVzLmxpc3QgPSBbXTtcblxuICAgIGNhdGVnb3JpZXMudG9nZ2xlID0gZnVuY3Rpb24oY2F0ZWdvcnkpIHtcbiAgICAgICAgcG9zaXRpb24gPSBsb2Rhc2guZmluZEluZGV4KGNhdGVnb3JpZXMubGlzdCwgZnVuY3Rpb24obGlzdGNhdCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3RjYXQubmFtZSA9PSBjYXRlZ29yeS5uYW1lO1xuICAgICAgICB9KTtcbiAgICAgICAgY2F0ZWdvcmllcy5saXN0W3Bvc2l0aW9uXS5zZWxlY3RlZCA9ICFjYXRlZ29yaWVzLmxpc3RbcG9zaXRpb25dLnNlbGVjdGVkO1xuICAgIH07XG5cbiAgICBjYXRlZ29yaWVzLmdldENhdGVnb3JpZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNhdGVnb3JpZXMubGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBpZiB0aGlzIG9iamVjdCBhbHJlYWR5IGhhcyBkYXRhLCBqdXN0IHVzZSB3aGF0J3MgY3VycmVudGx5IGF2YWlsYWJsZVxuICAgICAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUpe3Jlc29sdmUoY2F0ZWdvcmllcyl9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBnZXQgZGF0YSBmcmVzaCBmcm9tIGZpbGVcbiAgICAgICAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9zdGF0aWMvZGlzdC9kYXRhL2RhdGEuanNvbicpXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gbG9kYXNoLm1hcChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzb3J0IGNhdGVnb3JpZXMgYnkgcmFua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZGFzaC5zb3J0QnkocmVzcG9uc2UsIFwicmFua1wiKSwgZnVuY3Rpb24obykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBlYWNoIGluZGljYXRvciBpbiBlYWNoIGNhdGVnb3J5LCBzb3J0ICdsZXZlbHMnIGJ5IGEgcmFuayBhcyB3ZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kYXRhLmZvckVhY2goZnVuY3Rpb24oaW5kaWNhdG9yLCBpaSwgaWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kYXRhW2lpXS5kYXRhID0gbG9kYXNoLnNvcnRCeUFsbChvLmRhdGFbaWldLmRhdGEsIFwicmFua1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4dGVuZCBlYWNoIGNhdGVnb3J5IHRvIGhhdmUgYSBcInNlbGVjdGVkXCIgdmFsdWUsIGRlZmF1bHQgdG8gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBsb2Rhc2guZXh0ZW5kKHt9LCBvLCB7XCJzZWxlY3RlZFwiIDogdHJ1ZX0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBjYXRlZ29yaWVzLmxpc3QgdG8gYSBzb3J0ZWQgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3JpZXMubGlzdCA9IGxpc3Q7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY2F0ZWdvcmllcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIHdhcyBhbiBlcnJvciBnZXR0aW5nIGNhdGVnb3JpZXNcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGNhdGVnb3JpZXM7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ2NvbnRyaWJ1dG9ycycsIFsnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbigkaHR0cCwgJHEpIHtcbiAgICB2YXIgY29udHJpYnV0b3JzID0ge307XG4gICAgY29udHJpYnV0b3JzLmxpc3QgPSBbXTtcblxuICAgIGNvbnRyaWJ1dG9ycy5nZXRDb250cmlidXRvcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNvbnRyaWJ1dG9ycy5saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgb2JqZWN0IGFscmVhZHkgaGFzIGRhdGEsIGp1c3QgdXNlIHdoYXQncyBjdXJyZW50bHkgYXZhaWxhYmxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShjb250cmlidXRvcnMpfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBvdGhlcndpc2UgZ2V0IGRhdGEgZnJlc2ggZnJvbSBmaWxlXG4gICAgICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvc3RhdGljL2Rpc3QvZGF0YS9jb250cmlidXRvcnMuanNvbicpXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnMubGlzdCA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjb250cmlidXRvcnMpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJUaGVyZSB3YXMgYW4gZXJyb3IgZ2V0dGluZyBjb250cmlidXRvcnNcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGNvbnRyaWJ1dG9ycztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignU2lkZWJhckNvbnRyb2xsZXInLFxuICAgIFsnJHNjb3BlJywgJyRsb2cnLCdsb2Rhc2gnLCAnY2F0ZWdvcmllcycsICdjb250cmlidXRvcnMnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgbG9kYXNoLCBjYXRlZ29yaWVzLCBjb250cmlidXRvcnMpIHtcbiAgICAgICAgLy8gJHNjb3BlLnN0YXR1cyA9IHtcbiAgICAgICAgLy8gICAgIGlzb3BlbjogZmFsc2VcbiAgICAgICAgLy8gfTtcblxuICAgICAgICB2YXIgY2F0ZWdvcnlQcm9taXNlID0gY2F0ZWdvcmllcy5nZXRDYXRlZ29yaWVzKCk7XG4gICAgICAgIGNhdGVnb3J5UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxpc3Q7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlamVjdGlvbikge1xuICAgICAgICAgICAgYWxlcnQoXCJwcm9taXNlIHJlamVjdGVkIVwiKTtcbiAgICAgICAgfSlcblxuICAgICAgICB2YXIgY29udHJpYnV0b3JQcm9taXNlID0gY29udHJpYnV0b3JzLmdldENvbnRyaWJ1dG9ycygpO1xuICAgICAgICBjb250cmlidXRvclByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICRzY29wZS5jb250cmlidXRvcnMgPSBjb250cmlidXRvcnMubGlzdDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICAgICAgICBhbGVydChcInByb21pc2UgcmVqZWN0ZWQhXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGdW5jdGlvbnMgZm9yIG1hbmFnaW5nIHRoZSBwcmVzZW50YXRpb24gb2YgdGhlIHNlbGVjdGVkIGl0ZW1zIGluXG4gICAgICAgIC8vIHRoZSBzaWRlYmFyIGFuZCBwcm9waWdhdGluZyBzZWxlY3Rpb25zIHRocm91Z2ggdGhlIGNhdGdvcmllcyBzZXJ2aWNlXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uKGNhdGVnb3J5KSB7XG4gICAgICAgICAgICBjYXRlZ29yaWVzLnRvZ2dsZShjYXRlZ29yeSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhsb2Rhc2gucGx1Y2soY2F0ZWdvcmllcy5saXN0LCBcInNlbGVjdGVkXCIpKVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5jaGVja1NlbGVjdGVkID0gZnVuY3Rpb24oYm9vbCkge1xuICAgICAgICAgICAgaWYgKGJvb2wpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzZWxlY3RlZFwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkZXNlbGVjdGVkXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRzY29wZS50b2dnbGU7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0b2dnbGVkIHRyaWdnZXJlZCBmcm9tIHNpZGViYXJcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUudG9nZ2xlKTtcbiAgICAgICAgfSk7XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ3NpZGViYXJEaXNwbGF5JywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdG9nZ2xlOiB7IG9wZW46IHRydWUgfVxuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdXcmFwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3NpZGViYXJEaXNwbGF5JywgZnVuY3Rpb24oJHNjb3BlLCBzaWRlYmFyRGlzcGxheSkge1xuICAgICRzY29wZS50b2dnbGUgPSBzaWRlYmFyRGlzcGxheS50b2dnbGU7XG5cbiAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9nZ2xlO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG9nZ2xlZCB0cmlnZ2VyZWQgZnJvbSB3cmFwXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnRvZ2dsZSk7XG4gICAgICAgIH0pO1xufV0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
